var BANCOMER=BANCOMER||{};BANCOMER.VERSION="1.0.0",BANCOMER.CULTURETEXT=BANCOMER.CULTURETEXT||{},BANCOMER.Launcher=BANCOMER.Launcher||{},BANCOMER.Router=BANCOMER.Router||{},BANCOMER.Models=BANCOMER.Models||{},BANCOMER.Collections=BANCOMER.Collections||{},BANCOMER.Views=BANCOMER.Views||{},BANCOMER.Views.HighStock=BANCOMER.Views.HighStock||{},BANCOMER.Renderers=BANCOMER.Renderers||{},BANCOMER.Utils=BANCOMER.Utils||{},BANCOMER.Pages=BANCOMER.Pages||{},BANCOMER.Lightboxes=BANCOMER.Lightboxes||{},BANCOMER.Components=BANCOMER.Components||{},BANCOMER.Services=BANCOMER.Services||{},BANCOMER.Services.Streaming=BANCOMER.Services.Streaming||{},BANCOMER.HOMEURL="",IFB.Product="HTBANCOMER",IFB.Services.RetryLimit=3,moment.lang("es"),accounting.settings={currency:{symbol:"$",format:"%v %s",decimal:".",thousand:",",precision:2},number:{precision:0,decimal:".",thousand:","}},Highcharts.setOptions({xAxis:{lineColor:"#F7F7F7",tickColor:"#F7F7F7",labels:{style:{color:"#8C949C"}}},yAxis:{gridLineColor:"#F7F7F7",lineColor:"#F7F7F7",tickColor:"#000000",labels:{style:{color:"#8C949C"}}},plotOptions:{series:{dataGrouping:{enabled:!1},turboThreshold:0,tooltip:{followTouchMove:!0}},candlestick:{color:"#cc0a5a",upColor:"#5cc800"},area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]}}}}),IFB.Utils.ProductConfig.getBuscadorHTPattern=function(){return"0;29;20(07)|20(25),{0},,,1,XI;27;M8;RA;4F,3,0,1"},$.extend($.fn.dataTable.defaults,{searching:!1,ordering:!1}),BANCOMER.Launcher.Main=IFB.Class(null,{defaults:{},os:"",accounts:"",server:"",streaming:"",session:"",sid:"",protocol:"",clientSettings:{},activationDelay:2e3,activationTextLenght:2,realTimeNetting:250,PREFERENCES_FILENAME:"_~PREFERENCES",PREFERENCES_TYPE:"PRF",STATUSCONFIG_FILENAME:"MensajesSesionLeidos",STATUSCONFIG_TYPE:"NOTIF",headerComponents:[],footerComponents:[],searchComponent:void 0,messageComponent:void 0,noticeComponent:void 0,settingComponent:void 0,searching:!1,footerMenu:void 0,footerMenuVisible:!1,initialize:function(e){_.extend(this,Backbone.Events),this.os=e.os||"",this.server=e.server||"",this.streaming=e.streaming||"",this.sid=e.sid||"",this.protocol=e.protocol||"",this.accounts=e.accounts||"",this.clientSettings=e.settings||{},IFB.Services.Domain="android"===this.os||"ios"===this.os?"bbvanet.com.mx":"",IFB.Templates.baseURL="../templates",this._setClientConfig(),this._setServers(),this._initializeHeader(),IFB.Utils.Helper.callbackOnBeforeUnload=this.callbackOnBeforeUnload},callbackOnBeforeUnload:function(){IFB.Services.Streaming.CONNECTION&&(IFB.Services.Streaming.CONNECTION.unregisterAll(),IFB.Services.Streaming.CONNECTION.disconnect()),IFB.ActivityManager.notify(IFB.ActivityManager.COMPONENT.APPLICATION,IFB.ActivityManager.ACTION.LOGOUT,IFB.ActivityManager.ACTION.LOGOUT,IFB.ActivityManager.SOURCE.BROWSER)},_initializeHeader:function(){this._setHeaderTexts(),this._setHeaderHandlers(),this._setAccountsButton(),this._setSearcher(),this._setClickableLevel()},_setClickableLevel:function(){var e=this;$("#clickableLevel").on("click",function(){$(".speechBubble").hide(),e.hideClickable()}),$(".ifb-contHelp").on("click",function(){BANCOMER.Router.navigate("",{trigger:!1,replace:!0}),$(".ifb-contHelp").hide()})},_setClientConfig:function(){this.clientSettings&&(moment.lang(this.clientSettings.language||moment.lang()),accounting.settings.currency.decimal=this.clientSettings.decimal||accounting.settings.currency.decimal,accounting.settings.currency.thousand=this.clientSettings.thousand||accounting.settings.currency.thousand,accounting.settings.number.decimal=this.clientSettings.decimal||accounting.settings.number.decimal,accounting.settings.number.thousand=this.clientSettings.thousand||accounting.settings.number.thousand,$.datepicker.setDefaults($.datepicker.regional[this.clientSettings.language]))},_setHeaderTexts:function(){$("#menuBtnExit a").text(BANCOMER.CULTURETEXT.t("pageExitBtn")),$("#txtSearch").attr("placeholder",BANCOMER.CULTURETEXT.t("pageSearcherPlaceholder"))},_setHeaderHandlers:function(){var e=this;$("#menuBtnExit").on("click",function(){e._onClickBtnExit()}),$("#homeBtn").on("click",function(){e._onClickBtnHome()}),$("#menuBtnAccounts").on("click",function(){e._onClickBtnAccounts()}),$("#menuBtnNotice").on("click",function(){e._onClickBtnNotice()}),$("#menuBtnMessage").on("click",function(){e._onClickBtnMessage()}),$("#menuBtnHelp").on("click",function(){e._showHelp()}),$("#menuBtnTransference").on("click",function(){e._onClickBtnTransference()}),$("#mnuFooterIcon").on("click",function(){e.footerMenuVisible||e.openFooterMenu()}),$("#menuBtnAlerts").on("click",function(){e._onClickBtnAlerts()})},_showHelp:function(e){this.showClickable(),$("#settingsBubble").show()},showClickable:function(){$("#clickableLevel").show()},hideClickable:function(){$("#clickableLevel").hide()},_setAccountsButton:function(){var e=$("#menuBtnAccounts");"1"===this.accounts?e.removeClass("hidden"):e.addClass("hidden")},_setSearcher:function(){var e,t,i=this;$("#txtSearch").on("click",function(){$("#search_instrumentList").hide(),i.hideClickable()}),$("#txtSearch").on("keyup",_.debounce(function(){i.searchComponent&&(t=document.querySelector("#txtSearch").value,e=escape(t),t.length>i.activationTextLenght&&!i.searching&&(shown=!0,i.showSearchResults(e)),i.searching=!1)},i.activationDelay)),$("#txtSearch").on("keydown",function(n){i.searchComponent&&(t=document.querySelector("#txtSearch").value,e=escape(t),t.length>i.activationTextLenght&&i.isEnterKeyCode(n)&&(i.searching=!0,i.showSearchResults(e)))})},showSearchResults:function(e){this._launchSearch(e),this.showClickable(),$("#search_instrumentList").empty(),$("#search_instrumentList").show()},isEnterKeyCode:function(e){return 13===e.keyCode},_onClickBtnAccounts:function(){var e={},t=this;BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(BANCOMER.Services.BCOM.OperationCode.SolicitaCambioContrato,e,function(i){void 0!==i.answer&&void 0!==i.status&&i.status.ok&&e.id_testigo===i.answer.id_testigo&&"1"===i.answer.cuentaNueva&&t.trigger("changeAccount")})},_onClickBtnTransference:function(){var e={};BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(BANCOMER.Services.BCOM.OperationCode.TransferenciaEfectivo,e)},_onClickBtnExit:function(){var e=this,t=[{text:BANCOMER.CULTURETEXT.t("noty_Btn_Exit_Cancel")},{text:BANCOMER.CULTURETEXT.t("noty_Btn_Exit_Close"),callback:function(){var t={};IFB.Services.Streaming.CONNECTION.unregisterAll(),IFB.Services.Streaming.CONNECTION.disconnect(),e._destroyHeader(),e._destroyFooter(),document.location.href="#!/logout",BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(BANCOMER.Services.BCOM.OperationCode.SolicitaCierreApp,t)}}];IFB.Utils.Helper.showNotificationWarning("warning",BANCOMER.CULTURETEXT.t("noty_Exit_Title"),!0,t)},_onClickBtnNotice:function(){document.location.href="#!/lightbox/newsList/pageTitle_NoticePage/BWTAVISOS"},_onClickBtnMessage:function(){document.location.href="#!/lightbox/newsList/pageTitle_MessagePage/BWTMENSAJES"},_onClickBtnAlerts:function(){document.location.href="#!/lightbox/alerts/historical/pageTitle_HistoricalAlerts"},_onClickBtnHome:function(){document.location.href="#!/home"},_launchSearch:function(e){this.searchComponent.search(e)},_loadSearchComponent:function(){var e=new BANCOMER.Components.Search({config:"header_search_instrumentList",view:{el:"#search_instrumentList"}});return e.on("openInstrumentDetail",this._openInstrumentDetail,this),e},_loadHeaderSettingsComponent:function(){var e=new BANCOMER.Components.MenuSettings({config:"menuHeader_settings",view:{el:"#settingsBubble",streamingStatus:BANCOMER.Defaults.Application.streaming||"1"}});return e.on("sendChangeStreaming",this.onSendChangeStreaming,this),e},_loadMessageComponent:function(){var e=new BANCOMER.Components.NewsButton({config:"header_message",view:{el:"#menuBtnMessage"}});return e},_loadNoticeComponent:function(){var e=new BANCOMER.Components.NewsButton({config:"header_notice",view:{el:"#menuBtnNotice"}});return e},_openInstrumentDetail:function(e){this.hideClickable(),$("#txtSearch").val(""),document.location.href="#!/lightbox/instrumentDetail/"+e.mv},enter:function(){var e=this;if(""!==this.sid){var t=new IFB.Services.Management,i={sid:this.sid},n=function(i){var n=JSON.parse(i),o=0;void 0!==n.status&&n.status.ok?(e.server=n.answer.server||e.server,e.streaming=n.answer.streaming||e.streaming,e.session=n.answer.sesion||"",IFB.Services.Session=e.session,o=n.answer.gmt||"0",e._setGmtOffset(e.clientSettings.gmt,o),e._setServers(),e.createClickOnComponent(n.answer),t.infoLogin(IFB.Services.Session,VERSION,"3",function(e){}),BANCOMER.MANAGEMENTALERTS=new BANCOMER.Utils.ManagementAlerts):IFB.Utils.Helper.showNotificationWarning("warning",BANCOMER.CULTURETEXT.t("noty_Error_SID"),!0)};t.validateSID(i,n)}else IFB.Utils.Helper.showNotificationWarning("warning",BANCOMER.CULTURETEXT.t("noty_Error_SID"),!0)},_setGmtOffset:function(e,t){IFB.Settings.GmtOffset=60*(Number(e)-Number(t))},_initializeProductConfig:function(){var e=this;IFB.Utils.ProductConfig.initializeProductConfig(IFB.Services.Session,function(){e._loadUserPreferences(e)})},_setServers:function(){this.server&&(IFB.Services.baseURL=this.protocol+this.server+"/WTRest"),IFB.Services.ExternalUsersUrl=this.protocol+this.server+"/ExternalUsers",IFB.Services.StreamingBaseUrl=this.protocol+this.streaming+"/WTServerRT"},_startStreamingRealTime:function(e,t){var i,n=t;IFB.Services.Streaming.CONNECTION=new IFB.Services.Streaming({baseURL:n.protocol+n.server+"/WTServerRT"||"",streamingBaseURL:IFB.Services.StreamingBaseUrl||"",session:IFB.Services.Session,formatTypeJson:"4",netting:n.realTimeNetting}),i=BANCOMER.Utils.Helper.hasStreamingEnabled(),i?IFB.Services.Streaming.CONNECTION.connect(function(){_.isFunction(e)&&e(t)}):(IFB.Services.Streaming.CONNECTION.streamingEnabled=!1,_.isFunction(e)&&e(t))},_loadUserPreferences:function(e){var t=e;BANCOMER.Utils.Helper.getUserFiles(IFB.Services.Session,t.PREFERENCES_TYPE,function(e){t._initializeUserPreferences(_.first(e),t)})},_initializeUserPreferences:function(e,t){var i=t;BANCOMER.Utils.Preferences.initialize({file:i.PREFERENCES_FILENAME,type:i.PREFERENCES_TYPE,loadOnInitialize:!0},function(){i._initializeStatusConfig(t)})},_initializeStatusConfig:function(e){var t=e;IFB.Utils.ReadStatusConfig.initialize({file:t.STATUSCONFIG_FILENAME,type:t.STATUSCONFIG_TYPE,loadOnInitialize:!0},function(){BANCOMER.Defaults.Templates=$.extend(!0,BANCOMER.Defaults.Templates,BANCOMER.Utils.Preferences.preferences.modules),BANCOMER.Defaults.application=$.extend(!0,BANCOMER.Defaults.Application,BANCOMER.Utils.Preferences.preferences.application),t._startStreamingRealTime(t._startBackbone,t)})},_startBackbone:function(e){var t=e;BANCOMER.Router=new BANCOMER.Router.Main,Backbone.history.start(),t._createHeaderComponents(),t._createFooterComponents()},_destroyHeader:function(){for(;this.headerComponents.length;)this.headerComponents.shift().destroy()},_destroyFooter:function(){for(;this.footerComponents.length;)this.footerComponents.shift().destroy()},_createHeaderComponents:function(e){this.searchComponent=this._loadSearchComponent(),this.messageComponent=this._loadMessageComponent(),this.noticeComponent=this._loadNoticeComponent(),this.settingComponent=this._loadHeaderSettingsComponent(),this.headerComponents.push(this.searchComponent),this.headerComponents.push(this.messageComponent),this.headerComponents.push(this.noticeComponent)},onClikcOnAccepted:function(){this.clickOnComponent.destroy(),$("div.ifb-cont").show(),this._initializeProductConfig()},onClikcOnRefused:function(){var e={};this.clickOnComponent.destroy(),BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(BANCOMER.Services.BCOM.OperationCode.IrAPosicionGlobal,e)},createClickOnComponent:function(e){var t=this;this.clickOnComponent=new BANCOMER.Components.ClickOn({config:"clickOn",params:e}),this.clickOnComponent.on("clikcOnNoDocuments",t.onClikcOnAccepted,t),this.clickOnComponent.on("clikcOnAccepted",t.onClikcOnAccepted,t),this.clickOnComponent.on("clikcOnRefused",t.onClikcOnRefused,t)},getOS:function(){var e=this.os;return""===e&&(e=IFB.Utils.Helper.isIOS()?"ios":"android"),e},onSendChangeStreaming:function(){$("#myonoffswitch").is(":checked")?this.connectStreaming():this.disconnectStreaming(),BANCOMER.Utils.Helper.setRefreshIcon()},disconnectStreaming:function(){this.updateStreamingPreference("0"),IFB.Services.Streaming.CONNECTION&&(IFB.Services.Streaming.CONNECTION.unregisterAll(),IFB.Services.Streaming.CONNECTION.disconnect(),IFB.Services.Streaming.CONNECTION.streamingEnabled=!1)},connectStreaming:function(){this.updateStreamingPreference("1"),IFB.Services.Streaming.CONNECTION.streamingEnabled=!0,this._startStreamingRealTime(function(){BANCOMER.Router.currentPage.registerComponents(),_.each(BANCOMER.Router.lightboxes,function(e){e.registerComponents()})},this)},updateStreamingPreference:function(e){BANCOMER.Defaults.Application.streaming=e,BANCOMER.Utils.Preferences.addPreferenceApplication("streaming",e),BANCOMER.Utils.Preferences.save()},_createFooterComponents:function(e){this.footerMenu=this._loadMenuComponent(),this.footerComponents.push(this.footerMenu),this.addEventsFooterMenu()},addEventsFooterMenu:function(){var e=this;this.footerMenu.on("clickItemMenu",function(t){$("#footerContainer").addClass("ifHidden"),e.footerMenuVisible=!1,BANCOMER.Utils.Helper.closeFooterMenu(),document.location.href="#!/workspace/"+t.workspace}),this.footerMenu.on("closeMenu",function(){e.footerMenuVisible&&e.closeFooterMenu()})},openFooterMenu:function(){this.footerMenu&&!this.footerMenuVisible&&($("#footerContainer").removeClass("ifHidden"),this.footerMenuVisible=!0,this.footerMenu.config.viewOptions.items=BANCOMER.Utils.Preferences.preferences.workspaces||[],this.footerMenu.reload(),BANCOMER.Utils.Helper.openFooterMenu())},closeFooterMenu:function(){this.footerMenuVisible&&($("#footerContainer").addClass("ifHidden"),BANCOMER.Utils.Helper.closeFooterMenu(),this.footerMenuVisible=!1)},_loadMenuComponent:function(){var e={config:"footerMenu",view:{items:BANCOMER.Utils.Preferences.preferences.workspaces||[]}};return new BANCOMER.Components.MenuFooter(e)}}),function(){BANCOMER=BANCOMER||{},BANCOMER.Defaults=IFB.Defaults||{},BANCOMER.Defaults.Application=BANCOMER.Defaults.Application||{},_.extend(BANCOMER.Defaults,{Templates:{home_markUp:{serviceParams:{},viewOptions:{el:$("#mainContent"),templateId:"home_markUp",templateFile:"/home/markUp.htm"}},home_IndexesChart:{serviceParams:{data:{param:"BPG001",type:"1",header:"10103,250,3002,642",sort:"-1"}},viewOptions:{el:$("#homeIndexesChart"),templateId:"home_IndexesChart",templateFile:"/base/indexChart.htm",streaming:!0,numberOfItems:5,percentageEqual:4}},home_marketGrid:{serviceParams:{data:{param:"BPG002",type:"1",rt:"1",sort:"-1"},header:{columnado:"TAURO_INDICES_INDICES2",tipo:"1",defecto:"0"}},viewOptions:{el:$("#homeIndexesMarketGrid"),templateId:"home_marketGrid",templateFile:"/instrumentList/table.htm",streaming:!0,dataTable:{id:"marketGridTable"}},configHeaderSelector:{config:"header_selector",title:"componentTitle_UserHeader_Index"}},home_multipleTopFlopHorizontalList:{viewOptions:{el:$("#homeMultiTopFlopList")},serviceParams:{data:{param:"mx0001"}},components:[{config:"home_topHorizontal"},{config:"home_flopHorizontal"}]},home_topHorizontal:{serviceParams:{data:{type:"1",header:"10103,250,642,9828,9829,40",numVals:"4"}},viewOptions:{el:"#ifb-topHorizontal",templateId:"home_topHorizontal",templateFile:"/home/topFlopHorizontal.htm",streaming:!0,topFlopArrowCls:{top:"arrowBigVTop",flop:"arrowBigVFlop",equal:"arrowBigVEqual"}},refresh:15e3},home_flopHorizontal:{serviceParams:{data:{type:"2",header:"10103,250,642,9828,9829,40",numVals:"4"}},viewOptions:{el:"#ifb-flopHorizontal",templateId:"home_flopHorizontal",templateFile:"/home/topFlopHorizontal.htm",streaming:!0,topFlopArrowCls:{top:"arrowBigVTop",flop:"arrowBigVFlop",equal:"arrowBigVEqual"}},refresh:15e3},logout_markUp:{serviceParams:{},viewOptions:{el:$("#mainContent"),templateId:"logout_markUp",templateFile:"/logout/markUp.htm"}},home_ResearchNews:{viewOptions:{},news:{markUp:"home_ResearchNews_markUpNews",components:[{config:"home_ResearchNews_News"}]},research:{markUp:"home_ResearchNews_markUpResearch",components:[{config:"home_ResearchNews_Research"}]},researchNews:{markUp:"home_ResearchNews_markUpResearchNews",components:[{config:"home_ResearchNews_ResearchNews_Research"},{config:"home_ResearchNews_ResearchNews_News"}]},urlFileNode:"FicheroIB"},home_ResearchNews_markUpResearchNews:{serviceParams:{},viewOptions:{el:"#homeResearchNews",templateId:"home_ResearchNews_markUpResearchNews",templateFile:"/home/researchNews_markUpResearchNews.htm"}},home_ResearchNews_markUpNews:{serviceParams:{},viewOptions:{el:"#homeResearchNews",templateId:"home_ResearchNews_markUpNews",templateFile:"/home/researchNews_markUpNews.htm"}},home_ResearchNews_markUpResearch:{serviceParams:{},viewOptions:{el:"#homeResearchNews",templateId:"home_ResearchNews_markUpResearch",templateFile:"/home/researchNews_markUpResearch.htm"}},home_ResearchNews_News:{serviceParams:{searchFunc:"41",numberOfItems:14,data:{sources:"INFOSEL_BOLSA;INFOSEL_EMPRESAS;EMISNET"}},viewOptions:{el:"#homeNews",templateId:"home_ResearchNews_News",templateFile:"/home/news.htm",itemIdPrefix:"homeNews",streaming:!0}},home_ResearchNews_Research:{serviceParams:{searchFunc:"41",numberOfItems:14,data:{sources:"BCMRANALISIS"}},viewOptions:{el:"#homeResearch",templateId:"home_ResearchNews_Research",templateFile:"/home/research.htm",itemIdPrefix:"homeResearch",streaming:!0}},home_ResearchNews_ResearchNews_News:{serviceParams:{searchFunc:"41",numberOfItems:7,data:{sources:"INFOSEL_BOLSA;INFOSEL_EMPRESAS;EMISNET"}},viewOptions:{el:"#homeNews",templateId:"home_ResearchNews_ResearchNews_News",templateFile:"/home/researchNews_news.htm",itemIdPrefix:"homeNews",streaming:!0}},home_ResearchNews_ResearchNews_Research:{serviceParams:{searchFunc:"41",numberOfItems:7,data:{sources:"BCMRANALISIS"}},viewOptions:{el:"#homeResearch",templateId:"home_ResearchNews_ResearchNews_Research",templateFile:"/home/researchNews_research.htm",itemIdPrefix:"homeResearch",streaming:!0}},home_TopFlopPieChart:{viewOptions:{el:$("#homeTopFlopPieChart"),templateId:"home_TopFlopPieChart",templateFile:"/home/topFlopPieChart.htm",streaming:!0,height:142},serviceParams:{data:{param:"RAMXC  ",header:"8760,8770,8780",type:"4"}}},home_multipleTopFlopActive:{viewOptions:{el:$("#multipleTopFlopActive")},serviceParams:{data:{param:"mx0001"}},components:[{config:"home_top"},{config:"home_flop"},{config:"home_active"}]},home_top:{serviceParams:{data:{type:"1",header:"10305,80,420,250,370,390,410,1147,10307,133,642,10103"}},viewOptions:{el:"#ifb-top",templateId:"home_top",templateFile:"/home/top.htm",streaming:!0},refresh:15e3},home_flop:{serviceParams:{data:{type:"2",header:"10305,80,420,250,370,390,410,1147,10307,133,642,10103"}},viewOptions:{el:"#ifb-flop",templateId:"home_flop",templateFile:"/home/flop.htm",streaming:!0},refresh:15e3},home_active:{serviceParams:{data:{type:"3",header:"10305,10103,133,670,10307,642,9828,9829"}},viewOptions:{el:"#ifb-active",templateId:"home_active",templateFile:"/home/active.htm",streaming:!0},refresh:15e3},home_investmentDetailChart:{serviceBCOMParams:{operationCode:"7",params:{data1:"D"}},serviceParams:{header:{columnado:"TAURO_RESUMENEJECUTIVOPOSICION",tipo:"1",defecto:"0",descriptoresAdicionales:"40,9558,642,250,1538"}},viewOptions:{el:"#homeInvestmentDetailChart",templateId:"home_investmentDetailChart",templateFile:"/home/investmentDetailChart.htm",niceScroll:{id:"niceScrollGraph"}}},home_investmentDetailTable:{serviceBCOMParams:{operationCode:"7",params:{data1:"D"}},serviceParams:{header:{columnado:"TAURO_RESUMENEJECUTIVOPOSICION",tipo:"1",defecto:"0",descriptoresAdicionales:"40,9558,642,250,1538"},data:{header:"1538,642,250"}},viewOptions:{el:"#homeInvestmentDetailTable",templateId:"home_investmentDetailTable",templateFile:"/home/investmentDetailTable.htm",streaming:!0,highlightDescriptors:["1538","250"],enableSort:!0,sortConfig:{css:{arrow:"sortArrow2",asc:"activeUp",desc:"activeDown"}},dataTable:{id:"investmentDetailGridTable"}}},boleta_markUp:{serviceParams:{},viewOptions:{el:"#lightboxBoleta",templateId:"boleta_markUp",templateFile:"/boleta/markUp.htm"}},boleta_menu:{serviceParams:{},viewOptions:{el:"#boletaMenu",templateId:"boleta_menu",templateFile:"/boleta/boletaMenu.htm"}},boleta_instrumentDetail:{serviceParams:{data:{header:"420,370,240,250,340,330,670,642",rt:"1",sort:"-1",type:"4"}},viewOptions:{el:$("#boletaInstrumentDetail"),templateId:"boleta_instrumentDetail",templateFile:"/boleta/boletaInstrumentDetail.htm",streaming:!0,highlightDescriptors:["340","330","642"]}},boleta_positions:{serviceParams:{data:{type:"4",header:"735,350,740,330,340,750,360"}},viewOptions:{el:$("#boletaPositions"),templateId:"boleta_positions",templateFile:"/boleta/boletaPositions.htm",highlightDescriptors:[],streaming:!0}},boleta_form:{serviceParams:{data:{header:"9828,9829,330,340,1147,420",type:"4",rt:"1"}},viewOptions:{el:$("#boletaForm"),templateId:"boleta_boleta",templateFile:"/boleta/boletaForm.htm",streaming:!0}},boleta_confirmation:{serviceParams:{},viewOptions:{el:$("#boletaConfirmation"),templateId:"boleta_confirmation",templateFile:"/boleta/confirmation.htm"}},boleta_receipt:{serviceParams:{},viewOptions:{el:$("#boletaReceipt"),templateId:"boleta_receipt",templateFile:"/boleta/receipt.htm"}},investmentDetail_markUp:{serviceParams:{},viewOptions:{el:$("#mainContent"),templateId:"investmentDetail_markUp",templateFile:"/investmentDetail/markUp.htm"}},investmentDetail_positionTable:{serviceBCOMParams:{operationCode:"7",params:{data1:"D"}},serviceParams:{header:{columnado:"TAURO_DETALLE_POSICION_2",tipo:"1",defecto:"0"},data:{header:"1538,642,356,1562,250,410,390,9754"}},viewOptions:{el:"#investmentDetail_positionTable",templateId:"investmentDetail_positionTable",templateFile:"/investmentDetail/positionTable.htm",streaming:!0,highlightDescriptors:["1538","356","1562","250","390","410","9754"],dataTable:{id:"positionTable"},enableSort:!0,sortConfig:{descriptor:IFB.Descriptors.Emisora.descriptor}},configHeaderSelector:{config:"header_selector",title:"componentTitle_UserHeader_PositionTable"}},investmentDetail_orderBookTable:{serviceBCOMParams:{operationCode:"4",params:{data1:"4"}},serviceParams:{header:{columnado:"TAURO_DETALLEINVERSIONORDENES",tipo:"1",defecto:"0"},data:{header:"1538,642,356,1562,250,410,390,9754"}},viewOptions:{el:"#investmentDetail_orderBookTable",templateId:"investmentDetail_orderBookTable",templateFile:"/investmentDetail/orderBookTable.htm",dataTable:{id:"orderBookTable"},enableSort:!0,sortConfig:{descriptor:IFB.Descriptors.Bancomer_Estado.descriptor,direction:"desc"}},configHeaderSelector:{config:"header_selector",title:"componentTitle_UserHeader_OrderBookTable"}},investmentDetail_orderDetail:{serviceBCOMParams:{operationCode:"5"},viewOptions:{el:"#investmentDetail_orderDetail",templateId:"investmentDetail_orderDetail",templateFile:"/investmentDetail/orderDetail_table.htm",dataTable:{id:"orderDetailTable"}}},orderDetail_markUp:{serviceParams:{},viewOptions:{el:"#lightboxOrderDetail",templateId:"orderDetail_markUp",templateFile:"/investmentDetail/orderDetail_markUp.htm"}},orderCancel_markUp:{serviceParams:{},viewOptions:{el:"#lightboxOrderCancel",templateId:"orderCancel_markUp",templateFile:"/orderCancel/markUp.htm"}},orderCancel_confirmation:{serviceParams:{},serviceBCOMParams:{operationCode:"4",params:{data1:"1"}},viewOptions:{templateId:"orderCancel_confirmation",templateFile:"/orderCancel/orderConfirmation.htm"}},home_moduleFilter_marketSummary:{serviceParams:{},viewOptions:{el:"#moduleFilterMarketSummary",templateId:"home_moduleFilter_marketSummary",templateFile:"/home/moduleFilter_marketSummary.htm"}},home_moduleFilter_topFlop:{serviceParams:{},viewOptions:{el:"#moduleFilterTopFlop",templateId:"home_moduleFilter_topFlop",templateFile:"/home/moduleFilter_topFlop.htm"}},home_moduleFilter_investmentDetail:{serviceParams:{},viewOptions:{el:"#moduleFilterInvestmentDetail",templateId:"home_moduleFilter_investmentDetail",templateFile:"/home/moduleFilter_investmentDetail.htm"}},home_moduleFilter_researchNews:{serviceParams:{},viewOptions:{el:"#moduleFilterResearchNews",templateId:"home_moduleFilter_researchNews",templateFile:"/home/moduleFilter_researchNews.htm"}},researchNews_moduleFilter_researchNews:{serviceParams:{},viewOptions:{el:"#moduleFilterResearchNewsMaximized",templateId:"researchNews_moduleFilter_researchNews",templateFile:"/researchNews/moduleFilter_researchNews.htm"}},header_search_instrumentList:{serviceParams:{data:{header:"10103,40,25",sort:"10103"}},viewOptions:{el:$("#search_instrumentList"),templateId:"header_search_instrumentList",templateFile:"/header/searchInstrumentList.htm",sortConfig:{descriptor:IFB.Descriptors.IFBShortName.descriptor},niceScroll:{id:"niceScrollSearch"}}},menuHeader_settings:{serviceParams:{},viewOptions:{el:$("#settingsBubble"),templateId:"menuHeader_settings",templateFile:"/header/settings.htm"}},instrumentDetail_markUp:{serviceParams:{},viewOptions:{el:"#lightboxInstrumentDetail",templateId:"instrumentDetail_markUp",templateFile:"/instrumentDetail/base/markUp.htm"}},instrumentDetail_issuer_resume:{serviceParams:{data:{header:"642,10103,420,240,250,60,70,370,380,390,410,8730,710,8760,8770,568,5101,9754,670,936,5102",rt:"1",sort:"-1",type:"4"}},viewOptions:{el:"#instrumentDetail_resume",templateId:"instrumentDetail_issuer_resume",templateFile:"/instrumentDetail/issuer/resume.htm",streaming:!0,highlightDescriptors:[],topFlopBackgroundCls:{top:"ifb-bgTop",flop:"ifb-bgFlop",equal:"ifb-bgEqual"},topFlopArrowCls:{top:"ifb-topArrowWhite",flop:"ifb-flopArrowWhite",equal:"ifb-equalArrowWhite"}}},instrumentDetail_warrant_resume:{serviceParams:{data:{header:"642,10103,420,240,250,60,70,9875,9881,9857,9872,10104,9825,25,9886,568,5101,568,5102",rt:"1",sort:"-1",type:"4"}},viewOptions:{el:"#instrumentDetail_resume",templateId:"instrumentDetail_warrant_resume",templateFile:"/instrumentDetail/warrant/resume.htm",streaming:!0,topFlopBackgroundCls:{top:"ifb-bgTop",flop:"ifb-bgFlop",equal:"ifb-bgEqual"},topFlopArrowCls:{top:"ifb-topArrowWhite",flop:"ifb-flopArrowWhite",equal:"ifb-equalArrowWhite"}}},instrumentDetail_etf_resume:{serviceParams:{data:{header:"642,10103,420,240,250,60,70,370,380,390,410,8730,710,8760,8770,568,5101,568,5102",rt:"1",sort:"-1",type:"4"}},viewOptions:{el:"#instrumentDetail_resume",templateId:"instrumentDetail_etf_resume",templateFile:"/instrumentDetail/etf/resume.htm",streaming:!0,topFlopBackgroundCls:{top:"ifb-bgTop",flop:"ifb-bgFlop",equal:"ifb-bgEqual"},topFlopArrowCls:{top:"ifb-topArrowWhite",flop:"ifb-flopArrowWhite",equal:"ifb-equalArrowWhite"}}},instrumentDetail_etf_serie:{serviceParams:{data:{header:"9833,27,25,9846,9758,9759,9827,9828,9829,9830,40,9757,9912,9845,9840,9841,9839,9834,9835,9838,9836,9837,9860",rt:"1",sort:"-1",type:"4"}},viewOptions:{el:"#instrumentDetail_resume",templateId:"instrumentDetail_etf_serie",templateFile:"/instrumentDetail/etf/serie.htm",streaming:!0}},instrumentDetail_etf_positions:{serviceParams:{data:{type:"4",header:"735,350,740,330,340,750,360"}},viewOptions:{el:"#instrumentDetail_positions",templateId:"instrumentDetail_etf_positions",templateFile:"/instrumentDetail/etf/positions.htm",highlightDescriptors:[],streaming:!0}},instrumentDetail_index_resume:{serviceParams:{data:{header:"642,10103,420,240,250,60,70,370,380,390,410,8730,710,8760,8770,568,5101,568,5102",rt:"1",sort:"-1",type:"4"}},viewOptions:{el:"#instrumentDetail_resume",templateId:"instrumentDetail_index_resume",templateFile:"/instrumentDetail/index/resume.htm",streaming:!0,highlightDescriptors:[],topFlopBackgroundCls:{top:"ifb-bgTop",flop:"ifb-bgFlop",equal:"ifb-bgEqual"},topFlopArrowCls:{top:"ifb-topArrowWhite",flop:"ifb-flopArrowWhite",equal:"ifb-equalArrowWhite"}}},instrumentDetail_issuer_serie:{serviceParams:{data:{header:"9833,27,25,9846,9758,9759,9827,9828,9829,9830,40,9757,9912,9845,9840,9841,9839,9834,9835,9838,9836,9837,9860",rt:"1",sort:"-1",type:"4"}},viewOptions:{el:"#instrumentDetail_resume",templateId:"instrumentDetail_issuer_serie",templateFile:"/instrumentDetail/issuer/serie.htm",streaming:!0}},instrumentList_markUp:{serviceParams:{},viewOptions:{el:$("#mainContent"),templateId:"instrumentList_markUp",templateFile:"/instrumentList/markUp.htm"}},instrumentList_table:{serviceParams:{data:{type:"3",header:"70,642,9558,9828,9829,330,340,740,750,356,1562,250,420,10103,670,40",sort:"10103",numVals:"50"},header:{columnado:"TAURO_ACCIONES2_PANORAMA2",tipo:"1",defecto:"0"}},viewOptions:{el:"#instrumentList_table",templateId:"instrumentList_table",templateFile:"/instrumentList/table.htm",streaming:!0,enableSort:!0,sortConfig:{direction:"asc",descriptor:"D9828"},dataTable:{id:"instrumentListTable"}},configHeaderSelector:{config:"header_selector",title:"componentTitle_UserHeader_InstrumentList"}},instrument_listTopFlop:{serviceParams:{data:{type:"3",header:"70,642,9558,9828,9829,330,340,740,750,356,1562,250,420,10103,670,40",sort:"10103",numVals:"50"},header:{columnado:"TAURO_ACCIONES2_PANORAMA2",tipo:"1",defecto:"0"}},viewOptions:{el:"#instrumentList_table",templateId:"instrumentList_table",templateFile:"/instrumentList/table.htm",streaming:!0,enableSort:!0,sortConfig:{direction:"asc",descriptor:"D642"},dataTable:{id:"instrumentListTable"},highlightDescriptors:["420","250","330","340","740","750","670"]},configHeaderSelector:{config:"header_selector",title:"componentTitle_UserHeader_InstrumentList"}},newsDetail_markUp:{serviceParams:{},viewOptions:{el:"#lightboxNewsDetail",templateId:"newsDetail_markUp",templateFile:"/newsDetail/markUp.htm"}},newsDetail_newsDetail:{serviceParams:{},viewOptions:{el:"#newsDetail_newsDetail",templateId:"newsDetail_newsDetail",templateFile:"/newsDetail/newsDetail.htm",niceScroll:{id:"niceScrollNewsDetail"},titleTextKey:"componentLabel_NewsDetail_Title_Research&News"}},researchNews_markUp:{serviceParams:{},viewOptions:{el:$("#mainContent"),templateId:"researchNews_markUp",templateFile:"/researchNews/markUp.htm"}},researchNews_ResearchNews:{viewOptions:{},news:{markUp:"researchNews_ResearchNews_markUpNews",components:[{config:"researchNews_ResearchNews_News"}]},research:{markUp:"researchNews_ResearchNews_markUpResearch",components:[{config:"researchNews_ResearchNews_Research"}]},researchNews:{markUp:"researchNews_ResearchNews_markUpResearchNews",components:[{config:"researchNews_ResearchNews_ResearchNews_Research"},{config:"researchNews_ResearchNews_ResearchNews_News"}]},urlFileNode:"FicheroIB"},researchNews_ResearchNews_markUpResearchNews:{serviceParams:{},viewOptions:{el:"#researchNews",templateId:"researchNews_ResearchNews_markUpResearchNews",templateFile:"/researchNews/researchNews_markUpResearchNews.htm"}},researchNews_ResearchNews_markUpNews:{serviceParams:{},viewOptions:{el:"#researchNews",templateId:"researchNews_ResearchNews_markUpNews",templateFile:"/researchNews/researchNews_markUpNews.htm"}},researchNews_ResearchNews_markUpResearch:{serviceParams:{},viewOptions:{el:"#researchNews",templateId:"researchNews_ResearchNews_markUpResearch",templateFile:"/researchNews/researchNews_markUpResearch.htm"}},researchNews_ResearchNews_News:{serviceParams:{searchFunc:"41",numberOfItems:22,data:{sources:"INFOSEL_BOLSA;INFOSEL_EMPRESAS;EMISNET"}},viewOptions:{el:"#researchNewsNews",templateId:"researchNews_ResearchNews_News",templateFile:"/researchNews/news.htm",itemIdPrefix:"researchNewsNews",streaming:!0}},researchNews_ResearchNews_Research:{serviceParams:{searchFunc:"41",numberOfItems:22,data:{sources:"BCMRANALISIS"}},viewOptions:{el:"#researchNewsResearch",templateId:"researchNews_ResearchNews_Research",templateFile:"/researchNews/research.htm",itemIdPrefix:"researchNewsResearch",streaming:!0}},researchNews_ResearchNews_ResearchNews_News:{
serviceParams:{searchFunc:"41",numberOfItems:11,data:{sources:"INFOSEL_BOLSA;INFOSEL_EMPRESAS;EMISNET"}},viewOptions:{el:"#researchNewsNews",templateId:"researchNews_ResearchNews_ResearchNews_News",templateFile:"/researchNews/researchNews_news.htm",itemIdPrefix:"researchNewsNews",streaming:!0}},researchNews_ResearchNews_ResearchNews_Research:{serviceParams:{searchFunc:"41",numberOfItems:11,data:{sources:"BCMRANALISIS"}},viewOptions:{el:"#researchNewsResearch",templateId:"researchNews_ResearchNews_ResearchNews_Research",templateFile:"/researchNews/researchNews_research.htm",itemIdPrefix:"researchNewsResearch",streaming:!0}},indexDetailPage_markUp:{serviceParams:{},viewOptions:{el:$("#mainContent"),templateId:"indexDetailPage_markUp",templateFile:"/indexDetailPage/markUp.htm"}},indexDetailPage_indexChart:{serviceParams:{data:{param:"BPG003",type:"1",header:"10103,250,3002,642",sort:"-1"}},viewOptions:{el:$("#indexDetailPageChart"),templateId:"indexDetailPage_indexChart",templateFile:"/base/indexChart.htm",streaming:!0,numberOfItems:8,percentageEqual:2}},indexDetailPage_indexTable:{serviceParams:{data:{param:"BPG002",type:"1",rt:"1",sort:"-1"},header:{columnado:"TAURO_INDICES_INDICES2",tipo:"1",defecto:"0"}},viewOptions:{el:$("#indexDetailPageTable"),templateId:"indexDetailPage_indexTable",templateFile:"/instrumentList/table.htm",streaming:!0,dataTable:{id:"marketGridTable"}},configHeaderSelector:{config:"header_selector",title:"componentTitle_UserHeader_Index"}},instrumentDetail_resumeCharts:{serviceParams:{data:{header:"420,60,70,5101,5102,568,591",rt:"1",sort:"-1",type:"4"}},viewOptions:{el:"#instrumentDetailResumeCharts",templateId:"instrumentDetail_resumeCharts",templateFile:"/instrumentDetail/base/resumeCharts.htm",streaming:!0,highlightDescriptors:[]},charts:{intraday:{type:"line",frequency:"1"},daily:{type:"line",frequency:"d",period:"1y"}},saveOnServer:"0"},chartIntraday:{serviceParams:{data:{type:"4",descriptors:"60,70,420,642,790",compressionMult:"1"}},viewOptions:{streaming:!0,colors:["#009EE5"],trendClassnames:["ifb-equal","ifb-top","ifb-flop"],lineWidth:2,tooltipCrosshairsColor:"#FBBBBC",colorLabelXAxis:"#8C949C",colorLineXAxis:"#D4E1EC",colorTickXAxis:"#D4E1EC",colorLabelYAxis:"#8C949C",colorLineYAxis:"#D4E1EC",colorTickYAxis:"#D4E1EC",colorGridLineYAxis:"#D4E1EC",tooltipEnabled:!0,decimalsYAxis:3,pinchType:null,followTouchMove:!0}},chartDaily:{serviceParams:{data:{type:"4",descriptors:"60,70,420,642,790"}},viewOptions:{streaming:!1,colors:["#009EE5"],trendClassnames:["ifb-equal","ifb-top","ifb-flop"],lineWidth:2,tooltipCrosshairsColor:"#FBBBBC",colorLabelXAxis:"#8C949C",colorLineXAxis:"#D4E1EC",colorTickXAxis:"#D4E1EC",colorLabelYAxis:"#8C949C",colorLineYAxis:"#D4E1EC",colorTickYAxis:"#D4E1EC",colorGridLineYAxis:"#D4E1EC",tooltipEnabled:!0,decimalsYAxis:3,pinchType:null,followTouchMove:!0}},instrumentDetail_research:{serviceParams:{searchFunc:"41",data:{fromDate:moment().subtract("d",70).format("YYYYMMDD"),sources:"BCMRANALISIS"}},viewOptions:{el:"#instrumentDetail_resume",templateId:"instrumentDetail_research",templateFile:"/instrumentDetail/base/research.htm",dataTable:{id:"researchTable"}},urlFileNode:"FicheroIB"},instrumentDetail_header:{serviceParams:{data:{header:"10103,40,9828,9829,420,370,240,250,60,70",rt:"1",sort:"-1",type:"4"}},viewOptions:{el:"#instrumentDetail_header",templateId:"instrumentDetail_header",templateFile:"/instrumentDetail/base/header.htm"}},header_message:{serviceParams:{data:{fuentes:"BWTMENSAJES",fecha:moment().format("YYYYMMDD")}},viewOptions:{el:$("#menuBtnMessage"),templateId:"header_Message",templateFile:"/header/message.htm",streaming:!0,format:"1"}},header_notice:{serviceParams:{data:{fuentes:"BWTAVISOS",fecha:moment().format("YYYYMMDD")}},viewOptions:{el:$("#menuBtnNotice"),templateId:"header_notice",templateFile:"/header/notice.htm",streaming:!0,format:"2"}},clickOn:{serviceParams:{},viewOptions:{el:$("#clickOn"),templateId:"clikcOn",templateFile:"/clickOn/clickOn.htm"}},newsList_markUp:{serviceParams:{},viewOptions:{el:"#lightboxMessageNotice",templateId:"newsList_markUp",templateFile:"/newsList/markUp.htm"}},newsList_newsList:{serviceParams:{},viewOptions:{el:"#newsList_table",templateId:"newsList_newsList",templateFile:"/newsList/table.htm",niceScroll:{id:"newsListTable"},streaming:!0,clsItemNoRead:"noRead",clsItemEven:"par",counterId:"newsListCounter"}},newsList_newsDetail:{serviceParams:{},viewOptions:{el:"#newsList_detail",templateId:"newsList_newsDetail",templateFile:"/newsList/detail.htm",niceScroll:{id:"niceScrollNewsDetailList"},itemIdPrefix:"homeNewsBasic"}},instrumentDetail_issuer_positions:{serviceParams:{data:{type:"4",header:"735,350,740,330,340,750,360"}},viewOptions:{el:"#instrumentDetail_positions",templateId:"instrumentDetail_issuer_positions",templateFile:"/instrumentDetail/issuer/positions.htm",highlightDescriptors:[],streaming:!0}},instrumentDetail_issuer_multiples:{serviceParams:{data:{type:"4",header:"716,676,677,717,678,679,718,681,682,683,684,686,687,688,689,4221,4220,4224,4231,4230,4234,4233,4232,4235,4241,4240,4225,4223"}},viewOptions:{el:"#instrumentDetail_resume",templateId:"instrumentDetail_issuer_multiples",templateFile:"/instrumentDetail/issuer/multiples.htm",streaming:!0}},instrumentDetail_news:{serviceParams:{searchFunc:"41",data:{fromDate:moment().subtract("d",70).format("YYYYMMDD"),sources:"EMISNET"}},viewOptions:{el:"#instrumentDetail_resume",templateId:"instrumentDetail_news",templateFile:"/instrumentDetail/base/news.htm",dataTable:{id:"newsTable"}},urlFileNode:"FicheroIB"},instrumentDetail_view:{serviceParams:{searchFunc:"41",data:{sources:"EMISNET;BCMRANALISIS",fromDate:moment().subtract("d",1e3).format("YYYYMMDD")},numberOfItems:14},viewOptions:{el:"#instrumentDetail_resume",templateId:"instrumentDetail_view",templateFile:"/instrumentDetail/base/view.htm",itemIdPrefix:"item",streaming:!0,greenClsSources:["EMISNET"],blueClsSources:["BCMRANALISIS"]},urlFileNode:"FicheroIB",maxTitleLength:100},investmentDetail_chart1:{serviceParams:{data:{param:"I MX   ",header:"420,10103",type:"4"}},viewOptions:{el:"#chart1",templateId:"investmentDetail_chart1",templateFile:"/investmentDetail/chart.htm",filters:{chartType:{el:"#chart1FilterChartType",suffixCls:"1",config:"investmentDetail_filter_chartType"},period:{el:"#chart1FilterPeriod",suffixCls:"1",config:"investmentDetail_filter_period"},frequency:{el:"#chart1FilterFrequency",suffixCls:"1",config:"investmentDetail_filter_frequency"}}},charts:{intraday:{type:"line",frequency:"1",period:"1d"},daily:{type:"line",frequency:"d",period:"1y"}},saveOnServer:"1"},investmentDetail_chart2:{serviceParams:{data:{param:"I NY   ",header:"420,10103",type:"4"}},viewOptions:{el:"#chart2",templateId:"investmentDetail_chart2",templateFile:"/investmentDetail/chart.htm",filters:{chartType:{el:"#chart2FilterChartType",suffixCls:"2",config:"investmentDetail_filter_chartType"},period:{el:"#chart2FilterPeriod",suffixCls:"2",config:"investmentDetail_filter_period"},frequency:{el:"#chart2FilterFrequency",suffixCls:"2",config:"investmentDetail_filter_frequency"}}},charts:{intraday:{type:"line",frequency:"1",period:"1d"},daily:{type:"line",frequency:"d",period:"1y"}},saveOnServer:"1"},investmentDetail_chart3:{serviceParams:{data:{param:"I ME   ",header:"420,10103",type:"4"}},viewOptions:{el:"#chart3",templateId:"investmentDetail_chart3",templateFile:"/investmentDetail/chart.htm",filters:{chartType:{el:"#chart3FilterChartType",suffixCls:"3",config:"investmentDetail_filter_chartType"},period:{el:"#chart3FilterPeriod",suffixCls:"3",config:"investmentDetail_filter_period"},frequency:{el:"#chart3FilterFrequency",suffixCls:"3",config:"investmentDetail_filter_frequency"}}},charts:{intraday:{type:"line",frequency:"1",period:"1d"},daily:{type:"line",frequency:"d",period:"1y"}},saveOnServer:"1"},investmentDetail_filter_chartType:{serviceParams:{},viewOptions:{templateId:"investmentDetail_filter_chartType",templateFile:"/investmentDetail/moduleFilterChartType.htm"}},investmentDetail_filter_period:{serviceParams:{},viewOptions:{templateId:"investmentDetail_filter_period",templateFile:"/investmentDetail/moduleFilterPeriod.htm"}},investmentDetail_filter_frequency:{serviceParams:{},viewOptions:{templateId:"investmentDetail_filter_frequency",templateFile:"/investmentDetail/moduleFilterFrequency.htm"}},investmentChartDetail_markUp:{serviceParams:{},viewOptions:{el:$("#mainContent"),templateId:"investmentChartDetail_markUp",templateFile:"/investmentChartDetail/markUp.htm"}},investmentChartDetail_filter_chartType:{serviceParams:{},viewOptions:{templateId:"investmentChartDetail_filter_chartType",templateFile:"/investmentChartDetail/moduleFilterChartType.htm"}},investmentChartDetail_filter_period:{serviceParams:{},viewOptions:{templateId:"investmentChartDetail_filter_period",templateFile:"/investmentChartDetail/moduleFilterPeriod.htm"}},investmentChartDetail_filter_frequency:{serviceParams:{},viewOptions:{templateId:"investmentChartDetail_filter_frequency",templateFile:"/investmentChartDetail/moduleFilterFrequency.htm"}},positionDetail_markUp:{serviceParams:{},viewOptions:{el:$("#mainContent"),templateId:"positionDetail_markUp",templateFile:"/positionDetail/markUp.htm"}},positionDetail_positionTable:{serviceBCOMParams:{operationCode:"7",params:{data1:"D"}},serviceParams:{header:{columnado:"TAURO_DETALLE_POSICION_2",tipo:"1",defecto:"0"},data:{header:"1538,642,356,1562,250,410,390,9754"}},viewOptions:{el:"#positionDetail_positionTable",templateId:"positionDetail_positionTable",templateFile:"/positionDetail/positionTable.htm",streaming:!0,highlightDescriptors:["1538","356","1562","250","390","410","9754"],dataTable:{id:"positionTable"},enableSort:!0,sortConfig:{descriptor:IFB.Descriptors.Emisora.descriptor}},configHeaderSelector:{config:"header_selector",file:"investmentDetail_positionTable"}},orderBookDetail_markUp:{serviceParams:{},viewOptions:{el:$("#mainContent"),templateId:"orderBookDetail_markUp",templateFile:"/orderBookDetail/markUp.htm"}},orderBookDetail_orderBookTable:{serviceBCOMParams:{operationCode:"4",params:{data1:"4"}},serviceParams:{header:{columnado:"TAURO_DETALLEINVERSIONORDENES",tipo:"1",defecto:"0"},data:{header:"1538,642,356,1562,250,410,390,9754"}},viewOptions:{el:"#orderBookDetail_orderBookTable",templateId:"orderBookDetail_orderBookTable",templateFile:"/orderBookDetail/orderBookTable.htm",dataTable:{id:"orderBookTable"},enableSort:!0,sortConfig:{descriptor:IFB.Descriptors.Bancomer_Estado.descriptor,direction:"desc"}},configHeaderSelector:{config:"header_selector",file:"investmentDetail_orderBookTable"}},header_selector:{serviceParams:{},viewOptions:{el:"#lightboxHeaderSelector",templateId:"header_selector",templateFile:"/base/headerSelector.htm"}},tutorial_markUp:{serviceParams:{},viewOptions:{el:$("#mainContent"),templateId:"tutorial_markUp",templateFile:"/tutorial/markUp.htm"}},instrumentList_moduleFilter:{serviceParams:{},viewOptions:{el:"#moduleFilterInstrumentList",templateId:"instrumentList_moduleFilter",templateFile:"/instrumentList/moduleFilter.htm"}},instrument_selector:{serviceParams:{},viewOptions:{el:"#lightboxInstrumentSelector",templateId:"instrument_selector",templateFile:"/base/instrumentSelector.htm"},numMinimum:5,searchTextKey:"componentInstrumentSelector_IndexSelected",itemsSelectedTextKey:"componentInstrumentSelector_IndexNoSelected",placeHolderText:"componentLabel_Placeholder_IndexSelector"},instrument_selector_maximized:{serviceParams:{},viewOptions:{el:"#lightboxInstrumentSelector",templateId:"instrument_selector_maximized",templateFile:"/base/instrumentSelector.htm"},numMinimum:8,searchTextKey:"componentInstrumentSelector_IndexSelected",itemsSelectedTextKey:"componentInstrumentSelector_IndexNoSelected"},instrument_selector_search_result:{serviceParams:{data:{header:"10103,40,25,9828,9829",sort:"10103"}},viewOptions:{el:"#instrument_selector_search_result",templateId:"instrument_selector_search_result",templateFile:"/base/instrumentSelectorSearchResults.htm",sortConfig:{descriptor:IFB.Descriptors.IFBShortName.descriptor}},pattern:"0;29;20(07)|20(25),{0},,I;I0;I1;I2;I3,0,,3,0,1"},footerMenu:{serviceParams:{},viewOptions:{el:"#footerMenu",templateId:"footerMenu",templateFile:"/base/menu.htm",maxItems:6}},workspace_layout_markUp1:{serviceParams:{},viewOptions:{el:$("#mainContent"),templateId:"workspace_layout_markUp1",templateFile:"/workspaceLayout/markUp1.htm"}},workspace_layout_options:{serviceParams:{},viewOptions:{templateId:"workspace_layout_options",templateFile:"/workspaceLayout/options.htm"}},workspace_layout_chart:{serviceParams:{data:{param:"I MX   ",header:"420,10103",type:"4"}},viewOptions:{templateId:"workspace_layout_chart",templateFile:"/workspaceLayout/chart.htm",filters:{chartType:{el:"#chartLayoutModuleFilterChartType",config:"workspaceLayout_filter_chartType",modulePrueba:1},period:{el:"#chartLayoutModuleFilterPeriod",config:"workspaceLayout_filter_period"},frequency:{el:"#chartLayoutModuleFilterFrequency",config:"workspaceLayout_filter_frecuency"}}},charts:{intraday:{type:"line",frequency:"1",period:"1d"},daily:{type:"line",frequency:"d",period:"1y"}}},workspace_layout_chart_maximized:{serviceParams:{data:{param:"I MX   ",header:"420,10103",type:"4"}},viewOptions:{templateId:"workspace_layout_chart_maximized",templateFile:"/workspaceLayout/chart_maximized.htm",filters:{chartType:{el:"#detailLayoutModuleChartFilterChartType",suffixCls:"1",config:"workspaceLayout_max_filter_chartType"},period:{el:"#detailLayoutModuleChartFilterPeriod",suffixCls:"1",config:"workspaceLayout_max_filter_period"},frequency:{el:"#detailLayoutModuleChartFilterFrequency",suffixCls:"1",config:"workspaceLayout_max_filter_frecuency"}}},charts:{intraday:{type:"line",frequency:"1",period:"1d"},daily:{type:"line",frequency:"d",period:"1y"}}},workspaceLayout_filter_chartType:{serviceParams:{},viewOptions:{templateId:"workspaceLayout_filter_chartType",templateFile:"/workspaceLayout/moduleFilterChartType.htm"}},workspaceLayout_filter_period:{serviceParams:{},viewOptions:{templateId:"workspaceLayout_filter_period",templateFile:"/workspaceLayout/moduleFilterPeriod.htm"}},workspaceLayout_filter_frecuency:{serviceParams:{},viewOptions:{templateId:"workspaceLayout_filter_frecuency",templateFile:"/workspaceLayout/moduleFilterFrecuency.htm"}},workspaceLayout_max_filter_chartType:{serviceParams:{},viewOptions:{templateId:"workspaceLayout_max_filter_chartType",templateFile:"/workspaceLayout/moduleMaxFilterChartType.htm"}},workspaceLayout_max_filter_period:{serviceParams:{},viewOptions:{templateId:"workspaceLayout_max_filter_period",templateFile:"/workspaceLayout/moduleMaxFilterPeriod.htm"}},workspaceLayout_max_filter_frecuency:{serviceParams:{},viewOptions:{templateId:"workspaceLayout_max_filter_frecuency",templateFile:"/workspaceLayout/moduleMaxFilterFrequency.htm"}},workspaces_module_indexes:{serviceParams:{},viewOptions:{templateId:"workspaces_module_indexes",templateFile:"/workspaceLayout/myInstruments.htm",configInstrumentList:"workspaces_module_indexes_table",titleTextKey:"componentLabel_ModuleWorkSpace_Option_Indexes"},pattern:"0;29;20(07)|20(25),{0},,I;I0;I1;I2;I3,0,,3,0,1",searchTextKey:"componentInstrumentSelector_IndexNoSelected",itemsSelectedTextKey:"componentInstrumentSelector_IndexSelected",placeHolderText:"componentLabel_Placeholder_IndexSelector"},workspaces_module_indexes_maximized:{serviceParams:{},viewOptions:{templateId:"workspaces_module_indexes_maximized",templateFile:"/workspaceLayout/myInstrumentsMaximized.htm",configInstrumentList:"workspaces_module_indexes_table",titleTextKey:"componentLabel_ModuleWorkSpace_Option_Indexes"},pattern:"0;29;20(07)|20(25),{0},,I;I0;I1;I2;I3,0,,3,0,1",searchTextKey:"componentInstrumentSelector_IndexNoSelected",itemsSelectedTextKey:"componentInstrumentSelector_IndexSelected",placeHolderText:"componentLabel_Placeholder_IndexSelector"},workspaces_module_indexes_table:{serviceParams:{data:{param:"I MX   ",type:"4",rt:"1",sort:"-1"},header:{columnado:"TAURO_INDICES_INDICES2",tipo:"1",defecto:"0",descriptoresAdicionales:"10103"}},viewOptions:{templateId:"workspaces_module_indexes_table",templateFile:"/instrumentList/table.htm",streaming:!0},configHeaderSelector:{config:"header_selector",title:"componentTitle_UserHeader_MyIndexes"}},workspaces_module_issuers:{serviceParams:{},viewOptions:{templateId:"workspaces_module_issuers",templateFile:"/workspaceLayout/myInstruments.htm",configInstrumentList:"workspaces_module_Issuers_table",titleTextKey:"componentLabel_ModuleWorkSpace_Option_Issuer"},pattern:"0;29;20(07)|20(25),{0},,MX;M0;M1;M2;M3;M4;M5;M6;M7;M8;M9;5V,0,,3,0,1",searchTextKey:"componentInstrumentSelector_InstrumentNoSelected",itemsSelectedTextKey:"componentInstrumentSelector_InstrumentSelected"},workspaces_module_issuers_maximized:{serviceParams:{},viewOptions:{templateId:"workspaces_module_issuers_maximized",templateFile:"/workspaceLayout/myInstrumentsMaximized.htm",configInstrumentList:"workspaces_module_Issuers_table",titleTextKey:"componentLabel_ModuleWorkSpace_Option_Issuer"},pattern:"0;29;20(07)|20(25),{0},,MX;M0;M1;M2;M3;M4;M5;M6;M7;M8;M9;5V,0,,3,0,1",searchTextKey:"componentInstrumentSelector_InstrumentNoSelected",itemsSelectedTextKey:"componentInstrumentSelector_InstrumentSelected"},workspaces_module_Issuers_table:{serviceParams:{data:{param:"MXPEO00",type:"4",rt:"1",sort:"-1"},header:{columnado:"TAURO_ACCIONES2_PANORAMA2",tipo:"1",defecto:"0",descriptoresAdicionales:"10103"}},viewOptions:{templateId:"workspaces_module_Issuers_table",templateFile:"/instrumentList/table.htm",streaming:!0},configHeaderSelector:{config:"header_selector",title:"componentTitle_UserHeader_MyIssuer"}},workspaces_module_investmentDetailTable:{serviceBCOMParams:{operationCode:"7",params:{data1:"D"}},serviceParams:{header:{columnado:"TAURO_DETALLE_POSICION_2",tipo:"1",defecto:"0"},data:{header:"1538,642,356,1562,250,410,390,9754"}},viewOptions:{el:"#investmentDetail_positionTable",templateId:"workspaces_module_investmentDetailTable",templateFile:"/workspaceLayout/position.htm",streaming:!0,highlightDescriptors:["1538","356","1562","250","390","410","9754"],enableSort:!0,sortConfig:{descriptor:IFB.Descriptors.Emisora.descriptor}},configHeaderSelector:{config:"header_selector",title:"componentTitle_UserHeader_PositionTable"}},workspaces_module_investmentDetailTable_maximized:{serviceBCOMParams:{operationCode:"7",params:{data1:"D"}},serviceParams:{header:{columnado:"TAURO_DETALLE_POSICION_2",tipo:"1",defecto:"0"},data:{header:"1538,642,356,1562,250,410,390,9754,70"}},viewOptions:{el:"#investmentDetail_positionTable",templateId:"workspaces_module_investmentDetailTable_maximized",templateFile:"/workspaceLayout/positionMaximized.htm",streaming:!0,highlightDescriptors:["1538","356","1562","250","390","410","9754"],enableSort:!0,sortConfig:{descriptor:IFB.Descriptors.Emisora.descriptor}},configHeaderSelector:{config:"header_selector",title:"componentTitle_UserHeader_PositionTable"}},workspaces_maximized_markUp:{serviceParams:{},viewOptions:{el:$("#mainContent"),templateId:"workspaces_maximized_markUp",templateFile:"/workspaceLayout/markUp_maximized.htm"}},workspaces_module_instruments_instrumentSelector:{serviceParams:{},viewOptions:{el:"#lightboxInstrumentSelector",templateId:"workspaces_module_instruments_instrumentSelector",templateFile:"/base/instrumentSelector.htm"}},workspaces_module_chart_instrumentSelector:{serviceParams:{},viewOptions:{el:"#lightboxInstrumentSelector",templateId:"workspaces_module_chart_instrumentSelector",templateFile:"/workspaceLayout/chartInstrumentSelector.htm"},pattern:"0;29;20(07)|20(25),{0},,I;I0;I1;I2;I3;MX;M0;M1;M2;M3;M4;M5;M6;M7;M8;M9;5V,0,,3,0,1"},chart_instrument_selector_search_result:{serviceParams:{data:{header:"10103,40,25,9828,9829",sort:"10103"}},viewOptions:{el:"#chart_instrument_selector_search_result",templateId:"chart_instrument_selector_search_result",templateFile:"/workspaceLayout/chartinstrumentSelectorSearchResults.htm",sortConfig:{descriptor:IFB.Descriptors.IFBShortName.descriptor}},pattern:"0;29;20(07)|20(25),{0},,I;I0;I1;I2;I3,0,,3,0,1"},historicalAlerts_markUp:{serviceParams:{},viewOptions:{el:"#lightboxHistoricalAlerts",templateId:"historicalAlerts_markUp",templateFile:"/alerts/historicalMarkUp.htm"}},historicalAlerts_list:{serviceParams:{},viewOptions:{el:"#historicalAlerts_table",templateId:"historicalAlerts_table",templateFile:"/alerts/historicalList.htm",niceScroll:{id:"alertsListTable"},clsItemNoRead:"noRead",clsItemEven:"par",counterId:"historicalListCounter"}}}})}(),BANCOMER.Utils.Filters={RESEARCH_CHANNEL:"1923",options:{marketSummary:{STOCKS:{key:"STOCKS",textKey:"componentLabel_ModuleFilterMarketSummary_Option_Stocks",mv:"RAMXC",constituentscode:"mx0001",constituentscodeDetail:"mx1002"},GLOBALMARKET:{key:"GLOBALMARKET",textKey:"componentLabel_ModuleFilterMarketSummary_Option_GlobalMarket",mv:"RAMXG",constituentscode:"mx0002",constituentscodeDetail:"mx0002"},STOCKS_GLOBALMARKET:{key:"STOCKS_GLOBALMARKET",textKey:"componentLabel_ModuleFilterMarketSummary_Option_StocksGlobalMarket",mv:"RAMXT",constituentscode:"mx0000",constituentscodeDetail:"mx0000"}},topFlop:{STOCKS:{key:"STOCKS",textKey:"componentLabel_ModuleFilterTopFlop_Option_Stocks",constituentscode:"mx0001",constituentscodeDetail:"mx1002"},GLOBALMARKET:{key:"GLOBALMARKET",textKey:"componentLabel_ModuleFilterTopFlop_Option_GlobalMarket",constituentscode:"mx0002",constituentscodeDetail:"mx0002"},STOCKS_GLOBALMARKET:{key:"STOCKS_GLOBALMARKET",textKey:"componentLabel_ModuleFilterTopFlop_Option_StocksGlobalMarket",constituentscode:"mx0000",constituentscodeDetail:"mx0000"},WARRANTS:{key:"WARRANTS",textKey:"componentLabel_ModuleFilterTopFlop_Option_Warrants",constituentscode:"mx0007",constituentscodeDetail:"mx0007"},ALL:{key:"ALL",textKey:"componentLabel_ModuleFilterTopFlop_Option_ALL",constituentscode:"mx1500",constituentscodeDetail:"mx1500"}},researchNews:{RESEARCH:{key:"RESEARCH",value:"research",textKey:"componentLabel_ModuleFilterResearchNews_Option_Research"},NEWS:{key:"NEWS",value:"news",textKey:"componentLabel_ModuleFilterResearchNews_Option_News"},RESEARCH_NEWS:{key:"RESEARCH_NEWS",value:"researchNews",textKey:"componentLabel_ModuleFilterResearchNews_Option_ResearchNews"}},investmentDetail:{STOCKS:{key:"STOCKS",textKey:"componentLabel_ModuleFilterInvestmentDetail_Option_Stocks",instrumentType:"V"},STOCKS_FUNDS:{key:"STOCKS_FUNDS",textKey:"componentLabel_ModuleFilterInvestmentDetail_Option_StocksFunds",instrumentType:""}},chartType:{LINE:{key:"LINE",textKey:"componentLabel_ModuleFilterChartType_Option_Line",type:IFB.Constants.Highcharts.ChartTypes.line},CANDLESTICK:{key:"CANDLESTICK",textKey:"componentLabel_ModuleFilterChartType_Option_Candlestick",type:IFB.Constants.Highcharts.ChartTypes.candlestick},OHLC:{key:"OHCL",textKey:"componentLabel_ModuleFilterChartType_Option_Ohlc",type:IFB.Constants.Highcharts.ChartTypes.ohlc},AREA:{key:"AREA",textKey:"componentLabel_ModuleFilterChartType_Option_Area",type:IFB.Constants.Highcharts.ChartTypes.area},COLUMN:{key:"COLUMN",textKey:"componentLabel_ModuleFilterChartType_Option_Column",type:IFB.Constants.Highcharts.ChartTypes.column}},chartPeriod:{P_1D:{key:"1D",textKey:"componentLabel_ModuleFilterPeriod_Option_1D",value:"1d",chartAvailability:["intraday"],frequencyAvailability:["1","5","10","30","60"]},P_1M:{key:"1M",textKey:"componentLabel_ModuleFilterPeriod_Option_1M",value:"1M",chartAvailability:["daily"],frequencyAvailability:["d","W","M"]},P_3M:{key:"3M",textKey:"componentLabel_ModuleFilterPeriod_Option_3M",value:"3M",chartAvailability:["daily"],frequencyAvailability:["d","W","M","Q"]},P_1Y:{key:"1Y",textKey:"componentLabel_ModuleFilterPeriod_Option_1Y",value:"1y",chartAvailability:["daily"],frequencyAvailability:["d","W","M","Q","S","Y"]},P_3Y:{key:"3Y",textKey:"componentLabel_ModuleFilterPeriod_Option_3Y",value:"3y",chartAvailability:["daily"],frequencyAvailability:["d","W","M","Q","S","Y"]},P_5Y:{key:"5Y",textKey:"componentLabel_ModuleFilterPeriod_Option_5Y",value:"5y",chartAvailability:["daily"],frequencyAvailability:["d","W","M","Q","S","Y"]}},chartFrequency:{F_1M:{key:"F_1M",textKey:"componentLabel_ModuleFilterFrequency_Option_1M",value:"1",chartAvailability:["intraday"],periodAvailability:["1d"]},F_5M:{key:"F_5M",textKey:"componentLabel_ModuleFilterFrequency_Option_5M",value:"5",chartAvailability:["intraday"],periodAvailability:["1d"]},F_10M:{key:"F_10M",textKey:"componentLabel_ModuleFilterFrequency_Option_10M",value:"10",chartAvailability:["intraday"],periodAvailability:["1d"]},F_30M:{key:"F_30M",textKey:"componentLabel_ModuleFilterFrequency_Option_30M",value:"30",chartAvailability:["intraday"],periodAvailability:["1d"]},F_60M:{key:"F_60M",textKey:"componentLabel_ModuleFilterFrequency_Option_60M",value:"60",chartAvailability:["intraday"],periodAvailability:["1d"]},DAILY:{key:"DAILY",textKey:"componentLabel_ModuleFilterFrequency_Option_Daily",value:"d",chartAvailability:["daily"],periodAvailability:["1M","3M","1y","3y","5y"]},WEEKLY:{key:"WEEKLY",textKey:"componentLabel_ModuleFilterFrequency_Option_Weekly",value:"W",chartAvailability:["daily"],periodAvailability:["1M","3M","1y","3y","5y"]},MONTHLY:{key:"MONTHLY",textKey:"componentLabel_ModuleFilterFrequency_Option_Monthly",value:"M",chartAvailability:["daily"],periodAvailability:["1M","3M","1y","3y","5y"]},QUARTERLY:{key:"QUATERLY",textKey:"componentLabel_ModuleFilterFrequency_Option_Quarterly",value:"Q",chartAvailability:["daily"],periodAvailability:["3M","1y","3y","5y"]},SEMESTERLY:{key:"SEMESTERLY",textKey:"componentLabel_ModuleFilterFrequency_Option_Semesterly",value:"S",chartAvailability:["daily"],periodAvailability:["1y","3y","5y"]},YEARLY:{key:"YEARLY",textKey:"componentLabel_ModuleFilterFrequency_Option_Yearly",value:"Y",chartAvailability:["daily"],periodAvailability:["1y","3y","5y"]}}}},BANCOMER.Utils.Helper={RESEARCH_CHANNEL:"1923",researchChannelEnable:void 0,showNotificationMessage:function(e,t,i,n){var o={layout:"center",text:t};this.showNotificationNoty(o,e,i,n)},showNotificationTemplate:function(e,t,i,n,o){var s={layout:o||"center",template:t};IFB.Utils.Helper.showNotificationNoty(s,e,i,n)},showNotificationNoty:function(e,t,i,n){e.type=this.getClsContainerNotification(t)||"success",e.modal=i||"false";var o=this;if(n){var s=[];_.each(n,function(e,t){s.push({addClass:e.cls||o.getClsButtonNotification(t,n.length),text:e.text,onClick:function(t){t.close(),e.callback&&e.callback()}})}),e.buttons=s}noty(e)},getClsContainerNotification:function(e){return-1!==["error","warning"].indexOf(e)?e+"_"+BANCOMER.Launcher.getOS():e},getClsContainerMessageNotification:function(){return"ifb-contNoty"+BANCOMER.Launcher.getOS()},getClsContainerMessageNotificationWorkSpace:function(){return"noty_"+BANCOMER.Launcher.getOS()+"_btn"},getClsButtonNotification:function(e,t){var i="btnNotification",n=BANCOMER.Launcher.getOS();return 1===t?i+="Center_"+n:0===e&&2===t?i+="Left_"+n:1===e&&2===t&&(i+="Right_"+n),i},showNotificationWorkSpaceName:function(e,t,i,n){BANCOMER.Utils.Helper.showNotificationTemplate(e,this.getNotificationTemplateWorkSpace(BANCOMER.CULTURETEXT.t("noty_WorkSpace_NameChange_Title"),t),i,n,"topCenter")},showNotificationIncomingMessage:function(e,t,i,n,o){var s=o||BANCOMER.CULTURETEXT.t("noty_Warning_Message");BANCOMER.Utils.Helper.showNotificationTemplate(e,this.getNotificationTemplate(s,t),i,n)},showNotificationWarning:function(e,t,i,n){BANCOMER.Utils.Helper.showNotificationTemplate(e,this.getNotificationTemplate(BANCOMER.CULTURETEXT.t("noty_Warning_Title"),t),i,n)},showNotificationError:function(e,t,i,n){BANCOMER.Utils.Helper.showNotificationTemplate(e,this.getNotificationTemplate(BANCOMER.CULTURETEXT.t("noty_Error_Title"),t),i,n)},getNotificationTemplate:function(e,t){var i=this.getClsContainerMessageNotification(),n='<div class="'+i+'"><section class="contTop"><div class="icoInfo"></div><h3>'+e+'</h3></section><section class="contTxtWarning"><div class="txtWarning">'+t+"</div></section></div>";return n},getNotificationTemplateWorkSpace:function(e,t){var i=this.getClsContainerMessageNotification(),n='<div class="'+i+'"><section class="contTopWorkSpace"><h3>'+e+'</h3></section><section class="contTxtWorkSpace"><div class="txtWarning">Nombre:</div>'+t+"</section></div>";return n},hash:function(e){var t=5381,i=0;for(i=0;i<e.length;i++)char=e.charCodeAt(i),t=(t<<5)+t+char;return t},getUserFiles:function(e,t,i){var n=this,o=new IFB.Services.Management;o.loadUserFiles({session:e||IFB.Services.Session,type:t,transform:"0"},function(e){n._readUserFiles(e,t,i)})},_readUserFiles:function(e,t,i){var n,o,s=[];e&&(n=JSON.parse(e),void 0!==n.status&&n.status.ok&&(n.answer.Files[t]&&(o=n.answer.Files[t],o.File&&(_.isArray(o.File)?_.each(o.File,function(e,t){s.push(e)}):s.push(o.File))),_.isFunction(i)&&i(s)))},createNiceScroll:function(e,t){var i,n=$("#"+t,e.config.viewOptions.el);n&&(i=n.css("height"),n.css("height",i),n.niceScroll({touchbehavior:!0}))},hasResearchChannel:function(e,t,i){var n=new IFB.Services.Management,o=this,s="CS"+this.RESEARCH_CHANNEL;_.isUndefined(o.researchChannelEnable)?n.getProfile({session:IFB.Services.Session,canalessubcanales:this.RESEARCH_CHANNEL},function(n){var r=JSON.parse(n);void 0!==r.answer&&void 0!==r.status&&r.status.ok?_.isNull(r.answer.PROFILE.CS)||"1"!==r.answer.PROFILE.CS[s]?(o.researchChannelEnable=!1,t(i)):(o.researchChannelEnable=!0,e(i)):(o.researchChannelEnable=!1,t(i))},this):o.researchChannelEnable?e(i):t(i)},hasStreamingEnabled:function(){return"1"===(BANCOMER.Defaults.Application.streaming||"1")},setRefreshIcon:function(){this.hasStreamingEnabled()?$(".iconRefresh").hide():$(".iconRefresh").show()},closeFooterMenu:function(){$("#clickableLevel").hide(),$("#footerMenu").hide("slow")},openFooterMenu:function(){$("#footerMenu").show("slow")},chartIntradayTooltipFormatter:function(e){return function(){var t="",i=this,n=i.points[0].series.type,o=this.points[0].point;return t=n===IFB.Constants.Highcharts.ChartTypes.candlestick||n===IFB.Constants.Highcharts.ChartTypes.ohlc?'<section class="ifb-tooltipGraph"><div class="time">'+Highcharts.dateFormat("%H:%M",i.x)+'</div><div class="last">O: '+Highcharts.numberFormat(o.open,e.getDecimals(),accounting.settings.number.decimal,accounting.settings.number.thousand)+'</div><div class="last">H: '+Highcharts.numberFormat(o.high,e.getDecimals(),accounting.settings.number.decimal,accounting.settings.number.thousand)+'</div><div class="last">L: '+Highcharts.numberFormat(o.low,e.getDecimals(),accounting.settings.number.decimal,accounting.settings.number.thousand)+'</div><div class="last">C: '+Highcharts.numberFormat(o.close,e.getDecimals(),accounting.settings.number.decimal,accounting.settings.number.thousand)+"</div></section>":'<section class="ifb-tooltipGraph"><div class="last">'+Highcharts.numberFormat(i.y,e.getDecimals(),accounting.settings.number.decimal,accounting.settings.number.thousand)+'</div><div class="time">'+Highcharts.dateFormat("%H:%M",i.x)+"</div></section>"}},chartDailyTooltipFormatter:function(e){return function(){var t="",i=this,n=i.points[0].series.type,o=this.points[0].point;return t=n===IFB.Constants.Highcharts.ChartTypes.candlestick||n===IFB.Constants.Highcharts.ChartTypes.ohlc?'<section class="ifb-tooltipGraph"><div class="time">'+Highcharts.dateFormat("%d/%m/%y",i.x)+'</div><div class="last">O: '+Highcharts.numberFormat(o.open,e.getDecimals(),accounting.settings.number.decimal,accounting.settings.number.thousand)+'</div><div class="last">H: '+Highcharts.numberFormat(o.high,e.getDecimals(),accounting.settings.number.decimal,accounting.settings.number.thousand)+'</div><div class="last">L: '+Highcharts.numberFormat(o.low,e.getDecimals(),accounting.settings.number.decimal,accounting.settings.number.thousand)+'</div><div class="last">C: '+Highcharts.numberFormat(o.close,e.getDecimals(),accounting.settings.number.decimal,accounting.settings.number.thousand)+"</div></section>":'<section class="ifb-tooltipGraph"><div class="last">'+Highcharts.numberFormat(i.y,e.getDecimals(),accounting.settings.number.decimal,accounting.settings.number.thousand)+'</div><div class="time">'+Highcharts.dateFormat("%d/%m/%y",i.x)+"</div></section>";
}},createDataTable:function(e){var t,i,n;t=e.viewOptions.dataTable,t&&(i=$("#"+t.id,e.viewOptions.el),i&&(n=i.dataTable(this.getConfigDataTable(i,t)),e.viewOptions.dataTable.fixedColumns&&new $.fn.dataTable.FixedColumns(n,t.fixedColumns)))},getConfigDataTable:function(e,t){var i=0,n=t.scrollHeight||e.parent().height()-e.find("thead").height()+i,o={paging:!1,searching:!1,ordering:!1,info:!1,scrollY:n+"px",scrollX:"100%",scrollCollapse:!0,language:{emptyTable:BANCOMER.CULTURETEXT.t("dataTable_ErrorMessage_EmptyTable")}};return o},getClickOnDocumentsFixedParams:function(){return{CLICKON_CODCOMPANY:"1",CLICKON_CODPRODUCT:"0084",CLICKON_CODSELLER:"59",CLICKON_EMAILLIST:"administracion@infobolsa.es"}},openExternalFile:function(e){var t={};e&&(t.data1=e,BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(BANCOMER.Services.BCOM.OperationCode.AperturaFichero,t,function(i){void 0!==i.answer&&void 0!==i.status&&i.status.ok&&t.id_testigo===i.answer.id_testigo&&console.log("OpenFile",e,"OK")}))},showMessageErrorSendOrderBCOM:function(e){var t=e&&e.status&&e.status.reason?"("+e.status.reason+")":"",i=[{text:BANCOMER.CULTURETEXT.t("noty_ErrorBCOM_Btn_Ok")}];IFB.Utils.Helper.showNotificationWarning("warning",BANCOMER.CULTURETEXT.t("noty_ErrorBCOM_Msg")+t,!0,i)},resetScrollTo:function(){$(":focus").blur(),setTimeout(function(){window.scrollTo(0,0)},0)},getWorkspaceDefaultTitle:function(e){return BANCOMER.CULTURETEXT.t("componentTitle_Workspace")+" "+e},onAlertComplete:function(e,t){BANCOMER.MANAGEMENTALERTS.notifyAlert(e,t)}},IFB.Utils.Helper.showNotificationMessage=function(e,t,i,n){return BANCOMER.Utils.Helper.showNotificationMessage(e,t,i,n)},IFB.Utils.Helper.showNotificationNoty=function(e,t,i,n){return BANCOMER.Utils.Helper.showNotificationNoty(e,t,i,n)},IFB.Utils.Helper.showNotificationTemplate=function(e,t,i,n){return BANCOMER.Utils.Helper.showNotificationTemplate("",t,i,n)},IFB.Utils.Helper.showNotificationWarning=function(e,t,i,n){return BANCOMER.Utils.Helper.showNotificationWarning(e,t,i,n)},IFB.Utils.Helper.showNotificationError=function(e,t,i,n){return BANCOMER.Utils.Helper.showNotificationError(e,t,i,n)},IFB.Utils.Helper.hash=function(e){return BANCOMER.Utils.Helper.hash(e)},IFB.Utils.Helper.getUserFiles=function(e){return BANCOMER.Utils.Helper.getUserFiles(e)},IFB.Utils.Helper.chartIntradayTooltipFormatter=function(e){return BANCOMER.Utils.Helper.chartIntradayTooltipFormatter(e)},IFB.Utils.Helper.chartDailyTooltipFormatter=function(e){return BANCOMER.Utils.Helper.chartDailyTooltipFormatter(e)},IFB.Utils.Helper.getClickOnDocumentsFixedParams=function(){return BANCOMER.Utils.Helper.getClickOnDocumentsFixedParams()},IFB.Utils.Helper.onAlertComplete=function(e,t){return BANCOMER.Utils.Helper.onAlertComplete(e,t)},BANCOMER.Utils.ManagementAlerts=IFB.Class(null,{mgService:void 0,viewedFileHistoricalAlerts:{name:"AlertasHistoricasLeidas",type:"NOTIF"},historicalAlerts:{},viewedFileHistoricalAlertsData:{},initialize:function(e){this.mgService=new IFB.Services.Management,this.mgService.loadFile({type:this.viewedFileHistoricalAlerts.type,file:this.viewedFileHistoricalAlerts.name},this.onViewedFileHistoricalAlertsLoaded,this)},onViewedFileHistoricalAlertsLoaded:function(e,t){var i=e?JSON.parse(e):{};t.viewedFileHistoricalAlertsData=i.status&&i.status.ok?i.answer:{},i.status&&i.status.ok?(!i.answer||i.answer.elementosLeidos&&i.answer.elementosLeidos.elementos||(t.historicalAlerts=[]),t.viewedFileHistoricalAlertsData=$.isArray(i.answer.elementosLeidos.elementos)?i.answer.elementosLeidos.elementos:[i.answer.elementosLeidos.elementos]):t.viewedFileHistoricalAlertsData=[],t.mgService.historicalAlerts({session:IFB.Services.Session},t.onHistoricalAlertsLoaded,t)},onHistoricalAlertsLoaded:function(e,t){var i,n=e?JSON.parse(e):{};return n.status&&n.status.ok&&(!n.answer||n.answer.Alertas&&n.answer.Alertas.Alerta)?(t.historicalAlerts=$.isArray(n.answer.Alertas.Alerta)?n.answer.Alertas.Alerta:[n.answer.Alertas.Alerta],_.each(t.historicalAlerts,function(e,n){i=_.find(t.viewedFileHistoricalAlertsData,function(t){return e.General.ID+e.Evaluador.Fecha.substr(6,2)+e.Evaluador.Fecha.substr(4,2)+e.Evaluador.Fecha.substr(0,4)+"-"+e.Evaluador.Hora===t.clave}),t.historicalAlerts[n].General.Leido=i?"1":"0"}),void t.updateAlertsIcon()):void(t.historicalAlerts=[])},setAlertView:function(e,t){var i=_.find(this.historicalAlerts,function(t){return t.General.ID===e});i.General.Leido="1",this.viewedFileHistoricalAlertsData.push({clave:e+i.Evaluador.Fecha.substr(6,2)+i.Evaluador.Fecha.substr(4,2)+i.Evaluador.Fecha.substr(0,4)+"-"+i.Evaluador.Hora,leido:"1"}),this.saveViewedFileHistoricalAlerts(t)},saveViewedFileHistoricalAlerts:function(e){var t=this,i={};i.elementosLeidos={},i.elementosLeidos.elementos=this.viewedFileHistoricalAlertsData,this.mgService.saveFile({session:this.session||IFB.Services.Session,type:this.viewedFileHistoricalAlerts.type,file:this.viewedFileHistoricalAlerts.name,content:JSON.stringify(i),replace:!0},function(i){_.isFunction(e)&&(e(),t.updateAlertsIcon())})},updateAlertsIcon:function(){var e=this.countAlertsNotViewed();""!==e&&(e=e>=10?"10":"0"+e),$("#menuBtnAlerts li").removeClass().addClass("icoAlarm"+e)},countAlertsNotViewed:function(){return _.countBy(this.historicalAlerts,function(e){return"1"===e.General.Leido?"Viewed":"NotViewed"}).NotViewed||""},notifyAlert:function(e,t){if(t&&t.info&&t.info.IdHist){var i=t.info.IdHist,n=t.info.Nombre;this.addHistoricalAlert(i,n,this.showNotificationAlert)}},showNotificationAlert:function(e,t,i){var n=[{text:"Ver",callback:function(){var t=_.find(BANCOMER.Router.lightboxes,function(e){return"pageTitle_HistoricalAlerts"===e.titleTextKey});t&&t.close(),document.location.href="#!/lightbox/alerts/historical/pageTitle_HistoricalAlerts/"+e}},{text:"Aceptar"}];BANCOMER.Utils.Helper.showNotificationIncomingMessage("warning","Su alerta "+t+" se ha cumplido.",!0,n,"Alerta")},addHistoricalAlert:function(e,t,i){var n=this;n.mgService.historicalAlerts({session:IFB.Services.Session,idAlerts:e},function(n,o){var s=n?JSON.parse(n):{};s.answer&&s.answer.Alertas&&s.answer.Alertas.Alerta&&(s.answer.Alertas.Alerta.General.Leido="0",o.historicalAlerts.unshift(s.answer.Alertas.Alerta)),o.updateAlertsIcon(),i(e,t,o)},n)}}),BANCOMER.Utils.Preferences={config:{researchNews:["home_ResearchNews","researchNews_ResearchNews"]},preferences:{modules:{},application:{},workspaces:{}},defaults:{loadOnInitialize:!0,file:"_~PREFERENCES",type:"PRF",replace:"1",waitForSaveMillis:500,transform:"0"},initialize:function(e,t){_.defaults(this,e||{},this.defaults),_.extend(this,Backbone.Events),this.mgService=new IFB.Services.Management({}),this.save=this.waitForSaveMillis>0?_.debounce(this._save,this.waitForSaveMillis):this._save,this.loadOnInitialize?this.load(t):t(null,this)},load:function(e){var t=this;this.mgService.loadFile({session:this.session||IFB.Services.Session,file:this.file,type:this.type,transform:this.transform},function(i){try{t.readPreferencesFromFile(i,t),_.isFunction(e)&&e(null,t,i)}catch(n){_.isFunction(e)&&e(n,t,i)}})},_save:function(e){var t=this;this.mgService.saveFile({session:this.session||IFB.Services.Session,file:this.file,type:this.type,replace:this.replace,content:this.formatContent(t.preferences),transform:this.transform},function(i){_.isFunction(e)&&e(null,t,i)})},readPreferencesFromFile:function(e,t){var i=JSON.parse(e);if(!IFB.Utils.Helper.getObjectValueIfExists(i,"status.ok"))throw new Error("Invalid response");t.preferences=i.answer,t.preferences.workspaces=t.preferences.workspaces||{}},formatContent:function(e){return e=e||{modules:{}},JSON.stringify(e)},addPreferenceModuleServiceParam:function(e,t){this.preferences.modules=this.preferences.modules||{},this.preferences.modules[e]=this.preferences.modules[e]||{},this.preferences.modules[e].serviceParams={data:{param:t}}},addPreferenceModuleServiceParamType:function(e,t,i){this.preferences.modules=this.preferences.modules||{},this.preferences.modules[e]=this.preferences.modules[e]||{},this.preferences.modules[e].serviceParams={data:{param:t,type:i}}},addPreferenceModuleViewOptions:function(e,t){this.preferences.modules=this.preferences.modules||{},this.preferences.modules[e]=this.preferences.modules[e]||{},this.preferences.modules[e].viewOptions=t},addPreferenceApplication:function(e,t){this.preferences.application=this.preferences.application||{},this.preferences.application[e]=t},getPreferenceApplication:function(e){return this.preferences.application&&!_.isUndefined(this.preferences.application[e])?this.preferences.application[e]:void 0},addPreferencesModuleResearchNews:function(e){var t=this;_.each(this.config.researchNews,function(i){t.addPreferenceModuleViewOptions(i,e)})},addPreferencesModuleInstrumentList:function(e,t,i){"marketSummary"===e?(this.addPreferenceModuleServiceParam("home_TopFlopPieChart",t),this.addPreferenceModuleServiceParam("home_multipleTopFlopActive",i)):"topFlop"===e&&this.addPreferenceModuleServiceParam("home_multipleTopFlopHorizontalList",i)},addPreferencesModule:function(e,t,i){this.preferences.modules=this.preferences.modules||{},this.preferences.modules[e]=this.preferences.modules[e]||{},this.preferences.modules[e][t]=i},getWorkspaceObject:function(e,t,i,n){return{title:e||BANCOMER.Utils.Helper.getWorkspaceDefaultTitle(t),layout:i,modules:n||{}}},updateModuleWorkspace:function(e,t,i){this.preferences.workspaces=this.preferences.workspaces||{},this.preferences.workspaces[e]=this.preferences.workspaces[e]||{},this.preferences.workspaces[e].modules[t]=this.preferences.workspaces[e].modules[t]||{},this.preferences.workspaces[e].modules[t]=i,this.save()},saveWorkspace:function(e,t){this.preferences.workspaces[e]=t,this.save()}},BANCOMER.Utils.Trader={orderTypeOptions:{LIMIT:{textKey:"orderType_Limit",value:"L"}},sideOptions:{BUY:{text:"Comprar",value:"Compra"},SELL:{text:"Vender",value:"Venta"}},orderStatus:{PENDING:{text:"Pendiente",value:"pe"},CANCELED:{text:"Cancelada",value:"c"},EXECUTED:{text:"Ejecutada",value:"m"}},actionReceiptOptions:{BUY:{value:"1"},SELL:{value:"2"},CANCEL:{value:"3"}},_findOrderType:function(e){var t=_.find(this.orderTypeOptions,function(t){return t.value===e},this);return t},getOrderTypeText:function(e){var t=this._findOrderType(e);return t.text},getOrderType:function(e){var t=this._findOrderType(e);return t.value},getSideText:function(e){var t=_.find(this.sideOptions,function(t){return t.value===e},this);return t.text},_findOrderStatus:function(e){var t=_.find(this.orderStatus,function(t){return t.value===e},this);return t},getOrderStatus:function(e){var t=this._findOrderStatus(e);return t.value},getOrderStatusText:function(e){var t=this._findOrderStatus(e);return t.text},isTradable:function(e){var t=IFB.Utils.ProductConfig.getAcciones(),i="",n=-1;return t&&t.Accion&&t.Accion[0]&&e&&(i=t.Accion[0].LM.split(","),n=_.indexOf(i,e.substring(0,2))),n>=0}},IFB.Descriptors=$.extend(!0,IFB.Descriptors,{IFBShortName:{css:"name"},DateOrTimeSituationMessage:{formatFunction:{name:"getDateOrTime",params:{onlySituationMessage:!0}},css:""},Last:{formatFunction:[{name:"getLast"},{name:"getCurrencySymbol"}],css:"last",topFlopColored:!0},ChangePercent:{formatFunction:{name:"getChangePercent",params:{positiveSign:""}},topFlopColored:!0,css:"difP"},Trend:{css:"arrow",topFlopColored:!0,formatFunction:{name:"getEmptyDivData"}},Emisora:{css:"name"},Date:{css:"date"},Time:{css:"time"},AskVolume:{css:"volSell"},BidVolume:{css:"volBuy"},AskPrice:{css:"priceSell"},BidPrice:{css:"priceBuy"},Cash:{css:"amount"},Serie:{css:"serie"},Buy:{css:"buy",formatFunction:function(){return"C"}},Sell:{css:"sell",formatFunction:function(){return"V"}},Bancomer_Estado:{formatFunction:{name:"getEstado"}},Bancomer_Accion_CancelarOrden:{css:"cancel"},Bancomer_Accion_DetalleOrden:{css:"detail"}}),BANCOMER.Components.Base=IFB.Class(IFB.Components.Base,{initialize:function(e){this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.Base.parent.initialize.call(this,e)}}),BANCOMER.Components.BoletaConfirmation=IFB.Class(BANCOMER.Components.Base,{view:void 0,model:void 0,create:function(){this.configure(),this.model=this.config.viewOptions.model,this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.Static(this.config.viewOptions),this.registerView(this.view),this._addEvents(),this.view.reset()},_addEvents:function(){this.on("sendOrderConfirmationClick",this.sendConfirmationOrderClick,this)},sendConfirmationOrderClick:function(){this.trigger("onSendOrderConfirmation",this.model.getConfirmationToTrader())}}),BANCOMER.Components.BoletaForm=IFB.Class(BANCOMER.Components.Base,{dataInstrument:{},view:void 0,model:void 0,create:function(){var e=this;this.configure(),this._getInstrumentSituation(function(t){e.dataInstrument=t,e._create()})},_create:function(){var e=this;this.model=new BANCOMER.Models.BoletaOrder({dataInstrument:this.dataInstrument,side:this.options.side}),this.model.load=function(){e._getInstrumentSituation(function(t){e.model.set("price",e.model.getSide()===BANCOMER.Utils.Trader.sideOptions.BUY.value?Number(t[IFB.Descriptors.AskPrice.descriptor]):Number(t[IFB.Descriptors.BidPrice.descriptor])),e.view.reset()})},this.model.options=this.config,this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.BoletaForm(this.config.viewOptions),this.registerView(this.view),this._addEvents(this.view),this.view.reset()},_addEvents:function(e){this.on("sendOrderClick",e.onSendOrderClick,e),e.on("cancelOrderClick",this.onCancelOrderClick,this),this.on("sharesKeyDown",e.sharesKeyDown,e),this.on("sharesKeyUp",e.sharesKeyUp,e),this.on("sharesFocusIn",e.sharesFocusIn,e),this.on("sharesFocusOut",e.sharesFocusOut,e),this.on("sharesClick",e.sharesClick,e),this.on("priceKeyDown",e.priceKeyDown,e),this.on("priceKeyUp",e.priceKeyUp,e),this.on("priceFocusIn",e.priceFocusIn,e),this.on("priceFocusOut",e.priceFocusOut,e),this.on("priceChange",e.onPriceChange,e),this.on("priceClick",e.onPriceClick,e)},onCancelOrderClick:function(){this.trigger("cancelOrderClick",this)},_getInstrumentSituation:function(e){var t=this,i={sesion:IFB.Services.Session,param:t.options.mv,type:t.config.serviceParams.data.type,header:t.config.serviceParams.data.header,rt:t.config.serviceParams.data.rt};this.dbService.loadDataLV(i,function(t){var i=JSON.parse(t);if(i.answer&&i.answer.LV){var n=i.answer.LV.V;e(n)}})}}),BANCOMER.Components.BoletaMenu=IFB.Class(BANCOMER.Components.Base,{view:void 0,model:void 0,create:function(){var e=this;this.configure(),this.model=new Backbone.Model(this.config),this.model.load=function(){e.view.reset()},this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.Static(this.config.viewOptions),this.registerView(this.view),this._addEvents(),this.view.reset()},_addEvents:function(){this.on("sendChangeSideClick",this.sendChangeSideClick,this)},sendChangeSideClick:function(e,t){e.side!==this.config.viewOptions.side&&this.trigger("sendChangeSide",e.side)}}),BANCOMER.Components.BoletaReceipt=IFB.Class(BANCOMER.Components.Base,{view:void 0,model:void 0,create:function(){this.configure(),this.model=this.config.viewOptions.model,this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.Static(this.config.viewOptions),this.registerView(this.view),this._addEvents(),this.view.reset()},_addEvents:function(){this.on("sendOrderReceiptSaveClick",this.sendOrderReceiptSaveClick,this),this.on("sendOrderReceiptMailClick",this.sendOrderReceiptMailClick,this),this.on("orderReceiptTooltipClick",this.showHideReceiptToolTip,this)},sendOrderReceiptSaveClick:function(){this.trigger("sendOrderReceiptSave",this.model.getReceiptSaveToTrader(this.getActionReceipt()))},sendOrderReceiptMailClick:function(){this.trigger("sendOrderReceiptMail",this.model.getReceiptMailToTrader(this.getActionReceipt()))},showHideReceiptToolTip:function(){$("#orderReceiptTooltip",this.$el).toggle()},getActionReceipt:function(){var e=this.model.getSide();return e===BANCOMER.Utils.Trader.sideOptions.BUY.value?BANCOMER.Utils.Trader.actionReceiptOptions.BUY.value:BANCOMER.Utils.Trader.actionReceiptOptions.SELL.value}}),BANCOMER.Components.ChartColumnInstrumentList=IFB.Class(IFB.Components.ChartColumnInstrumentList,{initialize:function(e){this._templates=BANCOMER.Defaults.Templates,IFB.Components.ChartColumnInstrumentList.parent.initialize.call(this,e)}}),BANCOMER.Components.ChartDaily=IFB.Class(IFB.Components.ChartDaily,{initialize:function(e){this._templates=BANCOMER.Defaults.Templates,IFB.Components.ChartDaily.parent.initialize.call(this,e)}}),BANCOMER.Components.ChartIndexes=IFB.Class(BANCOMER.Components.Base,{view:void 0,model:void 0,initialize:function(e){this._templates=IFB.Defaults.Templates,BANCOMER.Components.ChartIndexes.parent.initialize.call(this,e)},create:function(){this.configure("InstrumentList","/wtdb/LoadDataLV"),this.model=new IFB.Collections.InstrumentList(this.config),this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.ChartIndexes(this.config.viewOptions),this.registerView(this.view),this.model.load()}}),BANCOMER.Components.ChartInstrumentSelector=IFB.Class(BANCOMER.Components.Base,{view:void 0,model:void 0,searchComponent:void 0,activationDelay:1e3,activationTextLenght:3,numMinimum:0,searchPattern:"",initialize:function(e){this._templates=IFB.Defaults.Templates,BANCOMER.Components.InstrumentSelector.parent.initialize.call(this,e)},create:function(){this.configure(),this.model=new Backbone.Model(this.config),this.model.title=this.options.title,this.numMinimum=this.options.numMinimum||this.config.numMinimum||0,this.searchPattern=this.options.pattern||this.config.pattern||"",this.model.models=this.options.models||[],this.model.numMinimum=this.numMinimum,this.model.searchTextKey=this.options.searchTextKey||this.config.searchTextKey||"",this.model.itemsSelectedTextKey=this.options.itemsSelectedTextKey||this.config.itemsSelectedTextKey||"",this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.Static(this.config.viewOptions),this.registerView(this.view),this._addEvents(),this.view.reset()},_addEvents:function(){this.on("rendered",this.onRender,this)},initializeSearcher:function(){var e,t,i=this;this.initializeSearchComponent(),$("#chart_instrument_selector_search").on("click",function(){$("#chart_instrument_selector_search").val(""),i.searchComponent&&i.searchComponent.view&&i.searchComponent.view.$el.html("")}),$("#chart_instrument_selector_search").on("keydown",_.debounce(function(){t=$("#chart_instrument_selector_search").val(),e=escape(t),t.length>=i.activationTextLenght&&i.showSearchResults(e)},i.activationDelay))},showSearchResults:function(e){e&&""!==e&&(this.searchComponent.model.instrumentsMarked=this.model.models,this.searchComponent.search(e),BANCOMER.Utils.Helper.resetScrollTo())},isEnterKeyCode:function(e){return 13===e.keyCode},onRender:function(){this.initializeSearcher(),this.initializeNestableComponent(),this.attachDeleteEvent(),this.attachAddEvent(),this.attachChangeEvent()},initializeSearchComponent:function(){var e=this;this.searchComponent=new BANCOMER.Components.Search({config:"chart_instrument_selector_search_result",view:{el:$("#chart_instrument_selector_search_result")},instrumentsMarked:e.model.models,pattern:e.searchPattern}),this.searchComponent.on("rendered",function(){e.searchComponent.view.$el.show(),e.attachDeleteEvent(),e.attachAddEvent(),e.attachChangeEvent()}),this.searchComponent.on("updateChartInstrument",this.updateChartInstrument,this)},updateChartInstrument:function(e){var t=e.mv;this.trigger("updateChart",{param:t,type:"4"},this)},initializeNestableComponent:function(){$("#userInstruments").nestable({maxDepth:1,group:1})},attachDeleteEvent:function(){var e=this;$("#userInstruments .dd-item .delete").off("click"),$("#userInstruments .dd-item .delete").on("click",function(){e.deleteInstrument(this)})},attachChangeEvent:function(){var e=this;$("#userInstruments").on("change",function(){e.refreshIconGraph()})},refreshIconGraph:function(){var e=this;$("#userInstruments .dd-item .icoColGraph").remove(),$("#userInstruments .dd-item.dd3-item").each(function(t){0!==e.numMinimum&&t<e.numMinimum&&$('<div class="icoColGraph"></div>').insertAfter($(this).children(":first"))})},deleteInstrument:function(e){var t=this,i=$("li","#userInstruments").length,n=[],o="";i>this.numMinimum?(n=[{text:BANCOMER.CULTURETEXT.t("noty_Btn_InstrumentSelector_Delete_Accept"),callback:function(){t.deleteItemModel($(e.parentNode).attr("data-id")),t.deleteItem(e)}},{text:BANCOMER.CULTURETEXT.t("noty_Btn_InstrumentSelector_Delete_Cancel")}],o=BANCOMER.CULTURETEXT.t("noty_Txt_InstrumentSelector_Delete")):(n=[{text:BANCOMER.CULTURETEXT.t("noty_Btn_InstrumentSelector_Delete_Accept")}],o=BANCOMER.CULTURETEXT.t("noty_Txt_InstrumentSelector_Delete_NumMinimum")+t.numMinimum),IFB.Utils.Helper.showNotificationWarning("warning",o,!0,n)},attachAddEvent:function(){var e=this;$("#category .dd-item .add").off("click"),$("#category .dd-item .add").on("click",function(t){e.addItem(this),e.addItemModel($(this.parentNode).attr("data-id")),$(this).hide(),t.stopPropagation()})},addItemModel:function(e){var t=this.searchComponent.model.get(e);t&&this.model.models.push(t)},deleteItemModel:function(e){this.model.models=_.filter(this.model.models,function(t){return t.id!==e})},addItem:function(e){var t=this,i=$(e).parent().attr("data-id"),n=$(e).next().html(),o='<li class="dd-item dd3-item" data-id="'+i+'"><div class="delete"></div><div class="dd-handle dd3-handle"><div class="contLines"><div></div><div></div><div></div></div></div><div class="dd3-content">'+n+"</div></li>";$("#userInstruments .dd-list div.delete").length>0?$("#userInstruments .dd-list div.delete").last().parent().after(o):$("#userInstruments .dd-list").append(o),t.attachDeleteEvent(),t.refreshIconGraph()},deleteItem:function(e){var t=$(e).parent().attr("data-id");$("#category .dd-item[data-id='"+t+"'] .add").show(),$(e).parent().remove(),this.refreshIconGraph()},saveUserInstruments:function(){var e=this.serializeInstrument();this.trigger("userInstrumentsSaved",{param:e,type:"4"},this)},serializeInstrument:function(){var e=[];return $("li","#userInstruments").each(function(){e.push($(this).attr("data-id"))}),e.join()},destroy:function(){this.searchComponent&&this.searchComponent.destroy(),BANCOMER.Components.InstrumentSelector.parent.destroy()},reload:function(){this.searchComponent&&this.searchComponent.reload(),BANCOMER.Components.InstrumentSelector.parent.reload()}}),BANCOMER.Components.ChartIntraday=IFB.Class(IFB.Components.ChartIntraday,{initialize:function(e){this._templates=BANCOMER.Defaults.Templates,IFB.Components.ChartIntraday.parent.initialize.call(this,e)}}),BANCOMER.Components.ClickOn=IFB.Class(IFB.Components.ClickOn,{initialize:function(e){this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.ClickOn.parent.initialize.call(this,e)}}),BANCOMER.Components.HeaderSelector=IFB.Class(IFB.Components.HeaderSelector,{initialize:function(e){this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.HeaderSelector.parent.initialize.call(this,e)},serializeHeader:function(){var e=this,t={HDU:{Data:{Header:{ID:this.options.service.columnado,Col:[],numLeftFixedColumns:this.model.userHeader.numLeftFixedColumns}}}};return $("li","#userHeader").each(function(){var i=e.model.get($(this).attr("data-id"));t.HDU.Data.Header.Col=t.HDU.Data.Header.Col||[],i&&t.HDU.Data.Header.Col.push(i.attributes)}),JSON.stringify(t)}}),BANCOMER.Components.HistoricalAlertsList=IFB.Class(IFB.Components.Static,{initialize:function(e){var t=this;this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.Static.parent.initialize.call(this,e),this.on("rendered",function(){BANCOMER.Utils.Helper.createNiceScroll(t,t.config.viewOptions.niceScroll.id),""!==t.config.viewOptions.idAlert&&t.config.viewOptions.model.get(t.config.viewOptions.idAlert)&&t.onAlertClick({id:t.config.viewOptions.idAlert},$("#alertsListTable div[data-id='"+t.config.viewOptions.idAlert+"']"))}),this._addEvents()},create:function(){this.configure();var e=new BANCOMER.Collections.Alerts(this.config);e.data=this.options.data,e.load(),this.config.viewOptions.model=e;var t=new IFB.Views.Base(this.config.viewOptions);this.registerView(t),t.reset()},destroy:function(){$("#"+this.config.viewOptions.niceScroll.id).getNiceScroll().remove(),BANCOMER.Components.HistoricalAlertsList.parent.destroy()},_addEvents:function(){this.on("itemAlertClick",this.onAlertClick,this)},onAlertClick:function(e,t){var i=this.config.viewOptions.model.getElementById(e.id),n=i.getNotificationResponse(),o=this;$("#historicalAlerts_detail_text").html(n),$("#historicalAlerts_detail").show(),i.isRead()||BANCOMER.MANAGEMENTALERTS.setAlertView(e.id,function(){t.removeClass(o.options.view.clsItemNoRead)})}}),BANCOMER.Components.InstrumentDetail=IFB.Class(IFB.Components.InstrumentDetail,{initialize:function(e){this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.InstrumentDetail.parent.initialize.call(this,e)},_doCreate:function(){var e=this;this.model=new(IFB.Collections.InstrumentList.extend({parse:function(){return e._parseDataPreopeningState(IFB.Collections.InstrumentList.prototype.parse.apply(this,arguments))}}))(this.config),this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.InstrumentDetail(this.config.viewOptions),this.registerView(this.view),this.model.load()}}),BANCOMER.Components.InstrumentDetailCharts=IFB.Class(IFB.Components.InstrumentDetail,{currentChart:void 0,TYPE:{DAILY:"daily",INTRADAY:"intraday"},mv:"",filterComponents:[],filterSettings:{CHART_TYPE:{key:"chartType"},PERIOD:{key:"period"},FREQUENCY:{key:"frequency"}},initialize:function(e){var t=this;this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.InstrumentDetailCharts.parent.initialize.call(this,e),this.options.service&&this.options.service.param?this.mv=this.options.service.param:this.mv=this.config.serviceParams.data.param,this.options.charts&&(this.config.charts=this.options.charts),this.on("rendered",this.onRendered,this),this.on("clickTabChart",function(e,i){t.onClickTab(e,i)}),this.on("clickFilter",this.onClickFilter,this),this.on("clickRefreshModule",this.refreshModule),window.addEventListener("orientationchange",function(){t.onOrientationchange()},!1)},onRendered:function(){var e=this.getDefaultChart();this.loadChartComponent(e),this.updateSettingChart(e),BANCOMER.Utils.Helper.setRefreshIcon()},updateSettingChart:function(e){this.setSelectedTab(e),this.setPeriodTxt(e),this.setFrequencyTxt()},setPeriodTxt:function(e){var t="#period"+this.mv.replace(/ /g,"_"),i=this.getCurrentOptionFilterPeriod();e===this.TYPE.INTRADAY?$(t,this.options.view.el).removeClass("selected"):$(t,this.options.view.el).addClass("selected"),$(t,this.options.view.el).text(BANCOMER.CULTURETEXT.t(i.textKey))},setFrequencyTxt:function(){var e="#frequency"+this.mv.replace(/ /g,"_"),t=this.getCurrentOptionFilterFrequency();$(e,this.options.view.el).text(BANCOMER.CULTURETEXT.t(t.textKey))},loadChartComponent:function(e){switch(e){case this.TYPE.DAILY:this.currentChart=this.loadChartDaily();break;case this.TYPE.INTRADAY:this.currentChart=this.loadChartIntraday()}},loadChartIntraday:function(){var e="#chart"+this.mv.replace(/ /g,"_"),t=new BANCOMER.Components.ChartIntraday({config:"chartIntraday",view:{el:e,decimalsYAxis:this.config.viewOptions.decimalsYAxis,lineWidth:this.config.viewOptions.lineWidth,typeChart:this.config.charts[this.TYPE.INTRADAY].type,width:$(e).width(),height:$(e).height()},service:{param:this.mv,compressionMult:this.config.charts[this.TYPE.INTRADAY].frequency||"1"}});return t.type=this.TYPE.INTRADAY,t},loadChartDaily:function(){var e="#chart"+this.mv.replace(/ /g,"_"),t=this.config.charts[this.TYPE.DAILY].frequency,i=this.config.charts[this.TYPE.DAILY].period,n="YYYYMMDD",o=moment().format("YYYYMMDD"),s=moment(o,n).subtract(i.substring(1,2),i.substring(0,1)).format(n),r=new BANCOMER.Components.ChartDaily({config:"chartDaily",view:{el:e,decimalsYAxis:this.config.viewOptions.decimalsYAxis,lineWidth:this.config.viewOptions.lineWidth,typeChart:this.config.charts[this.TYPE.DAILY].type,width:$(e).width(),height:$(e).height()},service:{param:this.mv,dateStart:s,dateEnd:o,frequency:t}});return r.type=this.TYPE.DAILY,r},markDefaultChart:function(e){var t=this;_.each(this.TYPE,function(i){i===e?t.config.charts[i].selected="1":t.config.charts[i].selected="0"})},getDefaultChart:function(){var e=this.TYPE.INTRADAY,t=this;return _.each(this.TYPE,function(i){i&&t.config.charts[i]&&"1"===t.config.charts[i].selected&&(e=i)}),e},onClickTab:function(e,t){var i=e.type;this.currentChart.destroy(),this.currentChart=void 0,this.loadChartComponent(i),this.markDefaultChart(i),this.updateSettingChart(i),this.saveChartPreferences()},setSelectedTab:function(e){var t="";e&&($(".contGraphMenu ul li",this.options.view.el).removeClass("active"),t=".contGraphMenu ul li[data-type="+e+"]",$(t,this.options.view.el).addClass("active"))},onOrientationchange:function(){this.currentChart&&this.currentChart.views&&this.currentChart.views[0]&&this.currentChart.views[0].view.render()},onClickFilter:function(e,t){e&&e.filter&&this.showHideFilter(e.filter)},getCurrentOptionFilterChartType:function(){var e={type:this.config.charts[this.currentChart.type].type};return _.findWhere(BANCOMER.Utils.Filters.options.chartType,e)},getCurrentOptionFilterPeriod:function(){var e={value:this.config.charts[this.currentChart.type].period||BANCOMER.Utils.Filters.options.chartPeriod.P_1D.value};return _.findWhere(BANCOMER.Utils.Filters.options.chartPeriod,e)},getCurrentOptionFilterFrequency:function(){var e={value:this.config.charts[this.currentChart.type].frequency};return _.findWhere(BANCOMER.Utils.Filters.options.chartFrequency,e)},showHideFilter:function(e){var t,i,n,o,s,r,a=this.currentChart.type||this.TYPE.INTRADAY;if(e)switch(e){case this.filterSettings.CHART_TYPE.key:t=this.getCurrentOptionFilterChartType(),i=this.config.viewOptions.filters.chartType.config||"",n=this.config.viewOptions.filters.chartType.suffixCls||"",o=this.config.viewOptions.filters.chartType.el||"",s=this.getFilterComponent(o),r=BANCOMER.Utils.Filters.options.chartType,this.showHideFilterComponent(o,n,i,s,t?t.key:{},r,this.onClickOptionModuleFilterChartType);break;case this.filterSettings.PERIOD.key:a===this.TYPE.DAILY&&(t=this.getCurrentOptionFilterPeriod(),i=this.config.viewOptions.filters.period.config||"",n=this.config.viewOptions.filters.period.suffixCls||"",o=this.config.viewOptions.filters.period.el||"",s=this.getFilterComponent(o),r=this.getPeriodOptions(this.config.charts[this.currentChart.type].frequency),this.showHideFilterComponent(o,n,i,s,t?t.key:{},r,this.onClickOptionModuleFilterPeriod));break;case this.filterSettings.FREQUENCY.key:t=this.getCurrentOptionFilterFrequency(),i=this.config.viewOptions.filters.frequency.config||"",n=this.config.viewOptions.filters.frequency.suffixCls||"",o=this.config.viewOptions.filters.frequency.el||"",s=this.getFilterComponent(o),r=this.getFrequencyOptions(this.config.charts[this.currentChart.type].period),this.showHideFilterComponent(o,n,i,s,t?t.key:{},r,this.onClickOptionModuleFilterFrequency)}},showHideFilterComponent:function(e,t,i,n,o,s,r){$(e).is(":visible")?this.hideFilter(e):(n?n.update(o,s,!0):(n=this.loadComponentModuleFilter(i,e,t,o,s),this.filterComponents.push(n),n.on("clickOptionFilter",r,this)),this.showFilter(e))},onClickOptionModuleFilterChartType:function(e,t){var i=$(t).val().trim();this.currentChart.changeChartType(i),this.config.charts[this.currentChart.type].type=i,this.saveChartPreferences()},onClickOptionModuleFilterPeriod:function(e,t){var i=$(t).val().trim();this.currentChart.changePeriodChart(i),this.config.charts[this.currentChart.type].period=i,this.setPeriodTxt(this.currentChart.type),this.saveChartPreferences()},onClickOptionModuleFilterFrequency:function(e,t){var i=$(t).val().trim();this.currentChart.changeFrequencyChart(i),this.config.charts[this.currentChart.type].frequency=i,this.setFrequencyTxt(),this.saveChartPreferences();
},getPeriodOptions:function(e){var t=_.filter(BANCOMER.Utils.Filters.options.chartPeriod,function(t){return-1!==t.frequencyAvailability.indexOf(e)});return t},getFrequencyOptions:function(e){var t=_.filter(BANCOMER.Utils.Filters.options.chartFrequency,function(t){return-1!==t.periodAvailability.indexOf(e)});return t},saveChartPreferences:function(){"1"===this.config.saveOnServer&&(BANCOMER.Utils.Preferences.addPreferencesModule(this.options.config,"charts",this.config.charts),BANCOMER.Utils.Preferences.save(),BANCOMER.Defaults.Templates=$.extend(!0,BANCOMER.Defaults.Templates,BANCOMER.Utils.Preferences.preferences.modules))},loadComponentModuleFilter:function(e,t,i,n,o){var s=new BANCOMER.Components.ModuleFilter({config:e,view:{el:t,options:o,checkedOption:n,componentId:e,suffixCls:i}});return s},hideFilter:function(e){$("#clickableLevel").hide(),$(e).hide()},showFilter:function(e){$("#clickableLevel").show(),$(e).show()},destroy:function(){for(this.currentChart&&this.currentChart.destroy();this.filterComponents.length;)this.filterComponents.shift().destroy();BANCOMER.Components.Base.parent.destroy.call(this)},getFilterComponent:function(e){return _.find(this.filterComponents,function(t){return t&&t.config.viewOptions.el===e})},register:function(){this.currentChart&&this.currentChart.register(),BANCOMER.Components.InstrumentDetailCharts.parent.register.call(this)},refreshModule:function(){this.currentChart&&this.currentChart.reload()}}),BANCOMER.Components.InstrumentList=IFB.Class(IFB.Components.InstrumentListHeader,{initialize:function(e){var t=this;this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.InstrumentList.parent.initialize.call(this,e),this.on("rendered",function(){t.config.viewOptions.dataTable&&t.createDataTable()}),this.on("AbrirFicha",function(e){var i=t.model.get(e.mv);document.location.href="#!/lightbox/instrumentDetail/"+i.id}),this.on("AbrirBoletaCompra",function(e){var i=t.model.get(e.mv),n=i.getEmisora()+" "+i.getSerie();document.location.href="#!/lightbox/boleta/"+i.id+"/"+n+"/Compra"}),this.on("AbrirBoletaVenta",function(e){var i=t.model.get(e.mv),n=i.getEmisora()+" "+i.getSerie();document.location.href="#!/lightbox/boleta/"+i.id+"/"+n+"/Venta"}),this.on("componentSelectorHeaderRendered",function(){$(t.componentSelectorHeader.config.viewOptions.el).show()}),this.on("componentSelectorHeaderClose",function(){$(t.componentSelectorHeader.config.viewOptions.el).hide()}),this.on("componentSelectorHeaderSave",function(){$(t.componentSelectorHeader.config.viewOptions.el).hide()})},_doCreate:function(){this.model=new IFB.Collections.InstrumentList(this.config),this.model.userHeader=this.userHeader;var e=_.extend({model:this.model,component:this},this.config.viewOptions);this.view=new IFB.Views.InstrumentList(e),this.registerView(this.view),this.on("sortView",this.view.sortView,this.view),this.model.load()},createDataTable:function(){var e;this.config.viewOptions.dataTable.fixedColumns||(e=this.getFixedColumnsConfigFromHeader(),""!==e&&(this.config.viewOptions.dataTable.fixedColumns=e)),BANCOMER.Utils.Helper.createDataTable(this.config)},getFixedColumnsConfigFromHeader:function(){var e,t,i=this.userHeader,n=-1,o={};return i?(e=_.reduce(i.models,function(e,t){return t.isFixed()?e+1:e},0),0===e?"":(t=_.find(i.models,function(e){return n++,!e.isFixed()}),n>0&&(o.leftColumns=n),e-n>0&&(o.rightColumns=e-n),o)):""},getComponentHeaderSelector:function(){var e=this,t=this.config.configHeaderSelector&&this.config.configHeaderSelector.file?this.config.configHeaderSelector.file:this.options.configHeaderSelector&&this.options.configHeaderSelector.file?this.options.configHeaderSelector.file:this.options.config,i=new BANCOMER.Components.HeaderSelector({config:this.config.configHeaderSelector.config,service:{columnado:this.config.serviceParams.header.columnado},file:t,userHeader:e.userHeader,title:this.config.configHeaderSelector.title||""});return i},openSelectorHeader:function(){var e=this,t=this.getComponentHeaderSelector();t.on("closeClick",function(){e.trigger("componentSelectorHeaderClose")}),t.on("userHeaderSaved",function(){e.trigger("componentSelectorHeaderSave"),e.onSaveUserHeader()}),t.on("rendered",function(){e.trigger("componentSelectorHeaderRendered")}),this.componentSelectorHeader=t}}),BANCOMER.Components.InstrumentSelector=IFB.Class(BANCOMER.Components.Base,{view:void 0,model:void 0,searchComponent:void 0,activationDelay:1e3,activationTextLenght:3,numMinimum:0,searchPattern:"",placeHolderText:"",initialize:function(e){this._templates=IFB.Defaults.Templates,BANCOMER.Components.InstrumentSelector.parent.initialize.call(this,e)},create:function(){this.configure(),this.model=new Backbone.Model(this.config),this.model.title=this.options.title,this.numMinimum=this.options.numMinimum||this.config.numMinimum||0,this.searchPattern=this.options.pattern||this.config.pattern||"",this.model.models=this.options.models||[],this.model.numMinimum=this.numMinimum,this.model.searchTextKey=this.options.searchTextKey||this.config.searchTextKey||"",this.model.itemsSelectedTextKey=this.options.itemsSelectedTextKey||this.config.itemsSelectedTextKey||"",this.model.placeHolderText=this.options.placeHolderText||this.config.placeHolderText||"",this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.Static(this.config.viewOptions),this.registerView(this.view),this._addEvents(),this.view.reset()},_addEvents:function(){this.on("rendered",this.onRender,this),this.on("saveUserInstruments",this.saveUserInstruments,this)},initializeSearcher:function(){var e,t,i=this;this.initializeSearchComponent(),$("#instrument_selector_search").on("click",function(){$("#instrument_selector_search").val(""),i.searchComponent&&i.searchComponent.view&&i.searchComponent.view.$el.html("")}),$("#instrument_selector_search").on("keydown",_.debounce(function(){t=$("#instrument_selector_search").val(),e=escape(t),t.length>=i.activationTextLenght&&i.showSearchResults(e)},i.activationDelay))},showSearchResults:function(e){e&&""!==e&&(this.searchComponent.model.instrumentsMarked=this.model.models,this.searchComponent.search(e),BANCOMER.Utils.Helper.resetScrollTo())},isEnterKeyCode:function(e){return 13===e.keyCode},onRender:function(){this.initializeSearcher(),this.initializeNestableComponent(),this.attachDeleteEvent(),this.attachAddEvent(),this.attachChangeEvent()},initializeSearchComponent:function(){var e=this;this.searchComponent=new BANCOMER.Components.Search({config:"instrument_selector_search_result",view:{el:$("#instrument_selector_search_result")},instrumentsMarked:e.model.models,pattern:e.searchPattern}),this.searchComponent.on("rendered",function(){e.searchComponent.view.$el.show(),e.attachDeleteEvent(),e.attachAddEvent(),e.attachChangeEvent()})},initializeNestableComponent:function(){$("#userInstruments").nestable({maxDepth:1,group:1})},attachDeleteEvent:function(){var e=this;$("#userInstruments .dd-item .delete").off("click"),$("#userInstruments .dd-item .delete").on("click",function(){e.deleteInstrument(this)})},attachChangeEvent:function(){var e=this;$("#userInstruments").on("change",function(){e.refreshIconGraph()})},refreshIconGraph:function(){var e=this;$("#userInstruments .dd-item .icoColGraph").remove(),$("#userInstruments .dd-item.dd3-item").each(function(t){0!==e.numMinimum&&t<e.numMinimum&&$('<div class="icoColGraph"></div>').insertAfter($(this).children(":first"))})},deleteInstrument:function(e){var t=this,i=$("li","#userInstruments").length,n=[],o="";i>this.numMinimum?(n=[{text:BANCOMER.CULTURETEXT.t("noty_Btn_InstrumentSelector_Delete_Accept"),callback:function(){t.deleteItemModel($(e.parentNode).attr("data-id")),t.deleteItem(e)}},{text:BANCOMER.CULTURETEXT.t("noty_Btn_InstrumentSelector_Delete_Cancel")}],o=BANCOMER.CULTURETEXT.t("noty_Txt_InstrumentSelector_Delete")):(n=[{text:BANCOMER.CULTURETEXT.t("noty_Btn_InstrumentSelector_Delete_Accept")}],o=BANCOMER.CULTURETEXT.t("noty_Txt_InstrumentSelector_Delete_NumMinimum")+t.numMinimum),IFB.Utils.Helper.showNotificationWarning("warning",o,!0,n)},attachAddEvent:function(){var e=this;$("#category .dd-item .add").off("click"),$("#category .dd-item .add").on("click",function(t){e.addItem(this),e.addItemModel($(this.parentNode).attr("data-id")),$(this).hide(),t.stopPropagation()})},addItemModel:function(e){var t=this.searchComponent.model.get(e);t&&this.model.models.push(t)},deleteItemModel:function(e){this.model.models=_.filter(this.model.models,function(t){return t.id!==e})},addItem:function(e){var t=this,i=$(e).parent().attr("data-id"),n=$(e).next().html(),o='<li class="dd-item dd3-item" data-id="'+i+'"><div class="delete"></div><div class="dd-handle dd3-handle"><div class="contLines"><div></div><div></div><div></div></div></div><div class="dd3-content">'+n+"</div></li>";$("#userInstruments .dd-list div.delete").length>0?$("#userInstruments .dd-list div.delete").last().parent().after(o):$("#userInstruments .dd-list").append(o),t.attachDeleteEvent(),t.refreshIconGraph()},deleteItem:function(e){var t=$(e).parent().attr("data-id");$("#category .dd-item[data-id='"+t+"'] .add").show(),$(e).parent().remove(),this.refreshIconGraph()},saveUserInstruments:function(){var e=this.serializeInstrument();this.trigger("userInstrumentsSaved",{param:e,type:"4"},this)},serializeInstrument:function(){var e=[];return $("li","#userInstruments").each(function(){e.push($(this).attr("data-id"))}),e.join()},destroy:function(){this.searchComponent&&this.searchComponent.destroy(),BANCOMER.Components.InstrumentSelector.parent.destroy()},reload:function(){this.searchComponent&&this.searchComponent.reload(),BANCOMER.Components.InstrumentSelector.parent.reload()}}),BANCOMER.Components.InvestmentDetailChart=IFB.Class(IFB.Components.InstrumentListHeader,{initialize:function(e){var t=this;this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.InvestmentDetailChart.parent.initialize.call(this,e),this.on("rendered",function(){BANCOMER.Utils.Helper.createNiceScroll(t,t.config.viewOptions.niceScroll.id)}),this.on("AbrirFicha",function(e){document.location.href="#!/lightbox/instrumentDetail/"+e.mv})},create:function(){var e=this;this.configure(),e.loadDataFromHeader(function(){e._doCreate()})},_doCreate:function(){this.config.userHeader=this.userHeader,this.model=new BANCOMER.Collections.PositionBook(this.config),this.model.userHeader=this.userHeader,this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.InvestmentDetail(this.config.viewOptions),this.registerView(this.view),this.model.load()},destroy:function(){$("#"+this.config.viewOptions.niceScroll.id).getNiceScroll().remove(),BANCOMER.Components.InvestmentDetailChart.parent.destroy()},reload:function(e){e?(this.view.sortConfig=e,this.view.sortModel(),this.model.sortConfig=e,this.view.render()):(this.model.sortConfig="",BANCOMER.Components.InvestmentDetailChart.parent.reload.call(this))}}),BANCOMER.Components.InvestmentDetailTable=IFB.Class(IFB.Components.InstrumentListHeader,{waitForReloadMillis:500,initialize:function(e){var t=this;this.refresh=this.waitForReloadMillis>0?_.debounce(this._refresh,this.waitForReloadMillis):this._refresh,this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.InvestmentDetailTable.parent.initialize.call(this,e),this.on("rendered",function(){BANCOMER.Utils.Helper.createDataTable(this.config),BANCOMER.Utils.Helper.setRefreshIcon()}),this.on("AbrirFicha",function(e){document.location.href="#!/lightbox/instrumentDetail/"+e.mv}),this.on("AbrirBoletaCompra",function(e){var i=t.model.get(e.mv),n=i.getEmisora()+" "+i.getSerie();document.location.href="#!/lightbox/boleta/"+i.id+"/"+n+"/Compra"}),this.on("AbrirBoletaVenta",function(e){var i=t.model.get(e.mv),n=i.getEmisora()+" "+i.getSerie();document.location.href="#!/lightbox/boleta/"+i.id+"/"+n+"/Venta"}),this.on("refreshData",this.refresh,this),this.on("componentSelectorHeaderRendered",function(){$(t.componentSelectorHeader.config.viewOptions.el).show()}),this.on("componentSelectorHeaderClose",function(){$(t.componentSelectorHeader.config.viewOptions.el).hide()}),this.on("componentSelectorHeaderSave",function(){$(t.componentSelectorHeader.config.viewOptions.el).hide()})},create:function(){var e=this;this.configure(),e.loadDataFromHeader(function(){e._doCreate()})},_doCreate:function(){var e=this;this.config.serviceBCOMParams.params.data1=this.options.serviceBCOMParams?this.options.serviceBCOMParams.params.data1:this.config.serviceBCOMParams.params.data1,this.config.userHeader=this.userHeader,this.model=new BANCOMER.Collections.PositionBook(this.config),this.model.userHeader=this.userHeader,this.model.module=this.config.viewOptions.module,this.model.workspace=this.config.viewOptions.workspace,this.model.layout=this.config.viewOptions.layout,this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.InvestmentDetail(this.config.viewOptions),this.registerView(this.view),this.options.data&&(this.model.models=[],this.model.add(this.options.data.models),this.model.load=function(){e.view.reset()}),this.addEvents(),this.model.load()},addEvents:function(){this.on("positionBookPeriodFilterChange",this.onPositionBookPeriodFilterChange,this)},onPositionBookPeriodFilterChange:function(e,t){this.config.serviceBCOMParams.params.data1=t.val(),this.reload()},reload:function(e){this.view.sortConfig.descriptor="",this.model.sortview=!1,BANCOMER.Components.InvestmentDetailTable.parent.reload.call(this)},getComponentHeaderSelector:function(){var e=this,t=this.config.configHeaderSelector&&this.config.configHeaderSelector.file?this.config.configHeaderSelector.file:this.options.configHeaderSelector&&this.options.configHeaderSelector.file?this.options.configHeaderSelector.file:this.options.config,i=new BANCOMER.Components.HeaderSelector({config:this.config.configHeaderSelector.config,service:{columnado:this.config.serviceParams.header.columnado},file:t,userHeader:e.userHeader,title:this.config.configHeaderSelector.title||""});return i},_refresh:function(){this.reload()}}),BANCOMER.Components.MenuFooter=IFB.Class(BANCOMER.Components.Base,{view:void 0,model:void 0,create:function(){this.configure(),this._create()},_create:function(){var e=this;this.model=new Backbone.Model(this.config),this.model.options=this.config,this.model.items=this.config.viewOptions.items,this.model.maxItems=this.config.viewOptions.maxItems,this.model.load=function(){e.view.reset()},this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.Static(this.config.viewOptions),this.registerView(this.view),this.view.reset()}}),BANCOMER.Components.MenuSettings=IFB.Class(BANCOMER.Components.Base,{view:void 0,model:void 0,create:function(){this.configure(),this.model=new Backbone.Model(this.config),this.model.streamingStatus=this.config.viewOptions.streamingStatus,this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.Static(this.config.viewOptions),this.registerView(this.view),this.view.reset()},addEvents:function(){this.on("change",this.sendChangeStreaming,this)},sendChangeStreaming:function(){this.trigger("sendChangeStreaming")}}),BANCOMER.Components.ModuleFilter=IFB.Class(BANCOMER.Components.Base,{view:void 0,model:void 0,create:function(){this.configure(),this.model=new Backbone.Model(this.config),this.model.options=this.config.viewOptions.options,this.model.checkedOption=this.config.viewOptions.checkedOption,this.model.componentId=this.config.viewOptions.componentId,this.model.suffixCls=this.config.viewOptions.suffixCls||"",this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.Static(this.config.viewOptions),this.registerView(this.view),this.view.reset()},update:function(e,t,i){e&&(this.model.checkedOption=e),t&&(this.model.options=t),i&&this.view&&this.view.render()}}),BANCOMER.Components.MultipleTopFlopActive=IFB.Class(BANCOMER.Components.Base,{components:[],create:function(){var e=this;this.components=[],this.configure("TopFlopActive","/wtdb/LoadDataMasSubenBajanContratan"),e._doCreate()},_doCreate:function(){var e=this;_.each(this.config.components,function(t){e.components.push(e.loadComponent(t.config,e.config.serviceParams.data.param,$(BANCOMER.Defaults.Templates[t.config].viewOptions.el)))})},loadComponent:function(e,t,i){var n=new BANCOMER.Components.TopFlopActive({config:e,view:{el:$(i)},service:{param:t}});return n},destroy:function(){_.each(this.components,function(e){_.isFunction(e.destroy)&&e.destroy()})},reload:function(){var e=this;_.each(this.components,function(t){_.isFunction(t.reload)&&(t.config.serviceParams.data.param=e.config.serviceParams.data.param,t.reload())})},register:function(){_.each(this.components,function(e){e&&e.register()})}}),BANCOMER.Components.News=IFB.Class(IFB.Components.News,{DATE_FORMAT:"YYYYMMDD",initialize:function(e){this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.News.parent.initialize.call(this,e),this.on("rendered",function(){BANCOMER.Utils.Helper.createDataTable(this.config)}),this.on("loaded",function(){this.onloaded()}),IFB.Events.on("newsMarkedAsRead",this.onNewsMarkedAsRead,this)},onloaded:function(){throw new Error("This method must be overriden")},onUpdateNews:function(e){throw new Error("This method must be overriden")},onNewsMarkedAsRead:function(e,t){throw new Error("This method must be overriden")},filterCurrentNews:function(e){var t,i=this.getCurrentDate(),n=_.filter(e,function(e){return t=e.getClassification(),t&&t.Vencimiento?Number(t.Vencimiento)>=Number(i):!0});return n},filterReadNews:function(e){var t=_.filter(e,function(e){return!IFB.Utils.ReadStatusConfig.isRead(e.getSource(),e.getKey())});return t},getNewsModel:function(e){return new IFB.Models.News(JSON.parse(JSON.stringify(e).replace(/@/g,"")))},getCurrentDate:function(){return moment().format(this.DATE_FORMAT)}}),BANCOMER.Components.NewsButton=IFB.Class(BANCOMER.Components.News,{DATE_FORMAT:"YYYYMMDD",initialize:function(e){this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.NewsButton.parent.initialize.call(this,e)},onloaded:function(){var e=this.filterCurrentNews(this.model.models);this.model.models=this.filterReadNews(e)},onUpdateNews:function(e){var t=this;e=_.isArray(e)?e:[e],_.each(e,function(e){t.model.unshift(t.getNewsModel(e)),t.notifyIncomingMessage(t.getNewsModel(e))}),t.onRendered()},onRendered:function(){this.reload()},onNewsMarkedAsRead:function(e,t){var i;e&&-1!==e.source.indexOf(this.config.serviceParams.data.fuentes)&&(i=this.model.get(e.key),i&&(this.model.remove([i]),this.reload()))},getCurrentDate:function(){return moment().format(this.DATE_FORMAT)},notifyIncomingMessage:function(e){var t=this,i=[{text:BANCOMER.CULTURETEXT.t("noty_Btn_IncomingNews_Open"),callback:function(){IFB.Utils.ReadStatusConfig.markAsRead(e.getSource(),e.getKey(),t.getCurrentDate()),"1"===t.config.viewOptions.format?document.location.href="#!/lightbox/newsList/pageTitle_MessagePage/"+e.getSource()+"/"+e.getKey():document.location.href="#!/lightbox/newsList/pageTitle_NoticePage/"+e.getSource()+"/"+e.getKey()}},{text:BANCOMER.CULTURETEXT.t("noty_Btn_IncomingNews_Close")}];"1"===this.config.viewOptions.format?BANCOMER.Utils.Helper.showNotificationIncomingMessage("warning",e.getTitle(),!0,i):IFB.Utils.Helper.showNotificationWarning("warning",e.getTitle(),!0,i)}}),BANCOMER.Components.NewsCriteria=IFB.Class(IFB.Components.NewsCriteria,{urlFileNode:"",initialize:function(e){this.urlFileNode=e.urlFileNode||"FicheroIB",this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.NewsCriteria.parent.initialize.call(this,e),this.on("rendered",function(){BANCOMER.Utils.Helper.createDataTable(this.config)}),this.on("clickNews",this.onClickNews,this)},_configureParam:function(e){var t=e.serviceParams;return"0;"+t.searchFunc+";"+t.data.sources+","+(t.data.fromDate||"")+",,"+(t.data.toDate||"")+",,,"+(t.data.isin||"")+","+(t.numberOfItems||"")+",,,"+(t.data.detailFormat||"")},getURLFile:function(e){var t="";if(e&&(window.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(e,"text/xml")):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async=!1,xmlDoc.loadXML(e)),xmlDoc&&"parsererror"!==xmlDoc.documentElement.nodeName))try{x=xmlDoc.getElementsByTagName(this.urlFileNode)[0],y=x.childNodes[0],t=y.nodeValue}catch(i){}return t},onClickNews:function(e,t){var i,n,o="",s="";e&&e.key&&(i=this.model.get(e.key),i&&(n=new IFB.Services.Database({}),n.news(_.extend({idNot:i.getKey(),source:i.getSource()},{sesion:IFB.Services.Session}),function(e){s=JSON.parse(e),s&&s.answer&&s.answer.Noticia&&s.answer.Noticia.FicheroIB?(o=_.isObject(s.answer.Noticia.FicheroIB)?s.answer.Noticia.FicheroIB.value:s.answer.Noticia.FicheroIB,BANCOMER.Utils.Helper.openExternalFile(o)):document.location.href="#!/lightbox/newsDetail/"+i.getSource()+"/"+i.getKey()})))}}),BANCOMER.Components.NewsDetail=IFB.Class(IFB.Components.NewsDetail,{initialize:function(e){var t=this;this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.NewsDetail.parent.initialize.call(this,e),this.on("rendered",function(){BANCOMER.Utils.Helper.createNiceScroll(t,t.config.viewOptions.niceScroll.id)}),this.on("openExternalFile",function(e){BANCOMER.Utils.Helper.openExternalFile(e.url)})},destroy:function(){var e=$("#"+this.config.viewOptions.niceScroll.id).getNiceScroll();e&&e.remove(),BANCOMER.Components.NewsDetail.parent.destroy()}}),BANCOMER.Components.NewsList=IFB.Class(BANCOMER.Components.News,{numItems:0,initialize:function(e){var t=this;this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.NewsList.parent.initialize.call(this,e),this.on("rendered",function(){BANCOMER.Utils.Helper.createNiceScroll(t,t.config.viewOptions.niceScroll.id)}),this._addEvents()},destroy:function(){$("#"+this.config.viewOptions.niceScroll.id).getNiceScroll().remove(),BANCOMER.Components.NewsList.parent.destroy()},_addEvents:function(){this.on("itemNewsClick",this.onNewsClick,this)},onNewsClick:function(e,t){t.removeClass(this.options.view.clsItemNoRead),this.trigger("showNewsDetail",e)},onloaded:function(){this.model.models=this.filterCurrentNews(this.model.models),this.numItems=this.model.models.length},onUpdateNews:function(e){var t,i=this,n=0,o="";e=_.isArray(e)?e:[e],n=e.length,_.each(e,function(e,n){o=n%2===0?i.options.view.clsItemEven:"",t=i.getNewsModel(e),t&&(i.model.unshift(t),i.insertItemView(t,o))}),i.updateViewOldItems(n),i.updateCounterNumItems(n)},onRendered:function(e){this.reload()},insertItemView:function(e,t){var i=this.options.view.el,n="#"+(this.options.view.niceScroll?this.options.view.niceScroll.id:"newsListTable"),o='<div id="'+e.getKey()+'" class="mesAviTbl_data ifbEventTrigger '+t+" "+this.options.view.clsItemNoRead+'" data-event="itemNewsClick" data-source="'+e.getSource()+'" data-key="'+e.getKey()+'">';o+='<div class="mesAviTbl_date">'+e.getDate()+"</div>",o+='<div class="mesAviTbl_hour">'+e.getTime()+"</div>",o+='<div class="mesAviTbl_tit">'+e.getTitle()+"</div>",o+="</div>",$(n,i).prepend(o)},updateViewOldItems:function(e){var t,i=this,n=this.options.view.el;_.each(this.model.models,function(o,s){s>=e&&(t=s%2===0?i.options.view.clsItemEven:"",$("#"+o.getKey(),n).removeClass(i.options.view.clsItemEven),""!==t&&$("#"+o.getKey(),n).addClass(t))})},updateCounterNumItems:function(e){var t=$("#"+this.options.view.counterId);this.numItems+=e;var i=1===this.numItems?BANCOMER.CULTURETEXT.t("componentLabel_newsList_countMessage"):BANCOMER.CULTURETEXT.t("componentLabel_newsList_countMessages");t&&$(t).html(this.numItems+"&nbsp;"+i)},onNewsMarkedAsRead:function(e,t){}}),BANCOMER.Components.NewsTreeMap=IFB.Class(BANCOMER.Components.NewsCriteria,{defaultNumberOfItems:7,defaultMaxTitleLength:30,initialize:function(e){this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.NewsTreeMap.parent.initialize.call(this,e),this.on("rendered",this.onRendered,this),this.numberOfItems=this.getNumberOfItems(),this.maxTitleLength=this.config.maxTitleLength||this.defaultMaxTitleLength},onRendered:function(){var e=0,t="",i=this.options.view.itemIdPrefix,n=this.options.view.el,o=this;i&&_.each(this.model.models,function(s,r){e=r+1,t="#"+i+e,o.setDetailLink(s,t,n)})},setDetailLink:function(e,t,i){e&&$(t,i)&&($(t,i).text(this.getTextTitle(e.getTitle())),$(t,i).attr("class","ifbEventTrigger"),$(t,i).data("event","clickNews"),$(t,i).data("key",e.getKey()))},onUpdateNews:function(e){var t=this;e=_.isArray(e)?e:[e],_.each(e,function(e){t.model.unshift(t.getNewsModel(e)),t.model.length>t.numberOfItems&&t.model.pop()}),t.onRendered()},getNumberOfItems:function(){return this.config&&this.config.serviceParams&&this.config.serviceParams.numberOfItems?this.config.serviceParams.numberOfItems:this.defaultNumberOfItems},getNewsModel:function(e){return new IFB.Models.News(JSON.parse(JSON.stringify(e).replace(/@/g,"")))},getTextTitle:function(e){return e.length>this.maxTitleLength?this.getTrimmedTitle(e)+" ...":e},getTrimmedTitle:function(e){var t=e.substr(0,this.maxTitleLength);return t.substr(0,Math.min(t.length,t.lastIndexOf(" ")))}}),BANCOMER.Components.NewsViewTreeMap=IFB.Class(BANCOMER.Components.NewsTreeMap,{initialize:function(e){BANCOMER.Components.NewsViewTreeMap.parent.initialize.call(this,e)},onRendered:function(){var e=0,t="",i=this.config.viewOptions.itemIdPrefix,n=this.config.viewOptions.el,o=this;i&&_.each(this.model.models,function(s,r){e=r+1,t="#"+i+e,o.setDetailLink(s,t,n),o.setBackgroundItem(s,t,n)})},setBackgroundItem:function(e,t,i){-1!==this.config.viewOptions.greenClsSources.indexOf(e.getSource())?$(t,i).parent().parent().addClass("colorGreen"):-1!==this.config.viewOptions.blueClsSources.indexOf(e.getSource())&&$(t,i).parent().parent().addClass("colorBlue")}}),BANCOMER.Components.OrderBookTable=IFB.Class(IFB.Components.InstrumentListHeader,{waitForReloadMillis:500,initialize:function(e){var t=this;this.refresh=this.waitForReloadMillis>0?_.debounce(this._refresh,this.waitForReloadMillis):this._refresh,this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.OrderBookTable.parent.initialize.call(this,e),this.on("rendered",function(){BANCOMER.Utils.Helper.createDataTable(this.config),t.deleteLinkOnExecutedCancelOrders(),BANCOMER.Utils.Helper.setRefreshIcon()}),this.on("AbrirFicha",function(e){var t=this.model.getElementById(e.mv);t&&(document.location.href="#!/lightbox/instrumentDetail/"+t.getDescriptorValue("MV"))}),this.on("refreshData",this.refresh,this),this.on("componentSelectorHeaderRendered",function(){$(t.componentSelectorHeader.config.viewOptions.el).show()}),this.on("componentSelectorHeaderClose",function(){$(t.componentSelectorHeader.config.viewOptions.el).hide()}),this.on("componentSelectorHeaderSave",function(){$(t.componentSelectorHeader.config.viewOptions.el).hide()}),this.on("orderCancel",function(e){document.location.href="#!/lightbox/ordercancel/"+e.mv}),this.on("orderDetail",function(e){var t=this.model.getElementById(e.mv);t&&(document.location.href="#!/lightbox/orderdetail/"+t.getEmpresa()+"/"+t.getFolio()+"/"+t.getFechaReg()+"/"+t.getOperacion()+"/"+t.getEmisora()+"/"+t.getSerie())})},create:function(){var e=this;this.configure(),e.loadDataFromHeader(function(){e._doCreate()})},_doCreate:function(){this.config.userHeader=this.userHeader,this.model=new BANCOMER.Collections.OrderBook(this.config),this.model.userHeader=this.userHeader,this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.OrderBook(this.config.viewOptions),this.registerView(this.view),this.on("sortView",this.view.sortView,this.view),this.addEvents(),this.model.load()},addEvents:function(){this.on("orderBookStatusFilterChange",this.onOrderBookStatusFilterChange,this)},onOrderBookStatusFilterChange:function(e,t){this.model.paramFilter=t.val(),this.view.render()},getComponentHeaderSelector:function(){var e=this,t=this.config.configHeaderSelector&&this.config.configHeaderSelector.file?this.config.configHeaderSelector.file:this.options.configHeaderSelector&&this.options.configHeaderSelector.file?this.options.configHeaderSelector.file:this.options.config,i=new BANCOMER.Components.HeaderSelector({config:this.config.configHeaderSelector.config,service:{columnado:this.config.serviceParams.header.columnado},file:t,userHeader:e.userHeader,title:this.config.configHeaderSelector.title||""});return i},deleteLinkOnExecutedCancelOrders:function(){var e=this,t=_.filter(this.model.models,function(e){return e.getEstadoRaw()===BANCOMER.Models.Order.prototype.Status.Executed.key||e.getEstadoRaw()===BANCOMER.Models.Order.prototype.Status.Canceled.key});_.each(t,function(t){$('td.cancel[data-mv="'+t.getFolio()+'"]',e.config.viewOptions.el).removeClass("cancel")})},_refresh:function(){this.reload()}}),BANCOMER.Components.OrderCancelConfirmation=IFB.Class(BANCOMER.Components.Base,{folio:"",order:void 0,initialize:function(e){this._templates=BANCOMER.Defaults.Templates,this.folio=e.view.folio,BANCOMER.Components.OrderCancelConfirmation.parent.initialize.call(this,e)},create:function(){var e=this;this.configure(),this.model=new BANCOMER.Collections.OrderBook(this.config),e.config.viewOptions.model=e.model,this.view=new BANCOMER.Views.OrderBook(e.config.viewOptions),e.registerView(this.view),this.addEvents(),this.model.load()},addEvents:function(){this.on("sendOrderCancelConfirmationClick",this.sendOrderCancelConfirmation,this),this.on("sendOrderCancelSaveClick",this.sendOrderCancelSave,this),this.on("sendOrderCancelMailClick",this.sendOrderCancelMail,this),this.on("sendOrderCancelReceiptTooltipClick",this.showHideReceiptToolTip,this)},sendOrderCancelConfirmation:function(e,t){var i,n=e.folio.toString(),o=this;n===this.folio&&(this.order=this.model.get(n),this.order&&(i=this.order.getCancelConfirmationToTrader(),BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(BANCOMER.Services.BCOM.OperationCode.CancelacionOrdenCapitales,i,function(e){void 0!==e.answer&&void 0!==e.status&&e.status.ok&&i.id_testigo===e.answer.id_testigo&&(o.hideCancelConfirmation(),o.order.setFolioCancelacion(e.answer.folioInternet),o.showCancelConfirmation())})))},sendOrderCancelSave:function(){var e=this.order.getCancelSaveMailToTrader();BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(BANCOMER.Services.BCOM.OperationCode.GuardadoComprobante,e,function(t){void 0!==t.answer&&void 0!==t.status&&t.status.ok&&e.id_testigo===t.answer.id_testigo&&console.log("GuardadoComprobante - OK")})},sendOrderCancelMail:function(){var e=this.order.getCancelSaveMailToTrader();BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(BANCOMER.Services.BCOM.OperationCode.EnvioComprobante,e,function(t){void 0!==t.answer&&void 0!==t.status&&t.status.ok&&e.id_testigo===t.answer.id_testigo&&console.log("EnvioComprobante - OK")})},hideCancelConfirmation:function(){$("#orderCancelConfirmationButton",this.config.viewOptions.el).hide(),$("#orderCancelConfirmationInfo",this.config.viewOptions.el).hide()},showCancelConfirmation:function(){$("#orderCancelReceiptTooltipContainer",this.config.viewOptions.el).show(),$("#orderCancelReceipt",this.config.viewOptions.el).show(),$("#orderCancelReceiptFolioContainer",this.config.viewOptions.el).show(),$("#orderCancelRegisterDate").removeClass("noBorderBttm"),$("#orderCancelReceiptFolio",this.config.viewOptions.el).text(this.order.getFolioCancelacion())},showHideReceiptToolTip:function(){$("#orderReceiptTooltip",this.$el).toggle()}}),BANCOMER.Components.OrderDetail=IFB.Class(BANCOMER.Components.Base,{initialize:function(e){this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.OrderDetail.parent.initialize.call(this,e),this.on("rendered",function(){BANCOMER.Utils.Helper.createDataTable(this.config)})},create:function(){var e=this;this.configure(),_.extend(this.config.serviceBCOMParams,this.options.serviceBCOMParams),this.model=new BANCOMER.Collections.OrderDetail(this.config),e.config.viewOptions.model=e.model,this.view=new BANCOMER.Views.OrderDetail(e.config.viewOptions),e.registerView(this.view),this.model.load()}}),BANCOMER.Components.Positions=IFB.Class(IFB.Components.Positions,{initialize:function(e){this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.Positions.parent.initialize.call(this,e);
}}),BANCOMER.Components.ResearchNews=IFB.Class(BANCOMER.Components.Base,{components:[],urlFileNode:"",create:function(){var e=this;this.components=[],this.configure(),this.urlFileNode=this.config.urlFileNode||"FicheroIB",e.doCreate()},doCreate:function(){var e=this;switch(this.config.viewOptions.preference){case"news":this.loadMarkUpNews();break;case"research":this.loadMarkUpResearch();break;case"researchNews":this.loadMarkUpResearchNews();break;default:BANCOMER.Utils.Helper.hasResearchChannel(function(){e.loadMarkUpResearchNews()},function(){e.loadMarkUpNews()},e)}},loadMarkUpResearchNews:function(){this.config.viewOptions.preference="researchNews",this.loadMarkUp(this.config.researchNews)},loadMarkUpNews:function(){this.config.viewOptions.preference="news",this.loadMarkUp(this.config.news)},loadMarkUpResearch:function(){this.config.viewOptions.preference="research",this.loadMarkUp(this.config.research)},loadMarkUp:function(e){var t=this,i=new BANCOMER.Components.Static({config:e.markUp});return i.on("rendered",function(){t.loadComponents(e.components),t.trigger("rendered",t)}),i},loadComponents:function(e){var t=this;_.each(e,function(e){t.components.push(t.loadComponent(e.config,t.config.serviceParams.data.param,$(BANCOMER.Defaults.Templates[e.config].viewOptions.el)))})},loadComponent:function(e,t,i){var n=new BANCOMER.Components.NewsTreeMap({config:e,view:{el:$(i)},service:{param:t},urlFileNode:this.urlFileNode});return n},destroy:function(){_.each(this.components,function(e){_.isFunction(e.destroy)&&e.destroy()})},reload:function(){_.each(this.components,function(e){_.isFunction(e.reload)&&e.reload()})},recreate:function(){this.destroy(),this.doCreate()},register:function(){_.each(this.components,function(e){e&&e.register()})}}),BANCOMER.Components.Search=IFB.Class(IFB.Components.Search,{initialize:function(e){var t=this;this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.Search.parent.initialize.call(this,e),this.on("rendered",function(){t.config.viewOptions.niceScroll&&BANCOMER.Utils.Helper.createNiceScroll(t,t.config.viewOptions.niceScroll.id)})},create:function(){this.configure("InstrumentList","/wtdb/LoadDataLV"),this.model=new IFB.Collections.InstrumentList(this.config),this.model.instrumentsMarked=this.options.instrumentsMarked||[],this.model.bind("reset",this._onSearchReady,this),this.searchPattern=this.options.pattern||this.config.pattern||IFB.Utils.ProductConfig.getBuscadorHTPattern()},search:function(e){IFB.Components.Search.lastCall=e,this.view&&this.destroy();var t=this.searchPattern.replace("{0}",e);t=t.replace("{1}",""),this.model.load({param:t,type:"2"})},destroy:function(){this.config.viewOptions.niceScroll&&$("#"+this.config.viewOptions.niceScroll.id).getNiceScroll().remove(),BANCOMER.Components.Search.parent.destroy.call(this)}}),BANCOMER.Components.Static=IFB.Class(IFB.Components.Static,{initialize:function(e){this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.Static.parent.initialize.call(this,e)}}),BANCOMER.Components.TopFlopActive=IFB.Class(IFB.Components.TopFlopActive,{view:void 0,initialize:function(e){this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.TopFlopActive.parent.initialize.call(this,e),this.on("AbrirFicha",function(e){document.location.href="#!/lightbox/instrumentDetail/"+e.mv})},create:function(){this.configure("TopFlopActive","/wtdb/LoadDataMasSubenBajanContratan"),this.config.serviceParams.data.param=IFB.Utils.Helper.getConstituentsCode(this.config.serviceParams.data.param);var e=new IFB.Collections.InstrumentList(this.config);this.config.viewOptions.model=e,this.view=new BANCOMER.Views.TopFlopActive(this.config.viewOptions),this.registerView(this.view),e.load()}}),BANCOMER.Components.TopFlopDetailList=IFB.Class(BANCOMER.Components.InstrumentList,{create:function(){var e=this;this.configure("TopFlopActive","/wtdb/LoadDataMasSubenBajanContratan"),this.setServiceParams(),this._configureComponent(void 0,function(){e.loadDataFromHeader(function(){e._doCreate()})})}}),BANCOMER.Components.TopFlopPieChart=IFB.Class(BANCOMER.Components.Base,{create:function(){this.configure("InstrumentList","/wtdb/LoadDataLV"),this.model=new IFB.Collections.InstrumentList(this.config),this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.TopFlopPieChart(this.config.viewOptions),this.registerView(this.view),this.model.load()}}),BANCOMER.Components.WorkSpaceChart=IFB.Class(BANCOMER.Components.InstrumentDetailCharts,{layout:void 0,workspace:void 0,moduleId:void 0,componentChart:void 0,instrumentSelector:void 0,layoutText:"Layout",moduleText:"module",initialize:function(e){this._templates=BANCOMER.Defaults.Templates,BANCOMER.Components.WorkSpaceChart.parent.initialize.call(this,e),this.moduleId=this.config.viewOptions.componentId,this.layout=this.config.viewOptions.layout,this.workspace=this.config.viewOptions.workspace,this.model.workspace=this.workspace,this.model.layout=this.layout,this.model.componentId=this.moduleId,this.options.charts&&(this.config.charts=this.options.charts),this.on("clickToolBoxInstrumentSelector",this.openInstrumentSelector,this)},openInstrumentSelector:function(){var e=this;this.instrumentSelector=this.getComponentInstrumentSelector(),this.instrumentSelector.on("rendered",function(){$(e.instrumentSelector.config.viewOptions.el).show()}),this.instrumentSelector.on("closeClick",function(){$(e.instrumentSelector.config.viewOptions.el).hide(),e.instrumentSelector.destroy()}),this.instrumentSelector.on("updateChart",function(t){$(e.instrumentSelector.config.viewOptions.el).hide(),e.mv=t.param,e.type=t.type,e.config.serviceParams.data.param=t.param,e.trigger("saveChartPreferences",t),e.reload()})},getComponentInstrumentSelector:function(){var e=this,t=new BANCOMER.Components.ChartInstrumentSelector({config:"workspaces_module_chart_instrumentSelector",service:{},title:e.title,pattern:e.searchPattern,searchTextKey:e.searchTextKey,itemsSelectedTextKey:e.itemsSelectedTextKey});return t},saveChartPreferences:function(){var e=this.config.charts,t=this;this.trigger("saveChartPreferences",{charts:e,module:t.moduleId,workspace:t.workspace},this)},loadChartIntraday:function(){return this.componentChart=new BANCOMER.Components.ChartIntraday({config:"chartIntraday",view:{el:"#chart_"+this.model.componentId,decimalsYAxis:this.config.viewOptions.decimalsYAxis,lineWidth:this.config.viewOptions.lineWidth,typeChart:this.config.charts[this.TYPE.INTRADAY].type},service:{param:this.mv,compressionMult:this.config.charts[this.TYPE.INTRADAY].frequency||"1"}}),this.componentChart.type=this.TYPE.INTRADAY,this.componentChart},loadChartDaily:function(){var e=this.config.charts[this.TYPE.DAILY].frequency,t=this.config.charts[this.TYPE.DAILY].period,i="YYYYMMDD",n=moment().format("YYYYMMDD"),o=moment(n,i).subtract(t.substring(1,2),t.substring(0,1)).format(i);return this.componentChart=new BANCOMER.Components.ChartDaily({config:"chartDaily",view:{el:"#chart_"+this.model.componentId,decimalsYAxis:this.config.viewOptions.decimalsYAxis,lineWidth:this.config.viewOptions.lineWidth,typeChart:this.config.charts[this.TYPE.DAILY].type},service:{param:this.mv,dateStart:o,dateEnd:n,frequency:e}}),this.componentChart.type=this.TYPE.DAILY,this.componentChart},setPeriodTxt:function(e){var t="#period"+this.model.componentId,i=this.getCurrentOptionFilterPeriod();e===this.TYPE.INTRADAY?$(t,this.options.view.el).removeClass("selected"):$(t,this.options.view.el).addClass("selected"),$(t,this.options.view.el).text(BANCOMER.CULTURETEXT.t(i.textKey))},setFrequencyTxt:function(){var e="#frequency"+this.model.componentId,t=this.getCurrentOptionFilterFrequency();$(e,this.options.view.el).text(BANCOMER.CULTURETEXT.t(t.textKey))},showHideFilterComponent:function(e,t,i,n,o,s,r){t=this.layoutText+this.layout+this.moduleText+this.moduleId,$(e).is(":visible")?this.hideFilter(e):(n=this.loadComponentModuleFilter(i,e,t,o,s),this.filterComponents.push(n),n.on("clickOptionFilter",r,this),this.showFilter(e))}}),BANCOMER.Components.WorkspaceInstruments=IFB.Class(BANCOMER.Components.Base,{view:void 0,model:void 0,componentTable:void 0,instrumentSelector:void 0,serviceParamsTable:void 0,configInstrumentList:"",searchPattern:"",searchTextKey:"",itemsSelectedTextKey:"",placeHolderText:"",create:function(){this.configure(),this._create()},_create:function(){var e=this;this.title=BANCOMER.CULTURETEXT.t(this.config.viewOptions.titleTextKey),this.model=new Backbone.Model(this.config),this.model.options=this.config,this.model.title=this.title,this.model.idTable=this.config.viewOptions.idTable,this.model.module=this.config.viewOptions.module,this.model.workspace=this.config.viewOptions.workspace,this.model.layout=this.config.viewOptions.layout,this.searchPattern=this.options.pattern||this.config.pattern||"",this.searchTextKey=this.options.searchTextKey||this.config.searchTextKey||"",this.itemsSelectedTextKey=this.options.itemsSelectedTextKey||this.config.itemsSelectedTextKey||"",this.placeHolderText=this.options.placeHolderText||this.config.placeHolderText||"",this.configInstrumentList=this.config.viewOptions.configInstrumentList,this.serviceParamsTable=this.options.service,this.model.load=function(){e.view.reset()},this.config.viewOptions.model=this.model,this.view=new BANCOMER.Views.Static(this.config.viewOptions),this.registerView(this.view),this.addEvents(),this.view.reset()},addEvents:function(){var e=this;this.on("rendered",function(){e.createTable(),BANCOMER.Utils.Helper.setRefreshIcon()}),this.on("clickRefreshModule",this.onClickRefreshModule,this),this.on("clickToolBoxIndexes",function(){e.componentTable.openSelectorHeader()}),this.on("clickToolBoxInstrumentSelector",this.openInstrumentSelector,this)},onClickRefreshModule:function(){this.componentTable&&this.componentTable.reload()},createTable:function(){var e=this,t={config:e.configInstrumentList,view:{el:$("#"+e.model.idTable),dataTable:{id:e.model.idTable}},configHeaderSelector:{config:"header_selector",title:e.model.title,file:e.model.idTable}};this.serviceParamsTable&&(t.service={param:this.serviceParamsTable.data.param,type:this.serviceParamsTable.data.type}),this.componentTable=new BANCOMER.Components.InstrumentList(t)},destroy:function(){this.componentTable&&this.componentTable.destroy(),this.instrumentSelector&&this.instrumentSelector.destroy(),BANCOMER.Components.WorkspaceInstruments.parent.destroy.call(this)},reload:function(){this.componentTable&&this.componentTable.reload()},openInstrumentSelector:function(){var e=this,t=this.getTableModels();this.instrumentSelector=this.getComponentInstrumentSelector(t),this.instrumentSelector.on("rendered",function(){$(e.instrumentSelector.config.viewOptions.el).show()}),this.instrumentSelector.on("closeClick",function(){$(e.instrumentSelector.config.viewOptions.el).hide(),e.instrumentSelector.destroy()}),this.instrumentSelector.on("userInstrumentsSaved",function(t){e.reloadTableComponent(t),$(e.instrumentSelector.config.viewOptions.el).hide(),e.instrumentSelector.destroy()})},getTableModels:function(){var e=[];return this.componentTable&&this.componentTable.model.models&&(e=this.componentTable.model.models),e},getComponentInstrumentSelector:function(e){var t=this,i=new BANCOMER.Components.InstrumentSelector({config:"workspaces_module_instruments_instrumentSelector",service:{},title:t.title,models:e,pattern:t.searchPattern,searchTextKey:t.searchTextKey,itemsSelectedTextKey:t.itemsSelectedTextKey,placeHolderText:t.placeHolderText});return i},reloadTableComponent:function(e){this.componentTable&&e&&e.type&&e.param&&(this.componentTable.config.serviceParams.data.param=e.param,this.componentTable.config.serviceParams.data.type=e.type,this.componentTable.reload(),this.trigger("userInstrumentsChanged",{param:this.componentTable.config.serviceParams.data.param,type:this.componentTable.config.serviceParams.data.type},this))},register:function(){this.componentTable&&this.componentTable.register()}}),BANCOMER.Components.WorkSpaceModule=IFB.Class(BANCOMER.Components.Base,{create:function(){var e,t;this.configure(),e=new Backbone.Model(this.config),e.options=this.config.viewOptions.options,e.checkedOption=this.config.viewOptions.checkedOption,e.layout=this.config.viewOptions.layout,e.module=this.config.viewOptions.module,e.workspace=this.config.viewOptions.workspace,this.config.viewOptions.model=e,t=new BANCOMER.Views.Static(this.config.viewOptions),this.registerView(t),t.reset()}}),BANCOMER.Pages.Base=IFB.Class(null,{components:[],initialize:function(e){},_load:function(){throw new Error("This method must be overriden")},destroy:function(){for(;this.components.length;)this.components.shift().destroy()},getComponent:function(e){return _.find(this.components,function(t){return t&&t.options&&t.options.config===e})},hideComponent:function(e){e=_.isArray(e)?e:[e];var t,i=this;_.each(e,function(e){t=i.getComponent(e),t&&(i.components=_.without(i.components,t),t.hide())})},onClickModuleFilter:function(e,t){e&&this.showHideModuleFilter(e.module)},onClickRefreshModule:function(e,t){e&&this.refreshModule(e.module)},refreshModule:function(e){throw new Error("This method must be overriden")},showHideModuleFilter:function(e){throw new Error("This method must be overriden")},onClickModuleOpen:function(e,t){e&&e.module&&this.openPage(e,t)},onClickCloseButton:function(){document.location.href="#!/home"},registerComponents:function(){_.each(this.components,function(e){e&&_.isFunction(e.register)&&e.register()})},_loadComponentModuleFilter:function(e,t,i){var n=new BANCOMER.Components.ModuleFilter({config:e.componentIdFilter,view:{el:e.elFilter,options:i,checkedOption:t,componentId:e.componentIdFilter}});return n},_showHideModuleFilter:function(e,t,i,n){var o;$(e.elFilter).is(":visible")?this._hideModuleFilter(e.elFilter):(this._showModuleFilter(e.elFilter),o=this.getComponent(e.componentIdFilter),o||($("#clickableLevel").show(),o=this._loadComponentModuleFilter(e,t,i),this.components.push(o),o.on("clickOptionModuleFilter",n,this)))},_hideModuleFilter:function(e){$("#clickableLevel").hide(),$(e).hide()},_showModuleFilter:function(e){$("#clickableLevel").show(),$(e).show()}}),BANCOMER.Pages.Home=IFB.Class(BANCOMER.Pages.Base,{waitForReloadMillis:500,initialize:function(e){this.reloadInvestmentDetail=this.waitForReloadMillis>0?_.debounce(this._reloadInvestmentDetail,this.waitForReloadMillis):this._reloadInvestmentDetail,this.components.push(this._loadMarkUp())},moduleSettings:{INDEXES:{key:"indexes",elFilter:"#moduleFilterIndexes",componentIdFilter:"home_moduleFilter_indexes"},TOP_FLOP:{key:"topFlop",elFilter:"#moduleFilterTopFlop",componentIdFilter:"home_moduleFilter_topFlop"},MARKET_SUMMARY:{key:"marketSummary",elFilter:"#moduleFilterMarketSummary",componentIdFilter:"home_moduleFilter_marketSummary"},RESEARCH_NEWS:{key:"researchNews",elFilter:"#moduleFilterResearchNews",componentIdFilter:"home_moduleFilter_researchNews"},INVESTMENT_DETAIL:{key:"investmentDetail",elFilter:"#moduleFilterInvestmentDetail",componentIdFilter:"home_moduleFilter_investmentDetail"}},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"home_markUp"});return t.on("rendered",function(){e._loadModules(),e._addEvents(t),e._setModuleTitles(),e._enableFilters(),BANCOMER.Utils.Helper.setRefreshIcon()}),t.on("clickToolBoxIndexes",function(){e.getComponent("home_marketGrid").openSelectorHeader()}),t.on("clickToolBoxInstrumentSelector",this.openInstrumentSelector,this),t.on("clickRefreshInvestmentDetail",this.reloadInvestmentDetail,this),t},_setModuleTitles:function(){var e=this.getCurrentOptionModuleFilterMarketSummary(),t=this.getCurrentOptionModuleFilterTopFlop(),i=this.getCurrentOptionModuleFilterInvestmentDetail();$("#marketSummaryHeader h2").text(BANCOMER.CULTURETEXT.t("moduleTitle_HomeMarketSummaryPrefix")+BANCOMER.CULTURETEXT.t(e.textKey)),$("#topFlopHeader h2").text(BANCOMER.CULTURETEXT.t(t.textKey)),$("#investmentDetailHeader h2").text(BANCOMER.CULTURETEXT.t("moduleTitle_InvestmentDetailPrefix")+BANCOMER.CULTURETEXT.t(i.textKey))},_enableFilters:function(){this._enableFilterResearchNews()},_enableFilterResearchNews:function(){var e=this;BANCOMER.Utils.Helper.hasResearchChannel(function(){$("#researchNewsHeaderFilter").show()},function(){$("#researchNewsHeaderFilter").hide()},e)},_loadComponentChartIndexes:function(){var e=new BANCOMER.Components.ChartIndexes({config:"home_IndexesChart",view:{el:$("#homeIndexesChart")}});return e},_addEvents:function(e){BANCOMER.Launcher.on("changeAccount",this.reloadInvestmentDetail,this),e.on("clickModuleFilter",this.onClickModuleFilter,this),e.on("clickRefreshModule",this.onClickRefreshModule,this),e.on("clickModuleOpen",this.onClickModuleOpen,this)},_loadModules:function(){this._loadModuleIndexes(),this._loadModulesTopFlopHorizontalList(),this._loadModulesMarketSummary(),this._loadModulesNewsResearch(),this._loadModulesInvestmentDetail()},_loadModuleIndexes:function(){this.components.push(this._loadComponentChartIndexes()),this.components.push(this._loadMarketGridIndexes())},_loadModulesMarketSummary:function(){this.components.push(this._loadComponentTopFlopPieChart()),this.components.push(this._loadComponentMultipleTopFlopActive())},_loadModulesTopFlopHorizontalList:function(){this.components.push(this._loadModuleTopFlopHorizontalList())},_loadModulesNewsResearch:function(){this.components.push(this._loadComponentResearchNews())},_reloadInvestmentDetail:function(){var e=this.getComponent("home_investmentDetailChart"),t=this.getComponent("home_investmentDetailTable");e&&t&&e.reload()},_loadModulesInvestmentDetail:function(){var e=this,t=this._loadInvestmentDetailChart();this.components.push(t),t.on("loaded",function(){var i=e.getComponent("home_investmentDetailTable");i?(i.model.models=t.model.models,i.reload()):e.components.push(e._loadInvestmentDetailTable(t.model))})},_loadInvestmentDetailChart:function(){var e=new BANCOMER.Components.InvestmentDetailChart({config:"home_investmentDetailChart",view:{el:$("#homeInvestmentDetailChart")}});return e},_loadInvestmentDetailTable:function(e){var t=this,i=new BANCOMER.Components.InvestmentDetailTable({serviceBCOMParams:{operationCode:"7",params:{data1:"D"}},config:"home_investmentDetailTable",view:{el:$("#homeInvestmentDetailTable")},data:e});return i.on("sortView",function(e,n){i.model.sortview=!0,t.onSortTableInvestmentDetail(e,i.view),t.getComponent("home_investmentDetailChart").reload(i.view.sortConfig)}),i},_loadMarketGridIndexes:function(){var e=new BANCOMER.Components.InstrumentList({config:"home_marketGrid",view:{el:$("#homeIndexesMarketGrid"),titleTextKey:this.titleTextKey}});return e},_loadModuleTopFlopHorizontalList:function(){var e=new BANCOMER.Components.MultipleTopFlopActive({config:"home_multipleTopFlopHorizontalList",view:{el:$("#homeMultiTopFlopList")}});return e},_loadComponentTopFlopPieChart:function(){var e=new BANCOMER.Components.TopFlopPieChart({config:"home_TopFlopPieChart",view:{el:$("#homeTopFlopPieChart")}});return e},_loadComponentMultipleTopFlopActive:function(){var e=new BANCOMER.Components.MultipleTopFlopActive({config:"home_multipleTopFlopActive",view:{el:$("#multipleTopFlopActive")}});return e},_loadComponentResearchNews:function(){var e=new BANCOMER.Components.ResearchNews({config:"home_ResearchNews",view:{}});return e.on("rendered",this._setTitleComponentResearchNews,this),e},_setTitleComponentResearchNews:function(e){var t="moduleTitle_ResearchNews";switch(e.config.viewOptions.preference){case"news":t="moduleTitle_ResearchNews_News";break;case"research":t="moduleTitle_ResearchNews_Research";break;case"researchNews":t="moduleTitle_ResearchNews"}$("#researchNewsHeader h2").text(BANCOMER.CULTURETEXT.t(t))},destroy:function(){BANCOMER.Launcher.off("changeAccount"),BANCOMER.Pages.Home.parent.destroy.call(this)},getCurrentOptionModuleFilterMarketSummary:function(){var e=this.getComponent("home_TopFlopPieChart"),t=this.getComponent("home_multipleTopFlopActive"),i={mv:e.config.serviceParams.data.param.trim(),constituentscode:t.config.serviceParams.data.param.trim()};return _.findWhere(BANCOMER.Utils.Filters.options.marketSummary,i)},getCurrentOptionModuleFilterTopFlop:function(){var e=this.getComponent("home_multipleTopFlopHorizontalList"),t={constituentscode:e.config.serviceParams.data.param.trim()};return _.findWhere(BANCOMER.Utils.Filters.options.topFlop,t)},getCurrentOptionModuleFilterInvestmentDetail:function(){var e=this.getComponent("home_investmentDetailChart"),t={instrumentType:e.config.viewOptions.filter&&e.config.viewOptions.filter.instrumentType?e.config.viewOptions.filter.instrumentType.trim():""};return _.findWhere(BANCOMER.Utils.Filters.options.investmentDetail,t)},getCurrentOptionModuleFilterResearchNews:function(){var e=this.getComponent("home_ResearchNews"),t={value:e.config.viewOptions.preference||"researchNews"};return _.findWhere(BANCOMER.Utils.Filters.options.researchNews,t)},showHideModuleFilter:function(e){var t;if(e)switch(e){case this.moduleSettings.MARKET_SUMMARY.key:t=this.getCurrentOptionModuleFilterMarketSummary(),this._showHideModuleFilter(this.moduleSettings.MARKET_SUMMARY,t?t.key:{},BANCOMER.Utils.Filters.options.marketSummary,this._onClickOptionModuleFilterMarketSummary);break;case this.moduleSettings.TOP_FLOP.key:t=this.getCurrentOptionModuleFilterTopFlop(),this._showHideModuleFilter(this.moduleSettings.TOP_FLOP,t?t.key:{},BANCOMER.Utils.Filters.options.topFlop,this._onClickOptionModuleFilterTopFlop);break;case this.moduleSettings.INVESTMENT_DETAIL.key:t=this.getCurrentOptionModuleFilterInvestmentDetail(),this._showHideModuleFilter(this.moduleSettings.INVESTMENT_DETAIL,t?t.key:{},BANCOMER.Utils.Filters.options.investmentDetail,this._onClickOptionModuleFilterInvestmentDetail);break;case this.moduleSettings.RESEARCH_NEWS.key:t=this.getCurrentOptionModuleFilterResearchNews(),this._showHideModuleFilter(this.moduleSettings.RESEARCH_NEWS,t?t.key:{},BANCOMER.Utils.Filters.options.researchNews,this._onClickOptionModuleFilterResearchNews)}},_onClickOptionModuleFilterMarketSummary:function(e,t){var i=this.getComponent("home_TopFlopPieChart"),n=this.getComponent("home_multipleTopFlopActive");i&&n&&(e&&(this._hideModuleFilter(this.moduleSettings.MARKET_SUMMARY.elFilter),$("#marketSummaryHeader h2").text(BANCOMER.CULTURETEXT.t("moduleTitle_HomeMarketSummaryPrefix")+BANCOMER.CULTURETEXT.t(e.textkey)),i.config.serviceParams.data.param=e.mv,n.config.serviceParams.data.param=e.constituentscode,BANCOMER.Utils.Preferences.addPreferenceModuleServiceParam("home_TopFlopPieChart",e.mv),BANCOMER.Utils.Preferences.addPreferenceModuleServiceParam("home_multipleTopFlopActive",e.constituentscode),BANCOMER.Utils.Preferences.save(),BANCOMER.Defaults.Templates=$.extend(!0,BANCOMER.Defaults.Templates,BANCOMER.Utils.Preferences.preferences.modules)),i.reload(),n.reload())},_onClickOptionModuleFilterTopFlop:function(e,t){var i=this.getComponent("home_multipleTopFlopHorizontalList"),n=this.getComponent(this.moduleSettings.TOP_FLOP.componentIdFilter);i&&(e&&e.constituentscode&&e.textkey&&n&&(this._hideModuleFilter(this.moduleSettings.TOP_FLOP.elFilter),$("#topFlopHeader h2").text(BANCOMER.CULTURETEXT.t(e.textkey)),i.config.serviceParams.data.param=e.constituentscode,BANCOMER.Utils.Preferences.addPreferenceModuleServiceParam("home_multipleTopFlopHorizontalList",e.constituentscode),BANCOMER.Utils.Preferences.save(),BANCOMER.Defaults.Templates=$.extend(!0,BANCOMER.Defaults.Templates,BANCOMER.Utils.Preferences.preferences.modules)),i.reload())},_onClickOptionModuleFilterInvestmentDetail:function(e,t){var i=this.getComponent("home_investmentDetailChart"),n=this.getComponent("home_investmentDetailTable"),o={},s=this.getComponent(this.moduleSettings.INVESTMENT_DETAIL.componentIdFilter);e&&e.textkey&&i&&n&&s&&(this._hideModuleFilter(this.moduleSettings.INVESTMENT_DETAIL.elFilter),o={filter:{instrumentType:e.instrumenttype}},$("#investmentDetailHeader h2").text(BANCOMER.CULTURETEXT.t("moduleTitle_InvestmentDetailPrefix")+BANCOMER.CULTURETEXT.t(e.textkey)),i.config.viewOptions.filter=i.config.viewOptions.filter||{},i.config.viewOptions.filter.instrumentType=e.instrumenttype,i.view.render(),n.config.viewOptions.filter=n.config.viewOptions.filter||{},n.config.viewOptions.filter.instrumentType=e.instrumenttype,n.view.render(),BANCOMER.Utils.Preferences.addPreferenceModuleViewOptions("home_investmentDetailChart",o),BANCOMER.Utils.Preferences.addPreferenceModuleViewOptions("home_investmentDetailTable",o),BANCOMER.Utils.Preferences.save(),BANCOMER.Defaults.Templates=$.extend(!0,BANCOMER.Defaults.Templates,BANCOMER.Utils.Preferences.preferences.modules))},_onClickOptionModuleFilterResearchNews:function(e,t){var i=this.getComponent("home_ResearchNews"),n=this.getComponent(this.moduleSettings.RESEARCH_NEWS.componentIdFilter),o={};e.preference&&e.textkey&&i&&n&&(this._hideModuleFilter(this.moduleSettings.RESEARCH_NEWS.elFilter),i.config.viewOptions.preference=e.preference,i.recreate(),this._setTitleComponentResearchNews(i),o={preference:e.preference},BANCOMER.Utils.Preferences.addPreferencesModuleResearchNews(o),BANCOMER.Utils.Preferences.save(),BANCOMER.Defaults.Templates=$.extend(!0,BANCOMER.Defaults.Templates,BANCOMER.Utils.Preferences.preferences.modules))},onSortTableInvestmentDetail:function(e,t){t.sortView(e)},openPage:function(e,t){var i,n,o,s=e.module;if(s)switch(s){case this.moduleSettings.MARKET_SUMMARY.key:i=this.getCurrentOptionModuleFilterMarketSummary(),n=BANCOMER.Utils.Filters.options.marketSummary[i.key].constituentscodeDetail,o=BANCOMER.Utils.Filters.options.marketSummary[i.key].textKey,document.location.href=e.href+"/"+n+"/"+o+"/"+s;break;case this.moduleSettings.TOP_FLOP.key:i=this.getCurrentOptionModuleFilterTopFlop(),n=BANCOMER.Utils.Filters.options.topFlop[i.key].constituentscodeDetail,o=BANCOMER.Utils.Filters.options.topFlop[i.key].textKey,document.location.href=e.href+"/"+n+"/"+o+"/"+s;break;case this.moduleSettings.RESEARCH_NEWS.key:i=this.getCurrentOptionModuleFilterResearchNews(),document.location.href=e.href+"/"+i.textKey}},getComponentInstrumentSelector:function(e){var t=new BANCOMER.Components.InstrumentSelector({config:"instrument_selector",service:{},title:"componentTitle_InstrumentSelector_Index",models:e});return this.components.push(t),t},getMVSIndexesChart:function(){var e=[],t=this.getComponent("home_IndexesChart");return t&&t.model.models&&(e=t.model.models),e},openInstrumentSelector:function(){var e=this,t=this.getMVSIndexesChart(),i=this.getComponentInstrumentSelector(t);i.on("rendered",function(){$(i.config.viewOptions.el).show()}),i.on("closeClick",function(){$(i.config.viewOptions.el).hide(),e.hideComponent("instrument_selector")}),i.on("userInstrumentsSaved",function(t){e.reloadChartIndexes(t),e.reloadMarketGridIndexes(t),$(i.config.viewOptions.el).hide(),e.hideComponent("instrument_selector")})},reloadChartIndexes:function(e){var t=this.getComponent("home_IndexesChart");t&&(e&&e.type&&e.param&&(t.config.serviceParams.data.param=e.param||t.config.serviceParams.data.param,t.config.serviceParams.data.type=e.type||t.config.serviceParams.data.type,BANCOMER.Utils.Preferences.addPreferenceModuleServiceParamType("home_IndexesChart",e.param,e.type),BANCOMER.Utils.Preferences.save(),BANCOMER.Defaults.Templates=$.extend(!0,BANCOMER.Defaults.Templates,BANCOMER.Utils.Preferences.preferences.modules)),t.reload())},reloadMarketGridIndexes:function(e){var t=this.getComponent("home_marketGrid");t&&(e&&e.type&&e.param&&(t.config.serviceParams.data.param=e.param||t.config.serviceParams.data.param,t.config.serviceParams.data.type=e.type||t.config.serviceParams.data.type,BANCOMER.Utils.Preferences.addPreferenceModuleServiceParamType("home_marketGrid",e.param,e.type),BANCOMER.Utils.Preferences.save(),BANCOMER.Defaults.Templates=$.extend(!0,BANCOMER.Defaults.Templates,BANCOMER.Utils.Preferences.preferences.modules)),t.reload())},refreshModule:function(e){"researchNews"===e?this.reloadModuleResearchNews():"indexes"===e?(this.reloadMarketGridIndexes(),this.reloadChartIndexes()):"marketSummary"===e?this._onClickOptionModuleFilterMarketSummary():"investmentDetail"===e?this.reloadInvestmentDetail():"topFlop"===e&&this._onClickOptionModuleFilterTopFlop()},reloadModuleResearchNews:function(){var e=this.getComponent("home_ResearchNews");e&&e.reload()}}),BANCOMER.Pages.IndexDetailPage=IFB.Class(BANCOMER.Pages.Base,{initialize:function(e){this.components.push(this._loadMarkUp())},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"indexDetailPage_markUp"});return t.on("rendered",function(){e._loadComponents(),BANCOMER.Utils.Helper.setRefreshIcon()}),t.on("clickToolBoxIndexesPage",function(){e.getComponent("indexDetailPage_indexTable").openSelectorHeader()}),t.on("clickToolBoxInstrumentSelector",this.openInstrumentSelector,this),t.on("clickRefreshModule",this.onClickRefreshModule,this),t.on("clickClosePage",function(){e.onClickCloseButton()}),t},_loadComponents:function(){this.components.push(this._loadComponentChartIndexes()),this.components.push(this._loadMarketIndexesTable())},_loadComponentChartIndexes:function(){var e=new BANCOMER.Components.ChartIndexes({config:"indexDetailPage_indexChart",view:{el:$("#indexDetailPageChart")}});return e},_loadMarketIndexesTable:function(){var e=new BANCOMER.Components.InstrumentList({config:"indexDetailPage_indexTable",view:{el:$("#indexDetailPageTable")}});return e},getMVSIndexesChart:function(){var e=[],t=this.getComponent("indexDetailPage_indexChart");return t&&t.model.models&&(e=t.model.models),e},getComponentInstrumentSelector:function(e){var t=new BANCOMER.Components.InstrumentSelector({config:"instrument_selector_maximized",service:{},title:"componentTitle_InstrumentSelector_Index",models:e});return this.components.push(t),t},openInstrumentSelector:function(){var e=this,t=this.getMVSIndexesChart(),i=this.getComponentInstrumentSelector(t);i.on("rendered",function(){$(i.config.viewOptions.el).show()}),i.on("closeClick",function(){$(i.config.viewOptions.el).hide(),e.hideComponent("instrument_selector")}),i.on("userInstrumentsSaved",function(t){e.reloadChartIndexes(t),e.reloadMarketGridIndexes(t),$(i.config.viewOptions.el).hide(),e.hideComponent("instrument_selector")})},reloadChartIndexes:function(e){var t=this.getComponent("indexDetailPage_indexChart");e&&e.type&&e.param&&t&&(t.config.serviceParams.data.param=e.param,t.config.serviceParams.data.type=e.type,t.reload(),BANCOMER.Utils.Preferences.addPreferenceModuleServiceParamType("indexDetailPage_indexChart",e.param,e.type),BANCOMER.Utils.Preferences.save(),BANCOMER.Defaults.Templates=$.extend(!0,BANCOMER.Defaults.Templates,BANCOMER.Utils.Preferences.preferences.modules))},reloadMarketGridIndexes:function(e){var t=this.getComponent("indexDetailPage_indexTable");e&&e.type&&e.param&&t&&(t.config.serviceParams.data.param=e.param,t.config.serviceParams.data.type=e.type,t.reload(),BANCOMER.Utils.Preferences.addPreferenceModuleServiceParamType("indexDetailPage_indexTable",e.param,e.type),BANCOMER.Utils.Preferences.save(),BANCOMER.Defaults.Templates=$.extend(!0,BANCOMER.Defaults.Templates,BANCOMER.Utils.Preferences.preferences.modules))},refreshModule:function(e){"indexDetail"===e&&this.reloadModuleIndexDetail()},reloadModuleIndexDetail:function(){var e=this.getComponent("indexDetailPage_indexChart"),t=this.getComponent("indexDetailPage_indexTable");e&&e.reload(),t&&t.reload()}}),BANCOMER.Pages.InstrumentList=IFB.Class(BANCOMER.Pages.Base,{constituentsCode:"",titleTextKey:"",module:"",moduleSettings:{key:"",elFilter:"#moduleFilterInstrumentList",componentIdFilter:"instrumentList_moduleFilter"},initialize:function(e){this.constituentsCode=e.constituentsCode,this.titleTextKey=e.titleTextKey,this.module=e.module,this.moduleSettings.key=this.module,this.components.push(this._loadMarkUp())},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"instrumentList_markUp"});return t.on("rendered",function(){$("h2",e.el).html(BANCOMER.CULTURETEXT.t(e.titleTextKey)),e._loadComponents(),
BANCOMER.Utils.Helper.setRefreshIcon()}),t.on("clickToolBoxInstrumentList",function(){e.components[1]&&e.components[1].openSelectorHeader()}),t.on("clickClosePage",function(){e.onClickCloseButton()}),t.on("clickModuleFilter",this.onClickModuleFilter,this),t.on("clickRefreshModule",this.onClickRefreshModule,this),t},_loadComponents:function(){-1!==this.titleTextKey.indexOf("GlobalMarket")||-1!==this.titleTextKey.indexOf("Warrants")?this.components.push(this._loadComponentTopFlop()):this.components.push(this._loadComponentInstrumentList())},_loadComponentInstrumentList:function(){var e=new BANCOMER.Components.TopFlopDetailList({config:"instrumentList_table",view:{el:$("#instrumentList_table"),titleTextKey:this.titleTextKey},service:{param:this.constituentsCode}});return e},_loadComponentTopFlop:function(){var e=new BANCOMER.Components.TopFlopDetailList({config:"instrument_listTopFlop",view:{el:$("#instrumentList_table"),titleTextKey:this.titleTextKey},service:{param:this.constituentsCode}});return e},getCurrentOptionModuleFilter:function(){var e=this.getComponent("instrumentList_table")||this.getComponent("instrument_listTopFlop"),t={constituentscodeDetail:e.config.serviceParams.data.param.trim()};return _.findWhere(BANCOMER.Utils.Filters.options[this.module],t)},showHideModuleFilter:function(){var e=this.getCurrentOptionModuleFilter();this._showHideModuleFilter(this.moduleSettings,e?e.key:{},BANCOMER.Utils.Filters.options[this.module],this._onClickOptionModuleFilter)},_onClickOptionModuleFilter:function(e,t){var i=this.getComponent("instrumentList_table")||this.getComponent("instrument_listTopFlop"),n=this.getComponent(this.moduleSettings.componentIdFilter);e.constituentscode&&e.textkey&&n&&(this._hideModuleFilter(this.moduleSettings.elFilter),$("#intrumentListHeader h2").text(BANCOMER.CULTURETEXT.t(e.textkey)),i.config.serviceParams.data.param=e.constituentscode,i.reload(),BANCOMER.Utils.Preferences.addPreferencesModuleInstrumentList(this.module,e.mv,e.constituentscode),BANCOMER.Utils.Preferences.save(),BANCOMER.Defaults.Templates=$.extend(!0,BANCOMER.Defaults.Templates,BANCOMER.Utils.Preferences.preferences.modules))},refreshModule:function(e){"instrumentList"===e&&this.reloadModuleInstrumentList()},reloadModuleInstrumentList:function(){var e=this.getComponent("instrumentList_table")||this.getComponent("instrument_listTopFlop");e&&e.reload()}}),BANCOMER.Pages.InvestmentChartDetail=IFB.Class(BANCOMER.Pages.Base,{configId:"",initialize:function(e){this.configId=e.configId,this.components.push(this._loadMarkUp())},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"investmentChartDetail_markUp"});return t.on("rendered",function(){e._loadComponents()}),t},_loadComponents:function(){this.components.push(this._loadComponentChart(this.configId))},_loadComponentChart:function(e){var t=this,i=new BANCOMER.Components.InstrumentDetailCharts({config:e,view:{el:"#investmentChartDetail_chart",templateFile:"/investmentChartDetail/chart.htm",filters:{chartType:{el:"#detailChartFilterChartType",suffixCls:"",config:"investmentChartDetail_filter_chartType"},period:{el:"#detailChartFilterPeriod",suffixCls:"",config:"investmentChartDetail_filter_period"},frequency:{el:"#detailChartFilterFrequency",suffixCls:"",config:"investmentChartDetail_filter_frequency"}}},service:{}});return i.on("clickClosePage",function(){t.onClickCloseButton()}),i},onClickCloseButton:function(){document.location.href="#!/investmentDetail"},destroy:function(){BANCOMER.Launcher.off("changeAccount"),BANCOMER.Pages.InvestmentChartDetail.parent.destroy.call(this)}}),BANCOMER.Pages.InvestmentDetail=IFB.Class(BANCOMER.Pages.Base,{waitForReloadMillis:500,changeAccountRequested:!1,initialize:function(e){this.reloadInvestmentDetail=this.waitForReloadMillis>0?_.debounce(this._reloadInvestmentDetail,this.waitForReloadMillis):this._reloadInvestmentDetail,this.components.push(this._loadMarkUp())},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"investmentDetail_markUp"});return t.on("rendered",function(){e._loadComponents(),e._addEvents()}),t},_addEvents:function(){BANCOMER.Launcher.on("changeAccount",this.reloadInvestmentDetail,this)},_loadComponents:function(){var e,t=this,i=this._loadComponentInvestmentDetailTable();this.components.push(i),i.on("loaded",function(){e=t.getComponent("investmentDetail_orderBookTable"),e?t.changeAccountRequested&&(e.reload(),t.changeAccountRequested=!1):t.components.push(t._loadComponentOrderBook())}),this.components.push(this._loadComponentChart("investmentDetail_chart1")),this.components.push(this._loadComponentChart("investmentDetail_chart2")),this.components.push(this._loadComponentChart("investmentDetail_chart3"))},_loadComponentInvestmentDetailTable:function(){var e=this,t=new BANCOMER.Components.InvestmentDetailTable({serviceBCOMParams:{operationCode:"7",params:{data1:"D"}},config:"investmentDetail_positionTable",view:{el:$("#investmentDetail_positionTable")}});return t.on("clickToolBoxInstrumentList",function(){t.openSelectorHeader()}),t.on("sortView",function(i,n){t.model.sortview=!0,e.onSortTableInvestmentDetail(i,t.view)}),t},onSortTableInvestmentDetail:function(e,t){t.sortView(e)},_loadComponentOrderBook:function(){var e=new BANCOMER.Components.OrderBookTable({config:"investmentDetail_orderBookTable",view:{el:$("#investmentDetail_orderBookTable")}});return e.on("clickToolBoxInstrumentList",function(){e.openSelectorHeader()}),e},_loadComponentChart:function(e){var t=new BANCOMER.Components.InstrumentDetailCharts({config:e,view:{}});return t},destroy:function(){BANCOMER.Launcher.off("changeAccount"),BANCOMER.Pages.InvestmentDetail.parent.destroy.call(this)},_reloadInvestmentDetail:function(){var e=this.getComponent("investmentDetail_positionTable");this.changeAccountRequested=!0,e&&e.reload()}}),BANCOMER.Pages.Logout=IFB.Class(BANCOMER.Pages.Base,{initialize:function(e){this.components.push(this._loadMarkUp())},_loadMarkUp:function(){var e=new BANCOMER.Components.Static({config:"logout_markUp"});return e}}),BANCOMER.Pages.OrderBookDetail=IFB.Class(BANCOMER.Pages.Base,{initialize:function(e){this.components.push(this._loadMarkUp())},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"orderBookDetail_markUp"});return t.on("rendered",function(){e._loadComponents(),e._addEvents()}),t},_addEvents:function(){var e,t=this;BANCOMER.Launcher.on("changeAccount",function(){e=t.getComponent("orderBookDetail_orderBookTable"),e.config.serviceBCOMParams.params={data1:e.config.serviceBCOMParams.params.data1},e.reload()})},_loadComponents:function(){this.components.push(this._loadComponentOrderBook())},_loadComponentOrderBook:function(){var e=new BANCOMER.Components.OrderBookTable({config:"orderBookDetail_orderBookTable",view:{el:$("#orderBookDetail_orderBookTable")}});return e.on("clickToolBoxInstrumentList",function(){e.openSelectorHeader()}),e},destroy:function(){BANCOMER.Launcher.off("changeAccount"),BANCOMER.Pages.OrderBookDetail.parent.destroy.call(this)}}),BANCOMER.Pages.PositionDetail=IFB.Class(BANCOMER.Pages.Base,{initialize:function(e){this.components.push(this._loadMarkUp())},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"positionDetail_markUp"});return t.on("rendered",function(){e._loadComponents(),e._addEvents()}),t},_addEvents:function(){var e,t=this;BANCOMER.Launcher.on("changeAccount",function(){e=t.getComponent("positionDetail_positionTable"),e.config.serviceBCOMParams.params={data1:e.config.serviceBCOMParams.params.data1},e.reload()})},_loadComponents:function(){this.components.push(this._loadComponentPositionDetailTable())},_loadComponentPositionDetailTable:function(){var e=this,t=new BANCOMER.Components.InvestmentDetailTable({serviceBCOMParams:{operationCode:"7",params:{data1:"D"}},config:"positionDetail_positionTable",view:{el:$("#positionDetail_positionTable")}});return t.on("clickToolBoxInstrumentList",function(){t.openSelectorHeader()}),t.on("sortView",function(i,n){t.model.sortview=!0,e.onSortTableInvestmentDetail(i,t.view)}),t},onSortTableInvestmentDetail:function(e,t){t.sortView(e)},destroy:function(){BANCOMER.Launcher.off("changeAccount"),BANCOMER.Pages.PositionDetail.parent.destroy.call(this)}}),BANCOMER.Pages.ResearchNews=IFB.Class(BANCOMER.Pages.Base,{titleTextKey:"",moduleSettings:{RESEARCH_NEWS:{key:"researchNews",elFilter:"#moduleFilterResearchNewsMaximized",componentIdFilter:"researchNews_moduleFilter_researchNews"}},initialize:function(e){this.titleTextKey=e.titleTextKey,this.components.push(this._loadMarkUp())},_enableFilters:function(){this._enableFilterResearchNews()},_enableFilterResearchNews:function(){var e=this;BANCOMER.Utils.Helper.hasResearchChannel(function(){$("#researchNewsHeaderFilter").show()},function(){$("#researchNewsHeaderFilter").hide()},e)},showHideModuleFilter:function(e){var t;if(e)switch(e){case this.moduleSettings.RESEARCH_NEWS.key:t=this.getCurrentOptionModuleFilterResearchNews(),this._showHideModuleFilter(this.moduleSettings.RESEARCH_NEWS,t?t.key:{},BANCOMER.Utils.Filters.options.researchNews,this._onClickOptionModuleFilterResearchNews)}},_addEvents:function(e){e.on("clickModuleFilter",this.onClickModuleFilter,this),e.on("clickRefreshModule",this.onClickRefreshModule,this)},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"researchNews_markUp"});return t.on("rendered",function(){e.components.push(e._loadComponents()),e._enableFilters(),e._addEvents(t),BANCOMER.Utils.Helper.setRefreshIcon()}),t.on("clickClosePage",function(){e.onClickCloseButton()}),t},_loadComponents:function(){var e=new BANCOMER.Components.ResearchNews({config:"researchNews_ResearchNews",view:{}});return e.on("rendered",this._setTitleComponentResearchNews,this),e},_setTitleComponentResearchNews:function(e){var t="moduleTitle_ResearchNews";switch(e.config.viewOptions.preference){case"news":t="moduleTitle_ResearchNews_News";break;case"research":t="moduleTitle_ResearchNews_Research";break;case"researchNews":t="moduleTitle_ResearchNews"}$("#researchNewsHeader h2").text(BANCOMER.CULTURETEXT.t(t))},getCurrentOptionModuleFilterResearchNews:function(){var e=this.getComponent("researchNews_ResearchNews"),t={value:e.config.viewOptions.preference||"researchNews"};return _.findWhere(BANCOMER.Utils.Filters.options.researchNews,t)},_onClickOptionModuleFilterResearchNews:function(e,t){var i=this.getComponent("researchNews_ResearchNews"),n=this.getComponent(this.moduleSettings.RESEARCH_NEWS.componentIdFilter),o={};e.preference&&e.textkey&&i&&n&&(this._hideModuleFilter(this.moduleSettings.RESEARCH_NEWS.elFilter),i.config.viewOptions.preference=e.preference,i.recreate(),this._setTitleComponentResearchNews(i),o={preference:e.preference},BANCOMER.Utils.Preferences.addPreferencesModuleResearchNews(o),BANCOMER.Utils.Preferences.save(),BANCOMER.Defaults.Templates=$.extend(!0,BANCOMER.Defaults.Templates,BANCOMER.Utils.Preferences.preferences.modules))},refreshModule:function(e){"researchNews"===e&&this.reloadModuleResearchNews()},reloadModuleResearchNews:function(){var e=this.getComponent("researchNews_ResearchNews");e&&e.reload()}}),BANCOMER.Pages.Tutorial=IFB.Class(BANCOMER.Pages.Base,{initialize:function(e){this.components.push(this._loadMarkUp())},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"tutorial_markUp"});return t.on("rendered",function(){new Swiper(".swiper-container",{loop:!0,pagination:".swiper-pagination",nextButton:".swiper-button-next",prevButton:".swiper-button-prev",scrollbar:".swiper-scrollbar"})}),t.on("clickClosePage",function(){e.onClickCloseButton()}),t}}),BANCOMER.Pages.WorkSpace=IFB.Class(BANCOMER.Pages.Base,{id:void 0,name:void 0,workspace:void 0,canEditModule:!0,LAYOUT_TYPE_1:"1",LAYOUT1_MODULE1:"1",LAYOUT1_MODULE2:"2",LAYOUT1_MODULE3:"3",layoutComponents:{1:{1:{el:"#layout1Module1",component:void 0},2:{el:"#layout1Module2",component:void 0},3:{el:"#layout1Module3",component:void 0}}},options:{modules:{INDEXES:{key:"1",textKey:"componentLabel_ModuleWorkSpace_Option_Indexes",suffixFile:"_index"},ISSUER:{key:"2",textKey:"componentLabel_ModuleWorkSpace_Option_Issuer",suffixFile:"_issuer"},CHART:{key:"3",textKey:"componentLabel_ModuleWorkSpace_Option_Chart",suffixFile:"_chart"},POSITIONS:{key:"4",textKey:"componentLabel_ModuleWorkSpace_Option_Position",suffixFile:"_position"}}},initialize:function(e){this.id=e.id,this.name=e.name,this.loadLayout()},loadLayout:function(){if(this.workspace=BANCOMER.Utils.Preferences.preferences.workspaces[this.id]||BANCOMER.Utils.Preferences.getWorkspaceObject(this.name,this.id,"1",{}),this.saveWorkspace(),this.workspace)switch(this.setWorkspaceName(),this.workspace.layout){case this.LAYOUT_TYPE_1:this.loadLayout1()}},loadLayout1:function(){var e=this.loadMarkUpLayout1(),t=this;e.on("rendered",function(){t.loadComponentsLayout1()}),this.components.push(e)},loadMarkUpLayout1:function(){return new BANCOMER.Components.Static({config:"workspace_layout_markUp1"})},loadComponentsLayout1:function(){this.workspace&&(!this.workspace.modules[1]||this.workspace.modules[1]&&!this.workspace.modules[1].type?this.loadComponentOptions(this.LAYOUT_TYPE_1,this.LAYOUT1_MODULE1):this.loadComponentModule(this.LAYOUT_TYPE_1,this.LAYOUT1_MODULE1,this.workspace.modules[1]),!this.workspace.modules[2]||this.workspace.modules[2]&&!this.workspace.modules[2].type?this.loadComponentOptions(this.LAYOUT_TYPE_1,this.LAYOUT1_MODULE2):this.loadComponentModule(this.LAYOUT_TYPE_1,this.LAYOUT1_MODULE2,this.workspace.modules[2]),!this.workspace.modules[3]||this.workspace.modules[3]&&!this.workspace.modules[3].type?this.loadComponentOptions(this.LAYOUT_TYPE_1,this.LAYOUT1_MODULE3):this.loadComponentModule(this.LAYOUT_TYPE_1,this.LAYOUT1_MODULE3,this.workspace.modules[3]))},addComponentLayout:function(e,t,i){i&&(this.layoutComponents[e][t].component=i,this.components.push(i))},loadComponentOptions:function(e,t){var i=this,n=new BANCOMER.Components.WorkSpaceModule({config:"workspace_layout_options",service:{},view:{el:$(i.layoutComponents[e][t].el),options:this.options.modules,layout:e,module:t,workspace:i.id}});n.on("clickOptionFilter",function(e){i.changeModule(e,!1)}),this.addComponentLayout(e,t,n)},changeModule:function(e,t){if(e){var i=this.layoutComponents[e.layout][e.module].component;this.components=_.without(this.components,i),i.destroy(),this.workspace.modules[e.module]=this.workspace.modules[e.module]||{},this.workspace.modules[e.module].config={},this.workspace.modules[e.module].type=e.type,this.saveWorkspace(),t?this.loadComponentOptions(e.layout,e.module):this.loadComponentModule(e.layout,e.module,this.workspace.modules[e.module])}},loadComponentModule:function(e,t,i){var n;if(i&&i.type)switch(i.type.toString()){case this.options.modules.INDEXES.key:n=this.loadComponentModuleIndexes(this.layoutComponents[e][t].el,e,t,i,this.options.modules.INDEXES.suffixFile);break;case this.options.modules.ISSUER.key:n=this.loadComponentModuleIssuers(this.layoutComponents[e][t].el,e,t,i,this.options.modules.ISSUER.suffixFile);break;case this.options.modules.CHART.key:n=this.loadComponentModuleChart(this.layoutComponents[e][t].el,e,t,i,this.options.modules.CHART.suffixFile);break;case this.options.modules.POSITIONS.key:n=this.loadComponentModuleInvestmentDetail(this.layoutComponents[e][t].el,e,t,i,this.options.modules.POSITIONS.suffixFile)}n&&this.canEditModule&&(n.on("clickEditModule",this.clickEditModule,this),this.addComponentLayout(e,t,n))},clickEditModule:function(e){var t=this,i=[{text:BANCOMER.CULTURETEXT.t("noty_Btn_Exit_Close"),callback:function(){t.changeModule(e,!0)}},{text:BANCOMER.CULTURETEXT.t("noty_Btn_Exit_Cancel")}];BANCOMER.Utils.Helper.showNotificationWarning("warning",BANCOMER.CULTURETEXT.t("noty_ChangeModule_Title"),!0,i)},setWorkspaceName:function(){this.name=this.name||this.workspace.title,this.hideWSHeaderItems(),$(".contHeader02 .title").append("<i class='icoTitle layout1' id='icoWorkSpace'></i>"),$(".contHeader02 .title").append("<div class='txtTitle layout1' id='titleWorkSpace'>"+BANCOMER.Utils.Preferences.preferences.workspaces[this.id].title+"</div>"),$(".contHeader02 .title").append("<i class='icoLapiz' id='icoEdit'></i>"),BANCOMER.Router.setWorkspaceTitle(this.name),this.addEventEdit()},hideWSHeaderItems:function(){$("#icoEdit").remove(),$("#icoWorkSpace").remove(),$("#titleWorkSpace").remove()},addEventEdit:function(){var e=this;$("#icoEdit").on("click",function(){e.clickEditWorkspace()})},clickEditWorkspace:function(e){var t=this,i=[{text:BANCOMER.CULTURETEXT.t("noty_Btn_Exit_Cancel"),callback:function(){BANCOMER.Utils.Helper.resetScrollTo()}},{text:BANCOMER.CULTURETEXT.t("noty_Btn_WorkSpace_NameChange"),callback:function(){BANCOMER.Utils.Helper.resetScrollTo();var e=$(".inputWorkSpace").val()||t.name;t.name=e,t.workspace.title=e,t.saveWorkspace(),BANCOMER.Router.setWorkspaceTitle(e)}}];BANCOMER.Utils.Helper.showNotificationWorkSpaceName("warning",'<input class="inputWorkSpace" value="'+t.name+'" maxlength="15" type="text" name="search" placeholder="">',!0,i)},saveWorkspace:function(){this.id&&this.workspace&&BANCOMER.Utils.Preferences.saveWorkspace(this.id,this.workspace)},destroy:function(){this.hideWSHeaderItems(),this.layoutComponents={},BANCOMER.Launcher.off("changeAccount"),BANCOMER.Pages.WorkSpace.parent.destroy.call(this)},loadComponentModuleInvestmentDetail:function(e,t,i,n,o){return this.loadComponentInvestmentDetail(e,t,i,n,"workspaces_module_investmentDetailTable",o)},onSortTableInvestmentDetail:function(e,t){t.sortView(e)},loadComponentModuleChart:function(e,t,i,n,o){return this.loadComponentChart(e,t,i,n,"workspace_layout_chart",o)},loadComponentChart:function(e,t,i,n,o,s){var r=this,a={config:o,service:{},view:{el:$(e),layout:t,componentId:i,workspace:r.id},charts:{intraday:{type:"line",frequency:"1",period:"1d"},daily:{type:"line",frequency:"d",period:"1y"}}};if(n){if(n.config&&n.config.mv){var l={param:n.config.mv};a.service=l}n.config&&n.config.charts&&(a.charts=n.config.charts)}var c=new BANCOMER.Components.WorkSpaceChart(a);return c.on("saveChartPreferences",function(e){n.config.charts=e.charts||n.config.charts||{},n.config.mv=e.param||n.config.mv||"",BANCOMER.Utils.Preferences.updateModuleWorkspace(r.id,i,n)}),c},loadComponentModuleMyInstruments:function(e,t,i,n,o,s){var r=this,a={config:o,view:{el:$(e),idTable:r.getColumnadoNameFile(i,s),module:i,layout:t,workspace:r.id},service:n.config.serviceParams},l=new BANCOMER.Components.WorkspaceInstruments(a);return l.on("userInstrumentsChanged",function(e){var t={serviceParams:{data:{param:e.param,type:e.type}}};n.config=t,BANCOMER.Utils.Preferences.updateModuleWorkspace(r.id,i,n)}),l},loadComponentModuleIssuers:function(e,t,i,n,o){return this.loadComponentModuleMyInstruments(e,t,i,n,"workspaces_module_issuers",o)},loadComponentModuleIndexes:function(e,t,i,n,o){return this.loadComponentModuleMyInstruments(e,t,i,n,"workspaces_module_indexes",o)},loadComponentInvestmentDetail:function(e,t,i,n,o,s){var r=this,a={config:o,serviceBCOMParams:{operationCode:"7",params:{data1:"D"}},view:{el:$(e),dataTable:{id:r.getColumnadoNameFile(i,s)},module:i,workspace:r.id,layout:t,dataTable:{id:"instrumentListTableLayout"+t+"module"+i,fixedColumns:{leftColumns:3,rightColumns:2}}},configHeaderSelector:{file:r.getColumnadoNameFile(i,s)}},l=new BANCOMER.Components.InvestmentDetailTable(a);return l.on("clickToolBoxInstrumentList",function(){l.openSelectorHeader()}),l.on("sortView",function(e,t){l.model.sortview=!0,r.onSortTableInvestmentDetail(e,l.view)}),BANCOMER.Launcher.on("changeAccount",function(){l&&l.reload()}),l},getColumnadoNameFile:function(e,t){return"ws"+this.id+"_md"+e+(t||"")}}),BANCOMER.Pages.WorkspaceMaximized=IFB.Class(BANCOMER.Pages.WorkSpace,{layoutComponents:{1:{1:{el:"#workspaceModuleMaximized"},2:{el:"#workspaceModuleMaximized"},3:{el:"#workspaceModuleMaximized"}}},initialize:function(e){this.module=e.module,this.id=e.id,this.canEditModule=!1,this.components.push(this.loadMarkUp())},loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"workspaces_maximized_markUp"});return t.on("rendered",function(){e.loadWorkspace()}),t},loadWorkspace:function(){this.workspace=BANCOMER.Utils.Preferences.preferences.workspaces[this.id]||BANCOMER.Utils.Preferences.getWorkspaceObject(this.name,this.id,"1",{}),this.workspace&&(this.setWorkspaceName(),this.loadComponentModule(this.workspace.layout,this.module,this.workspace.modules[this.module]))},loadComponentModuleIssuers:function(e,t,i,n,o){return this.loadComponentModuleMyInstruments(e,t,i,n,"workspaces_module_issuers_maximized",o)},loadComponentModuleIndexes:function(e,t,i,n,o){return this.loadComponentModuleMyInstruments(e,t,i,n,"workspaces_module_indexes_maximized",o)},loadComponentModuleInvestmentDetail:function(e,t,i,n,o){return this.loadComponentInvestmentDetail(e,t,i,n,"workspaces_module_investmentDetailTable_maximized",o)},loadComponentModuleChart:function(e,t,i,n,o){return this.loadComponentChart(e,t,i,n,"workspace_layout_chart_maximized",o)}}),BANCOMER.Lightboxes.Base=IFB.Class(BANCOMER.Pages.Base,{components:[],initialize:function(e){this.components=[],BANCOMER.Lightboxes.Base.parent.initialize.call(this,e)},show:function(){$(this.components[0].config.viewOptions.el).show(),BANCOMER.Utils.Helper.resetScrollTo(),this.reloadcomponents()},hide:function(){$(this.components[0].config.viewOptions.el).hide()},close:function(){this.hide(),BANCOMER.Router.destroyPreviousLightbox(),BANCOMER.Router.navigate("",{trigger:!1,replace:!0})},reloadcomponents:function(){this.components.length>0&&_.each(this.components,function(e){e&&e.model&&_.isFunction(e.reload)&&e.reload()})},getComponentModel:function(e){var t=this.getComponent(e);return t&&t.model?t.model:void 0}}),BANCOMER.Lightboxes.Boleta=IFB.Class(BANCOMER.Lightboxes.Base,{mv:"",side:"",title:"",components:[],listenBoletaForm:!1,initialize:function(e){this.mv=e.mv,this.side=e.side,this.title=e.title,BANCOMER.Lightboxes.Boleta.parent.initialize.call(this,e),this.components.push(this._loadMarkUp())},setTitle:function(e){$("#boletaTitle h3").text(e)},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"boleta_markUp"});return t.on("rendered",function(){e.setTitle(e.title),e._loadBoletaComponents()}),t.on("cancelOrderClick",this.onClose,this),t},_loadBoletaComponents:function(){var e=this._loadBoletaInstrumentDetail(this.mv),t=this._loadBoletaForm(this.mv,this.side),i=this._loadBoletaPositions(this.mv),n=this._loadBoletaMenu(this.side);this.components.push(e),this.components.push(t),this.components.push(n),this.components.push(i)},_loadBoletaInstrumentDetail:function(e){var t=new BANCOMER.Components.InstrumentDetail({config:"boleta_instrumentDetail",view:{el:$("#boletaInstrumentDetail")},service:{param:e}});return t},_loadBoletaPositions:function(e){var t=new BANCOMER.Components.Positions({config:"boleta_positions",view:{el:$("#boletaPositions")},service:{param:(e+"    ").slice(0,7),streaming:!0}});return t},_loadBoletaForm:function(e,t){var i={config:"boleta_form",view:{el:$("#boletaForm")},mv:e,side:t},n=new BANCOMER.Components.BoletaForm(i);return this._addEventsBoletaForm(n),n},_loadBoletaMenu:function(e){var t={config:"boleta_menu",view:{side:e}},i=new BANCOMER.Components.BoletaMenu(t);return this._addEventsBoletaMenu(i),i},_loadBoletaConfirmation:function(e){$("#boletaConfirmation").show();var t=new BANCOMER.Components.BoletaConfirmation({config:"boleta_confirmation",view:{el:$("#boletaConfirmation"),model:e}});return this._addEventsBoletaConfirmation(t),t},_loadBoletaReceipt:function(e){$("#boletaReceipt").show();var t=new BANCOMER.Components.BoletaReceipt({config:"boleta_receipt",view:{el:$("#boletaReceipt"),model:e}});return this._addEventsBoletaReceipt(t),t},_addEventsBoletaMenu:function(e){e.on("sendChangeSide",this.onSendChangeSide,this)},_addEventsBoletaForm:function(e){var t=this;e.on("rendered",function(){t.listenBoletaForm||(t.listenBoletaForm=!0,e.view.on("onSendOrder",t.onSendOrder,t))},this),e.on("cancelOrderClick",this.onClose,this)},_addEventsBoletaConfirmation:function(e){e.on("cancelOrderClick",this.onClose,this),e.on("onSendOrderConfirmation",this.onSendOrderConfirmation,this)},_addEventsBoletaReceipt:function(e){e.on("cancelOrderClick",this.onClose,this),e.on("sendOrderReceiptSave",this.sendOrderReceiptSave,this),e.on("sendOrderReceiptMail",this.sendOrderReceiptMail,this)},onSendChangeSide:function(e){var t=this.getComponent("boleta_form"),i=this.getComponent("boleta_menu");t&&i&&(t.model.set("side",e),t.reload(),i.config.viewOptions.side=e,i.reload())},onClose:function(){this.close(),BANCOMER.Launcher.trigger("changeAccount")},onSendOrder:function(e){var t,i=this;BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(BANCOMER.Services.BCOM.OperationCode.SimulaCompraVenta,e,function(n){void 0!==n.answer&&void 0!==n.status&&n.status.ok&&e.id_testigo===n.answer.id_testigo&&(t=i.getComponentModel("boleta_form"),t&&(t.updateModelFromTraderConfirmation(n.answer),i.hideBoletaComponents(),i.showConfirmationComponents(t)))})},onSendOrderConfirmation:function(e){var t,i=this;BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(BANCOMER.Services.BCOM.OperationCode.CompraVentaInversiones,e,function(n){void 0!==n.answer&&void 0!==n.status&&n.status.ok&&e.id_testigo===n.answer.id_testigo&&(t=i.getComponentModel("boleta_confirmation"),t&&(t.updateModelFromTraderReceipt(n.answer),i.hideConfirmationBoletaComponents(),i.showReceiptComponents(t)))})},sendOrderReceiptSave:function(e){BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(BANCOMER.Services.BCOM.OperationCode.GuardadoComprobante,e,function(t){void 0!==t.answer&&void 0!==t.status&&t.status.ok&&e.id_testigo===t.answer.id_testigo&&console.log("GuardadoComprobante - OK")})},sendOrderReceiptMail:function(e){BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(BANCOMER.Services.BCOM.OperationCode.EnvioComprobante,e,function(t){void 0!==t.answer&&void 0!==t.status&&t.status.ok&&e.id_testigo===t.answer.id_testigo&&console.log("EnvioComprobante - OK")})},hideBoletaComponents:function(){var e=this.getComponent("boleta_menu"),t=this.getComponent("boleta_instrumentDetail"),i=this.getComponent("boleta_form"),n=this.getComponent("boleta_positions");t&&i&&n&&e&&(this.hideComponent(["boleta_menu","boleta_instrumentDetail","boleta_form","boleta_positions"]),$("#boletaBoleta").hide())},hideConfirmationBoletaComponents:function(){var e=this.getComponent("boleta_confirmation");e&&(this.components=_.without(this.components,e),e.hide(),$("#boletaConfirmation").hide())},showConfirmationComponents:function(e){var t=this._loadBoletaConfirmation(e);this.components.push(t)},showReceiptComponents:function(e){var t=this._loadBoletaReceipt(e);this.components.push(t)}}),BANCOMER.Lightboxes.HistoricalAlerts=IFB.Class(BANCOMER.Lightboxes.Base,{initialize:function(e){this.titleTextKey=e.titleTextKey||"",this.idAlert=e.idAlert||"",BANCOMER.Lightboxes.HistoricalAlerts.parent.initialize.call(this,e),this.components.push(this._loadMarkUp())},setTitle:function(e){$("#historicalAlertsTitle h3").text(BANCOMER.CULTURETEXT.t(e))},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"historicalAlerts_markUp"});return t.on("rendered",function(){e.setTitle(e.titleTextKey),e._loadComponents()}),t.on("closeClick",this.onClose,this),t},_loadComponents:function(){var e=this._loadHistoricalAlerts();this.components.push(e)},onClose:function(){this.close()},_loadHistoricalAlerts:function(){var e=this,t=new BANCOMER.Components.HistoricalAlertsList({config:"historicalAlerts_list",view:{el:$("#historicalAlerts_table"),idAlert:e.idAlert},data:BANCOMER.MANAGEMENTALERTS.historicalAlerts});return t}}),BANCOMER.Lightboxes.InstrumentDetail=IFB.Class(BANCOMER.Lightboxes.Base,{id:"",mv:"",isin:"",componentsActive:[],markets:{index:["I ","I0","I1","I2"],eft:["M2","M3","M4","M6","M9","20","5V"],warrant:["40","41","42"]},templatesConfig:{markUp:"",header:"",resume:""},menu:{index:[{id:"resume",textKey:"instrumentDetail_menu_resume",css:"index detail"}],etf:[{id:"resume",textKey:"instrumentDetail_menu_resume",css:"etf detail"},{id:"research",textKey:"instrumentDetail_menu_research",css:"etf research"},{id:"news",textKey:"instrumentDetail_menu_news",css:"etf news"},{id:"serie",textKey:"instrumentDetail_menu_serie",css:"etf serie"},{id:"view",textKey:"instrumentDetail_menu_view",css:"etf view"}],warrant:[{id:"resume",textKey:"instrumentDetail_menu_resume",css:"warrant detail"}],issuer:[{id:"resume",textKey:"instrumentDetail_menu_resume",css:"issuer detail"},{id:"research",textKey:"instrumentDetail_menu_research",css:"issuer research"},{id:"news",textKey:"instrumentDetail_menu_news",css:"issuer news"},{id:"serie",textKey:"instrumentDetail_menu_serie",css:"issuer serie"},{id:"multiples",textKey:"instrumentDetail_menu_multiples",css:"issuer multiples"},{id:"view",textKey:"instrumentDetail_menu_view",css:"issuer view"}]},initialize:function(e){this.id=e.mv,this.mv=e.mv,this.isin=e.isin,this.componentsActive=[],BANCOMER.Lightboxes.InstrumentDetail.parent.initialize.call(this,e),this.setTemplatesConfig(),this.loadMarkUp()},setTemplatesConfig:function(){this.templatesConfig.markUp="instrumentDetail_markUp",this.templatesConfig.header="instrumentDetail_header",this.templatesConfig.research="instrumentDetail_research",this.templatesConfig.news="instrumentDetail_news",this.templatesConfig.view="instrumentDetail_view",this.isIndexInstrument()?this.templatesConfig.resume="instrumentDetail_index_resume":this.isEtfInstrument()?(this.templatesConfig.resume="instrumentDetail_etf_resume",this.templatesConfig.positions="instrumentDetail_etf_positions",this.templatesConfig.serie="instrumentDetail_etf_serie"):this.isWarrantInstrument()?this.templatesConfig.resume="instrumentDetail_warrant_resume":(this.templatesConfig.resume="instrumentDetail_issuer_resume",this.templatesConfig.positions="instrumentDetail_issuer_positions",this.templatesConfig.serie="instrumentDetail_issuer_serie",this.templatesConfig.multiples="instrumentDetail_issuer_multiples")},loadMarkUp:function(e){var t=this,i=new BANCOMER.Components.Static({config:this.templatesConfig.markUp});this.components.push(i),i.on("rendered",function(){t.getIsin(function(){t.changeCss("resume"),t.loadHeader(),t.loadResumeComponent()})})},onClose:function(){this.close()},loadResumeComponent:function(){var e=this,t=new BANCOMER.Components.InstrumentDetail({config:this.templatesConfig.resume,service:{param:this.mv}});t.on("rendered",e.onRenderResumeComponent,e),this.components.push(t),this.componentsActive.push(t)},loadSerieComponent:function(){var e=new BANCOMER.Components.InstrumentDetail({config:this.templatesConfig.serie,service:{param:this.mv}});this.components.push(e),this.componentsActive.push(e)},loadMultiplesComponent:function(){var e=new BANCOMER.Components.InstrumentDetail({config:this.templatesConfig.multiples,service:{param:this.mv}});this.components.push(e),this.componentsActive.push(e)},onRenderResumeComponent:function(){var e=this;this.activeMenuTab("resume"),e.loadChartsResumeComponents(),this.templatesConfig.positions&&e.loadPositionsComponent()},isIndexInstrument:function(){var e=this.getMarket(this.mv);return-1!==this.markets.index.indexOf(e)},isEtfInstrument:function(){var e=this.getMarket(this.mv);return-1!==this.markets.eft.indexOf(e)},isWarrantInstrument:function(){var e=this.getMarket(this.mv);return-1!==this.markets.warrant.indexOf(e)},getMarket:function(){return this.mv&&this.mv.length>2?this.mv.substring(0,2):""},loadChartsResumeComponents:function(){var e=new BANCOMER.Components.InstrumentDetailCharts({config:"instrumentDetail_resumeCharts",service:{param:this.mv},view:{},mv:this.mv.trim(),charts:{intraday:{type:"line",frequency:"1",selected:"1",period:"1d"},daily:{type:"line",frequency:"d",period:"1y"}}});this.components.push(e),this.componentsActive.push(e)},onClickTab:function(e,t){var i=e.tab;switch(this.destroyComponentsActive(),this.activeMenuTab(i),
this.changeCss(i),this.mv=e.mv,i){case"research":this.loadResearchComponent();break;case"resume":this.loadResumeComponent();break;case"serie":this.loadSerieComponent();break;case"multiples":this.loadMultiplesComponent();break;case"news":this.loadNewsComponent();break;case"view":this.loadViewComponent()}},loadResearchComponent:function(){var e=this,t=new BANCOMER.Components.NewsCriteria({config:e.templatesConfig.research,service:{isin:this.isin}});e.components.push(t),this.componentsActive.push(t)},loadNewsComponent:function(){var e=this,t=new BANCOMER.Components.NewsCriteria({config:e.templatesConfig.news,service:{isin:this.isin}});e.components.push(t),this.componentsActive.push(t)},loadViewComponent:function(){var e=this,t=new BANCOMER.Components.NewsViewTreeMap({config:e.templatesConfig.view,service:{isin:this.isin}});e.components.push(t),this.componentsActive.push(t)},loadHeaderComponent:function(e){var t=new BANCOMER.Components.InstrumentDetail({config:this.templatesConfig.header,service:{param:this.mv},view:{menu:e}});t.on("closeClick",this.onClose,this),t.on("clickInstrumentDetailTab",this.onClickTab,this),this.components.push(t)},loadHeader:function(){var e=this,t=this.getMenuFromIntrumentType();BANCOMER.Utils.Helper.hasResearchChannel(function(){e.loadHeaderComponent(t)},function(){e.loadHeaderComponent(_.reject(t,function(e){return"research"===e.id}))},e)},getMenuFromIntrumentType:function(){return this.isIndexInstrument()?this.menu.index:this.isEtfInstrument()?this.menu.etf:this.isWarrantInstrument()?this.menu.warrant:this.menu.issuer},getCss:function(e){var t=this.getMenuFromIntrumentType();return _.findWhere(t,{id:e}).css},loadPositionsComponent:function(){var e=new BANCOMER.Components.Positions({config:this.templatesConfig.positions,service:{param:this.mv}});this.components.push(e),this.componentsActive.push(e)},activeMenuTab:function(e){$("li","section.contMenu ul").removeClass("active"),$('li[data-tab="'+e+'"]',"section.contMenu ul").addClass("active")},changeCss:function(e){var t="ifb-PopUp fv "+this.getCss(e);$("div.ifb-PopUp.fv").removeClass().addClass(t)},getIsin:function(e){var t=this,i=new IFB.Services.Database({}),n={sesion:IFB.Services.Session,param:this.mv,type:"4",header:"40"};i.loadDataLV(n,function(i){var n=JSON.parse(i);if(n.answer&&n.answer.LV){var o=n.answer.LV.V;t.isin=o.D40,e()}})},destroyComponentsActive:function(){_.each(this.componentsActive,function(e){e.destroy()}),this.componentsActive=[]}}),BANCOMER.Lightboxes.NewsDetail=IFB.Class(BANCOMER.Lightboxes.Base,{idNews:"",source:"",initialize:function(e){this.idNews=e.idNews,this.source=e.source,BANCOMER.Lightboxes.NewsDetail.parent.initialize.call(this,e),this.components.push(this._loadMarkUp())},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"newsDetail_markUp"});return t.on("rendered",function(){e._load()}),t},onClose:function(){this.close()},_load:function(){this.components.push(this._loadNewsDetail())},_loadNewsDetail:function(){var e=new BANCOMER.Components.NewsDetail({config:"newsDetail_newsDetail",view:{el:"#newsDetail_newsDetail"},service:{source:this.source,idNot:this.idNews}});return e.on("closeClick",this.onClose,this),e}}),BANCOMER.Lightboxes.NewsList=IFB.Class(BANCOMER.Lightboxes.Base,{titleTextKey:"",source:"",idIncomingNews:"",DATE_FORMAT:"YYYYMMDD",newsDetail:void 0,initialize:function(e){this.titleTextKey=e.titleTextKey||"",this.source=e.source||"",this.idIncomingNews=e.idIncomingNews,BANCOMER.Lightboxes.NewsList.parent.initialize.call(this,e),this.components.push(this._loadMarkUp())},setTitle:function(e){$("#newsListTitle h3").text(BANCOMER.CULTURETEXT.t(e))},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"newsList_markUp"});return t.on("rendered",function(){e.setTitle(e.titleTextKey),e._loadComponents(),e.idIncomingNews&&e.refreshNewsDetail(e.source,e.idIncomingNews)}),t.on("closeClick",this.onClose,this),t},_loadComponents:function(){var e=this._loadNewsTable(this.source,this.getCurrentDate());this.components.push(e)},onClose:function(){this.close()},_loadNewsTable:function(e,t){var i=new BANCOMER.Components.NewsList({config:"newsList_newsList",service:{fuentes:e,fecha:t},view:{el:$("#newsList_table")}});return i.on("showNewsDetail",this.onShowNewsDetail,this),i},_loadNewsDetail:function(e,t){var i=new BANCOMER.Components.NewsDetail({config:"newsList_newsDetail",view:{el:$("#newsList_detail")},service:{source:e,idNot:t}});return i},refreshNewsDetail:function(e,t){_.isUndefined(this.newsDetail)?(this.newsDetail=this._loadNewsDetail(e,t),this.components.push(this.newsDetail)):(this.newsDetail.config.serviceParams.data.idNot=t,this.newsDetail.config.serviceParams.data.source=e,this.newsDetail.reload())},onShowNewsDetail:function(e){IFB.Utils.ReadStatusConfig.markAsRead(e.source,e.key,this.getCurrentDate()),this.refreshNewsDetail(e.source,e.key)},getCurrentDate:function(){return moment().format(this.DATE_FORMAT)}}),BANCOMER.Lightboxes.OrderCancel=IFB.Class(BANCOMER.Lightboxes.Base,{folio:"",initialize:function(e){this.folio=e.folio,BANCOMER.Lightboxes.OrderCancel.parent.initialize.call(this,e),this.components.push(this._loadMarkUp())},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"orderCancel_markUp"});return t.on("rendered",function(){e._loadComponents()}),t},_loadComponents:function(){var e=this._loadOrderCancelConfirmation();this.components.push(e)},_loadOrderCancelConfirmation:function(){var e=new BANCOMER.Components.OrderCancelConfirmation({config:"orderCancel_confirmation",view:{folio:this.folio,el:"#orderCancelConfirmation"}});return e.on("closeCancelationClick",this.onClose,this),e},onClose:function(){this.close(),BANCOMER.Launcher.trigger("changeAccount")}}),BANCOMER.Lightboxes.OrderDetail=IFB.Class(BANCOMER.Lightboxes.Base,{folio:"",empresa:"",fechaRegistro:"",operacion:"",emisora:"",serie:"",initialize:function(e){this.folio=e.folio,this.empresa=e.empresa,this.fechaRegistro=e.fechaRegistro,this.operacion=e.operacion,this.emisora=e.emisora,this.serie=e.serie,BANCOMER.Lightboxes.OrderDetail.parent.initialize.call(this,e),this.components.push(this._loadMarkUp())},_loadMarkUp:function(){var e=this,t=new BANCOMER.Components.Static({config:"orderDetail_markUp"});return t.on("rendered",function(){e._loadComponents()}),t},_loadComponents:function(){var e=this._loadOrderDetailTable();this.components.push(e)},_loadOrderDetailTable:function(){var e=this,t=new BANCOMER.Components.OrderDetail({config:"investmentDetail_orderDetail",view:{operacion:e.operacion,emisora:e.emisora,serie:e.serie},serviceBCOMParams:{params:{data1:e.empresa,data2:e.folio,data3:e.fechaRegistro}}});return t.on("rendered",function(){$(".icoCloseWindow").on("click",function(){e.close()})}),t}}),BANCOMER.Router.Main=Backbone.Router.extend({initialize:function(){},currentPage:void 0,currentHelpPage:void 0,lightboxes:[],HELP_HOME_EL:".ifb-helpSummary",HELP_INDEXDETAIL_EL:".ifb-helpIndices",HELP_CHART_MAXIMIZED_EL:".ifb-helpGraph",HELP_INVESTMENTDETAIL_EL:".ifb-helpDetail",HELP_NEWS_MAXIMIZED_EL:".ifb-helpNews",HELP_INSTRUMENTLIST_EL:".ifb-helpShares",routes:{"":"showHomePage","!/home":"showHomePage","!/investmentDetail":"showInvestmentDetail","!/instrumentList/:constituentsCode/:titleTextKey/:module":"showInstrumentList","!/indexDetailPage":"showIndexDetailPage","!/researchNews/:titleTextKey":"showResearchNews","!/logout":"showLogoutPage","!/investmentChartDetail/:configId":"showInvestmentChartDetail","!/positionDetail":"showPositionDetail","!/orderBookDetail":"showOrderBookDetail","!/lightbox/boleta/:mv/:title/:side":"showBoletaLightbox","!/lightbox/orderdetail/:empresa/:folio/:fechareg/:operacion/:emisora/:serie":"showOrderDetailLightbox","!/lightbox/ordercancel/:folio":"showOrderCancelLightbox","!/lightbox/instrumentDetail/:mv":"showInstrumentDetailLightBox","!/lightbox/newsDetail/:source/:idNews":"showNewsDetailLightBox","!/lightbox/newsList/:titleTextKey/:source(/:idIncomingNews)":"showNewsListLightBox","!/lightbox/alerts/historical/:titleTextKey":"showHistoricalAlertsLightBox","!/lightbox/alerts/historical/:titleTextKey/:idAlert":"showHistoricalAlertsLightBox","!/tutorial":"showTutorial","!/lightbox/help":"showHelpLightBox","!/workspace/:id":"showWorkspace","!/workspaceMaximized/:id/:module":"showWorkspaceMaximized"},route:function(e,t,i){var n=this;i||(i=this[t]);var o=function(){n.existsLightboxShowing()?n.isLightbox(e)?n.hidePreviousLightbox():n.destroyPreviousPage():n.isLightbox(e)||n.destroyPreviousPage(),_.isFunction(i)&&i.apply(n,arguments)};return Backbone.Router.prototype.route.call(this,e,t,o)},existsLightboxShowing:function(){return this.lightboxes.length>0},hidePreviousLightbox:function(){var e=_.last(this.lightboxes);e&&e.hide()},destroyPreviousLightbox:function(){var e,t=this.lightboxes.pop();t&&(t.destroy(),e=_.last(this.lightboxes),e&&e.show())},destroyPreviousPage:function(){this.currentPage&&(this.currentPage.destroy(),this.currentPage=void 0),this.destroyLightboxes()},destroyLightboxes:function(){for(;this.lightboxes.length;)this.lightboxes.shift().destroy();this.lightboxes=[]},isLightbox:function(e){return-1!==e.indexOf("/lightbox/")},showHomePage:function(e){this.hideHomeIcon(),this.showPagesHeader(),this.showSettingsHelpIcon(),this.currentHelpPage=this.HELP_HOME_EL;var t={mv:e||"I IB   "};this.currentPage=new BANCOMER.Pages.Home(t),this.setNavigationTitle(BANCOMER.CULTURETEXT.t("pageTitle_Home"))},showHomeIcon:function(){$("#homeBtn").show()},hideHomeIcon:function(){$("#homeBtn").hide()},showSettingsHelpIcon:function(){$(".txtHelpLine3").show(),$(".ifb-help").hide()},hideSettingsHelpIcon:function(){$(".txtHelpLine3").hide()},showLogoutPage:function(){this.hideHomeIcon(),this.showPagesHeader(),this.currentHelpPage=void 0,this.hideSettingsHelpIcon(),this.currentPage=new BANCOMER.Pages.Logout,this.setNavigationTitle(BANCOMER.CULTURETEXT.t("pageTitle_Logout"))},showBoletaLightbox:function(e,t,i){var n={mv:e||"MXVIT00",title:t,side:i||"Compra"},o=new BANCOMER.Lightboxes.Boleta(n);o&&(this.lightboxes.push(o),o.show())},showOrderDetailLightbox:function(e,t,i,n,o,s){var r={empresa:e,folio:t,fechaRegistro:i,operacion:n,emisora:o,serie:s},a=new BANCOMER.Lightboxes.OrderDetail(r);a&&(this.lightboxes.push(a),a.show())},showOrderCancelLightbox:function(e){var t={folio:e},i=new BANCOMER.Lightboxes.OrderCancel(t);i&&(this.lightboxes.push(i),i.show())},showInstrumentDetailLightBox:function(e){var t={mv:e||""},i=new BANCOMER.Lightboxes.InstrumentDetail(t);i&&(this.lightboxes.push(i),i.show()),$("#search_instrumentList").hide()},showNewsDetailLightBox:function(e,t){var i={idNews:t||"",source:e||""},n=new BANCOMER.Lightboxes.NewsDetail(i);n&&(this.lightboxes.push(n),n.show())},showNewsListLightBox:function(e,t,i){var n={titleTextKey:e||"",source:t||"",idIncomingNews:i},o=new BANCOMER.Lightboxes.NewsList(n);o&&(this.lightboxes.push(o),o.show())},showHistoricalAlertsLightBox:function(e,t){var i={titleTextKey:e||"",idAlert:t||""},n=new BANCOMER.Lightboxes.HistoricalAlerts(i);n&&(this.lightboxes.push(n),n.show())},showTutorial:function(){this.hideHomeIcon(),this.showPagesHeader(),this.hideSettingsHelpIcon(),this.currentHelpPage=void 0,this.currentPage=new BANCOMER.Pages.Tutorial,this.setNavigationTitle(BANCOMER.CULTURETEXT.t("pageTitle_Tutorial"))},showInvestmentDetail:function(){this.showHomeIcon(),this.showPagesHeader(),this.showSettingsHelpIcon(),this.currentHelpPage=this.HELP_INVESTMENTDETAIL_EL,this.currentPage=new BANCOMER.Pages.InvestmentDetail,this.setNavigationTitle(BANCOMER.CULTURETEXT.t("pageTitle_InvestmentDetail"))},showIndexDetailPage:function(){this.hideHomeIcon(),this.showPagesHeader(),this.showSettingsHelpIcon(),this.currentHelpPage=this.HELP_INDEXDETAIL_EL,this.currentPage=new BANCOMER.Pages.IndexDetailPage,this.setNavigationTitle(BANCOMER.CULTURETEXT.t("pageTitle_IndexDetail"))},showInstrumentList:function(e,t,i){this.hideHomeIcon(),this.showPagesHeader(),this.showSettingsHelpIcon(),this.currentHelpPage=this.HELP_INSTRUMENTLIST_EL;var n={constituentsCode:e,titleTextKey:t,module:i};this.currentPage=new BANCOMER.Pages.InstrumentList(n),this.setNavigationTitle(BANCOMER.CULTURETEXT.t("pageTitle_InstrumentList"))},showResearchNews:function(e){this.hideHomeIcon(),this.showPagesHeader(),this.showSettingsHelpIcon(),this.currentHelpPage=this.HELP_NEWS_MAXIMIZED_EL;var t={titleTextKey:e};this.currentPage=new BANCOMER.Pages.ResearchNews(t),this.setNavigationTitle(BANCOMER.CULTURETEXT.t("pageTitle_ResearchNews"))},showInvestmentChartDetail:function(e){this.hideHomeIcon(),this.showPagesHeader(),this.showSettingsHelpIcon(),this.currentHelpPage=this.HELP_CHART_MAXIMIZED_EL;var t={configId:e};this.currentPage=new BANCOMER.Pages.InvestmentChartDetail(t),this.setNavigationTitle(BANCOMER.CULTURETEXT.t("pageTitle_InvestmentDetail"))},showPositionDetail:function(){this.hideHomeIcon(),this.showPagesHeader(),this.hideSettingsHelpIcon(),this.currentHelpPage=void 0,this.currentPage=new BANCOMER.Pages.PositionDetail,this.setNavigationTitle(BANCOMER.CULTURETEXT.t("pageTitle_InvestmentDetail_Positions"))},showOrderBookDetail:function(){this.hideHomeIcon(),this.showPagesHeader(),this.hideSettingsHelpIcon(),this.currentHelpPage=void 0,this.currentPage=new BANCOMER.Pages.OrderBookDetail,this.setNavigationTitle(BANCOMER.CULTURETEXT.t("pageTitle_InvestmentDetail_OrderBook"))},showWorkspace:function(e){this.showHomeIcon(),this.hidePagesHeader(),this.hideSettingsHelpIcon(),this.currentHelpPage=void 0,BANCOMER.Utils.Helper.closeFooterMenu();var t={id:e};this.currentPage=new BANCOMER.Pages.WorkSpace(t)},hidePagesHeader:function(){$(".txtTitle").hide(),$(".icoTitle").hide()},showPagesHeader:function(){$(".txtTitle").show(),$(".icoTitle").show(),this.hideWorkSpaceHeader()},hideWorkSpaceHeader:function(){$(".layout1").hide()},showWorkSpaceHeader:function(){$(".layout1").show()},showWorkspaceMaximized:function(e,t){this.showHomeIcon(),this.hidePagesHeader(),this.hideSettingsHelpIcon(),this.currentHelpPage=void 0;var i={id:e,module:t};this.currentPage=new BANCOMER.Pages.WorkspaceMaximized(i)},showHelpLightBox:function(){this.currentHelpPage&&($(".ifb-help").hide(),$(".ifb-contHelp").show(),$(this.currentHelpPage).show())},setNavigationTitle:function(e){$("#ifb-txtTitSup").text(" - "+e)},setWorkspaceTitle:function(e){$("#titleWorkSpace").text(" - "+e)}}),BANCOMER.Models.Alert=Backbone.Model.extend({id:void 0,data:void 0,initialize:function(){this.data=this.toJSON(),this.data&&this.data.General&&this.set({id:this.data.General.ID})},isRead:function(){try{return"1"===this.data.General.Leido}catch(e){}},getDate:function(){try{return this.formatValueAsDate(this.data.Evaluador.Fecha)}catch(e){}},getTime:function(){try{return this.formatValueAsTime(this.data.Evaluador.Hora)}catch(e){}},getTitle:function(){try{return"Tu alerta "+this.data.General.Nombre+" se ha cumplido"}catch(e){}},getNotificationResponse:function(){try{return JSON.parse(this.data.Notificacion.Respuesta).join("<br>y</br>")}catch(e){}},formatValueAsDate:function(e,t){return t=t||"DD/MM/YYYY",e&&(e=moment(e,"YYYYMMDD").isValid()?moment(e,"YYYYMMDD").format(t):""),e},formatValueAsTime:function(e,t){return t=t||"HH:mm",e&&(e=moment(e,"HHmmss").add("minutes",IFB.Settings.GmtOffset).format(t)),e},formatValueAsNumber:function(e,t,i,n,o){if(i&&(!e||"0"===e))return i;var s=accounting.formatNumber(e,{precision:"number"==typeof t?t:this.getDecimals(),zero:i||""});return s+=o||"",n&&e>0&&-1===s.indexOf(n)?n+s:s}}),BANCOMER.Models.BoletaOrder=Backbone.Model.extend({initialize:function(e){this.initializeModel(e),this.createDataValidators(),this.createValidators()},DEFAULTS_DECIMALS:3,DEFAULTS_DATE_FORMAT:"DD/MM/YYYY",DEFAULTS_DATE_FORMAT_RAW:"YYYYMMDD",DEFAULTS_OPERATIONDATE_FORMAT_RAW:"YYYYMMDDHHMMSS",DATE_INPUT_FORMAT_RAW:"YYYY-MM-DD",initializeModel:function(e){this.set("id",e.dataInstrument.MV),this.set("MV",e.dataInstrument.MV),this.set("issuer",e.dataInstrument[IFB.Descriptors.Emisora.descriptor]),this.set("serie",e.dataInstrument[IFB.Descriptors.Serie.descriptor]),this.set("side",e.side),this.set("pivotPrice",e.dataInstrument[IFB.Descriptors.Last.descriptor]),this.set("price",e.side===BANCOMER.Utils.Trader.sideOptions.BUY.value?Number(e.dataInstrument[IFB.Descriptors.AskPrice.descriptor]):Number(e.dataInstrument[IFB.Descriptors.BidPrice.descriptor]))},defaults:{MV:"",issuer:"",serie:"",side:"",price:0,volume:0,pivotPrice:0,orderType:BANCOMER.Utils.Trader.orderTypeOptions.LIMIT.value,expireDate:moment().format(this.DEFAULTS_DATE_FORMAT_RAW),commission:0,amount:0,vat:0,percentage:0,registerNumber:""},getDescriptorValue:function(e){return this.getRawValue(e)},getRawValue:function(e){return this.get(e)||""},getIssuer:function(){return this.getRawValue("issuer")},getSerie:function(){return this.getRawValue("serie")},getSide:function(){return this.getRawValue("side")},getAmount:function(){return this.getRawValue("amount")},getVolume:function(){return this.getRawValue("volume")},getCommission:function(){return this.getRawValue("commission")},getVat:function(){return this.getRawValue("vat")},getRegisterNumber:function(){return this.getRawValue("registerNumber")},getPercentage:function(){return this.getRawValue("percentage")},getDecimals:function(e){var t=this.getRawValue(IFB.Descriptors.Decimals.descriptor);return/^\s*\d+\s*$/.test(t)?parseInt(t,10):e||this.DEFAULTS_DECIMALS},getNumberDecriptorValue:function(e,t){try{t=t||0===t?t:this.getDecimals();var i=this.formatAsNumber(e,t,"");return i}catch(n){}},getOrderType:function(){var e=this.getRawValue("orderType");return BANCOMER.Utils.Trader.getOrderType(e)},getExpireDate:function(e){try{return this.formatAsDate("expireDate",e)}catch(t){}},formatAsNumber:function(e,t,i,n,o){return this.formatValueAsNumber(this.getRawValue(e),t,i,n,o)},formatValueAsNumber:function(e,t,i,n,o){if(void 0!==i&&(!e||"0"===e||""===e))return i;var s=accounting.formatNumber(e,{precision:t,zero:i||""});return s+=o||"",n&&e>0&&-1===s.indexOf(n)?n+s:s},formatValueAsDate:function(e,t){var t=t||this.DEFAULTS_DATE_FORMAT;return e&&(e=moment(e,this.DEFAULTS_DATE_FORMAT_RAW).format(t)),e},formatAsDate:function(e,t){return this.formatValueAsDate(this.getRawValue(e),t)},createDataValidators:function(){this.validation={price:[{rangePrice:{}}],expireDate:[{required:!0,msg:BANCOMER.CULTURETEXT.t("noty_Error_BoletaForm_EmptyDate")},{date:{unavailableWeekend:!0,validRange:{initDate:moment(),endDate:moment().add("d",90)}}}]}},createValidators:function(){var e=this;_.extend(Backbone.Validation.validators,{decimals:function(e,t,i,n){var o=new RegExp("^[-]?\\d*(\\"+accounting.settings.number.decimal+"\\d{1,"+i+"})?$");return o.test(e)?void 0:"Slo se admiten "+n.DEFAULTS_DECIMALS+" decimales como mximo"},date:function(e,t,i,n){var o=0,s=6;if(e){var r=moment(e,n.DEFAULTS_DATE_FORMAT);return r.isValid()?i.validRange&&(r.isBefore(i.validRange.initDate.startOf("day"))||r.isAfter(i.validRange.endDate))?BANCOMER.CULTURETEXT.t("noty_Error_BoletaForm_InvalidedDate"):!i.unavailableWeekend||r.day()!==s&&r.day()!==o?void 0:BANCOMER.CULTURETEXT.t("noty_Error_BoletaForm_UnavailableWeekendDate"):"Formato de fecha no valido"}},getErrorMessageRange:function(e){var t=100*e;return BANCOMER.CULTURETEXT.t("noty_Error_BoletaForm_PriceRangePart1")+t+BANCOMER.CULTURETEXT.t("noty_Error_BoletaForm_PriceRangePart2")},rangePrice:function(t,i,n,o,s){var r,a,l,c,h,d=e.loadVariationRanks(),m=o.getSide(),u=o.id.substring(0,2),p=Number(d[u]),f=o.get("orderType")===BANCOMER.Utils.Trader.orderTypeOptions.LIMIT.value;if(f){if(c=Number(o.get("price")),h=Number(o.get("pivotPrice")),r=p*h,a=h-r,l=h+r,m===BANCOMER.Utils.Trader.sideOptions.BUY.value&&c>l)return this.getErrorMessageRange(p);if(m===BANCOMER.Utils.Trader.sideOptions.SELL.value&&a>c)return this.getErrorMessageRange(p)}}}),_.extend(Backbone.Validation.patterns,{date:/^(0[1-9]|1[0-2])\/(0[1-9]|1\d|2\d|3[01])\/(19|20)\d{2}$/,positive:/^0*[1-9][0-9]*(\,[0-9]+)?|0+\,[0-9]*[1-9][0-9]*$/,integer:/^\d+$/,price:/(^\d+([,.]\d+)?$)|((^\d{1,3}(,\d{3})+(\.\d+)?)$)|((^\d{1,3}(\.\d{3})+(,\d+)?)$)/}),_.extend(Backbone.Validation.messages,{date:"Por favor, seleccione una fecha correcta",positive:"Por favor, seleccione un nmero mayor que cero",integer:"Por favor, seleccione un entero",price:"Por favor, seleccione un precio correcto"})},loadVariationRanks:function(){return _.object(["5V","M0","M1","M2","M3","M4","M5","M6","M7","M9","MX","40","41","42"],[.05,.05,.05,.05,.05,.05,.05,.05,.05,.05,.05,.05,.05,.05])},getOrderToTrader:function(){var e={data1:this.getRawValue("issuer"),data2:this.getRawValue("serie"),data3:this.getRawValue("price").toString(),data4:this.getRawValue("side"),data5:this.getRawValue("volume").toString(),data6:this.getRawValue("expireDate")};return e},getConfirmationToTrader:function(){var e={data1:this.getRawValue("issuer"),data2:this.getRawValue("serie"),data3:this.getRawValue("price").toString(),data4:this.getRawValue("side"),data5:this.getRawValue("volume").toString(),data6:this.getRawValue("expireDate")};return e},getReceiptSaveToTrader:function(e){var t={emisora:this.getIssuer(),operacion:this.getSide(),importe:this.getAmount(),precio:this.getRawValue("price").toString(),titulos:this.getVolume().toString(),fechaVigencia:this.getExpireDate(this.DEFAULTS_DATE_FORMAT_RAW),comision:this.getCommission(),iva:this.getVat(),porcentajeComision:this.getPercentage(),folioInternet:this.getRegisterNumber(),fechaOperacion:moment().format(this.DEFAULTS_OPERATIONDATE_FORMAT_RAW),accionComprobante:e};return t},getReceiptMailToTrader:function(e){var t={emisora:this.getIssuer(),operacion:this.getSide(),importe:this.getAmount(),precio:this.getRawValue("price").toString(),titulos:this.getVolume().toString(),fechaVigencia:this.getExpireDate(this.DEFAULTS_DATE_FORMAT_RAW),comision:this.getCommission(),iva:this.getVat(),porcentajeComision:this.getPercentage(),folioInternet:this.getRegisterNumber(),fechaOperacion:moment().format(this.DEFAULTS_OPERATIONDATE_FORMAT_RAW),accionComprobante:e};return t},updateModelFromTraderConfirmation:function(e){e&&(this.set("commission",e.comision||0),this.set("amount",e.importe||0),this.set("vat",e.iva||0),this.set("percentage",e.porcentaje||0))},updateModelFromTraderReceipt:function(e){e&&this.set("registerNumber",e.folioInternet||0)}}),BANCOMER.Models.Order=IFB.Models.Instrument.extend({id:void 0,data:void 0,TRADER_ACTIONRECEIPT_CANCEL:"3",DEFAULTS_OPERATIONDATE_FORMAT_RAW:"YYYYMMDDHHMMSS",Status:{Executed:{key:"e",textKey:"orderStatus_Executed"},PartiallyExecuted:{key:"pe",textKey:"orderStatus_PartiallyExecuted"},PartiallyCanceled:{key:"pc",textKey:"orderStatus_PartiallyCanceled"},Market:{key:"m",textKey:"orderStatus_Market"},Canceled:{key:"c",textKey:"orderStatus_Canceled"},Rejected:{key:"r",textKey:"orderStatus_Rejected"}},Operation:{Buy:{key:"C",textKey:"operationSide_Buy"},Sell:{key:"V",textKey:"operationSide_Sell"}},initialize:function(){this.data=this.toJSON(),this.set({id:this.data.folio})},getAsignados:function(){try{return this.formatValueAsNumber(this.data.asignados,0)}catch(e){}},getEmisora:function(){return this.data.emisora||""},getEmpresa:function(){return this.data.empresa||""},getEstadoRaw:function(){return this.data.estado},getEstado:function(){var e=_.findWhere(this.Status,{key:this.data.estado}).textKey;return e?BANCOMER.CULTURETEXT.t(e)||"":""},getFechaReg:function(){return this.data.fechareg||""},getFolio:function(){return this.data.folio||""},getOperacion:function(){return this.data.operacion||""},getOperacionText:function(){var e=_.findWhere(this.Operation,{key:this.data.operacion}).textKey;return e?BANCOMER.CULTURETEXT.t(e)||"":""},getPendientes:function(){try{return this.formatValueAsNumber(this.data.pendientes,0)}catch(e){}},getPrecio:function(e){try{return e=e||0===e?e:this.getDecimals(),this.formatValueAsNumber(this.data.precio,e)}catch(t){}},getSerie:function(){return this.data.serie||""},getSolicitados:function(){return this.data.solicitados||""},setFolioCancelacion:function(e){this.data.folioCancelacion=e||""},getFolioCancelacion:function(){return this.data.folioCancelacion||""},getCancelConfirmationToTrader:function(){var e={data1:this.getEmpresa(),data2:this.getFolio(),data3:this.getFechaReg(),data4:this.getPendientes(),data5:""};return e},getCancelSaveMailToTrader:function(){var e={emisora:this.getEmisora(),operacion:this.getOperacionText(),importe:"",precio:"",titulos:this.getSolicitados(),fechaVigencia:this.getFechaReg(),comision:"",iva:"",porcentajeComision:"",folio:this.getFolio(),folioInternet:this.getFolioCancelacion(),fechaOperacion:moment().format(this.DEFAULTS_OPERATIONDATE_FORMAT_RAW),accionComprobante:this.TRADER_ACTIONRECEIPT_CANCEL};return e},formatValueAsNumber:function(e,t,i,n,o){if(i&&(!e||"0"===e))return i;var s=accounting.formatNumber(e,{precision:"number"==typeof t?t:this.getDecimals(),zero:i||""});return s+=o||"",n&&e>0&&-1===s.indexOf(n)?n+s:s}}),BANCOMER.Models.OrderDetail=Backbone.Model.extend({id:void 0,data:void 0,initialize:function(){this.data=this.toJSON(),this.set({id:this.data.fecha+this.data.hora+this.data.tipo+this.data.titulo})},getFecha:function(){try{return this.formatValueAsDate(this.data.fecha)}catch(e){}},getHora:function(){try{return this.formatValueAsTime(this.data.hora)}catch(e){}},getTipoRaw:function(){return this.data.tipo||""},getTipo:function(){var e="";switch(this.getTipoRaw()){case"A":e=BANCOMER.CULTURETEXT.t("field_OrderDetail_Assigned");break;case"S":e=BANCOMER.CULTURETEXT.t("field_OrderDetail_RequestToBeCanceled");break;case"C":e=BANCOMER.CULTURETEXT.t("field_OrderDetail_Canceled")}return e},getTitulos:function(){var e="";try{e=this.formatValueAsNumber(this.data.titulo,0)}catch(t){}return"0"===e?"":e},formatValueAsNumber:function(e,t,i,n,o){if(i&&(!e||"0"===e))return i;var s=accounting.formatNumber(e,{precision:"number"==typeof t?t:this.getDecimals(),zero:i||""});return s+=o||"",n&&e>0&&-1===s.indexOf(n)?n+s:s},formatValueAsDate:function(e,t){return t=t||"DD/MM/YYYY",e&&(e=moment(e,"YYYYMMDD").format(t)),e},formatValueAsTime:function(e,t){return t=t||"HH:mm:ss",e&&(e=moment(e,"HHmmss").format(t)),e}}),BANCOMER.Models.Position=IFB.Models.Instrument.extend({id:void 0,data:void 0,getEmisora:function(){return this.data.emisora||""},getPrecio:function(){return this.data.precio||""},getSerie:function(){return this.data.serie||""},getTitulos:function(){try{return this.formatAsNumber("titulos",0)}catch(e){}},getBancomer_Ultimo:function(e){var t=_.isObject(e)?e:{decimals:e};try{return t.decimals=t.decimals||0===t.decimals?t.decimals:this.getDecimals(),this.formatAsNumber(IFB.Descriptors.Bancomer_Ultimo.descriptor,t.decimals,t.zeroValue,t.positiveSign,t.suffix)}catch(i){}},getValuationRaw:function(e){try{var t=e||Number(this.getDescriptorValue(IFB.Descriptors.Bancomer_Ultimo.descriptor)),i=Number(this.getDescriptorValue("titulos"));return i*t}catch(n){return 0}},getValuation:function(e,t){var i=_.isObject(e)?e:{price:e};!i&&t&&(t=t);try{return i.decimals=i.decimals||0===i.decimals?i.decimals:this.getDecimals(),this.formatValueAsNumber(this.getValuationRaw(e),i.decimals,i.zeroValue,i.positiveSign,i.suffix)}catch(n){}}}),BANCOMER.Collections.Base=Backbone.Collection.extend({model:void 0,options:{},initialize:function(e,t,i){this.options=e||{},this.options.serviceParams=this.options.serviceParams||{},this.options.serviceParams.reset=!0,this.bind("dataLoaded",this.dataLoaded,this)},dataLoaded:function(){},parse:function(e){throw new Error("This method must be overrided")},load:function(){throw new Error("This method must be overrided")},loadDataFromBCOMService:function(e){BANCOMER.Services.BCOM.invocaServicioDesdeInfoBolsa(this.options.serviceBCOMParams.operationCode,this.options.serviceBCOMParams.params,function(t){e(t)})},loadIFBHeader:function(e){var t=new IFB.Services.Database({});t.columnado(_.extend(this.options.serviceParams.header,{sesion:IFB.Services.Session}),function(t){e(t)})},sync:function(e,t,i){var n;return"read"!==e?Backbone.sync.apply(arguments):(n=i.data)?i.success(n,i):void 0},getElementById:function(e){return this.get(e)},getDescriptorsFromHeader:function(){var e="";return this.options.userHeader&&_.each(this.options.userHeader.models,function(t){e+=t.id+","}),e},loadIFBData:function(e,t){var i=new IFB.Services.Database({}),n="",o=this,s="0;43;"+o.getIssuersFormBCOMdata(e),r="",a={},l=[];i.loadDataLV(_.extend({param:s,type:"2",header:r},{sesion:IFB.Services.Session}),function(e){a=JSON.parse(e),a&&a.answer&&a.answer.LV.V&&(l=$.isArray(a.answer.LV.V)?a.answer.LV.V:[a.answer.LV.V]),_.each(l,function(e){n+=e.MV+","}),i.loadDataLV({param:n,type:"4",header:o.getDescriptorsFromHeader(),rt:"1",sesion:IFB.Services.Session,sort:"10103"},function(e){t(e)})})},extendBCOMData:function(e,t,i){var n,o=[],s=[];t&&t.answer&&t.answer.LV.V&&(s=$.isArray(t.answer.LV.V)?t.answer.LV.V:[t.answer.LV.V]);var r=[];return r=$.isArray(e.answer[i])?e.answer[i]:[e.answer[i]],_.each(r,function(e){n=_.where(s,{D9828:e.emisora,D9829:e.serie}),n.length>0?_.each(n,function(t){o.push(_.extend(e,t))}):(e.D9828=e.emisora,e.D9829=e.serie,e.D1577=e.titulos,e.D2611=e.precio,o.push(e))}),o}}),BANCOMER.Collections.Alerts=BANCOMER.Collections.Base.extend({model:BANCOMER.Models.Alert,parse:function(e){return this.message=e,this.trigger("dataLoaded",this),e.length?e:[]},load:function(){var e=this;e.fetch({data:e.data,reset:!0})}}),BANCOMER.Collections.OrderBook=BANCOMER.Collections.Base.extend({model:BANCOMER.Models.Order,parse:function(e){return this.message=e,this.trigger("dataLoaded",this),e.length?e:[]},load:function(){this.options.serviceParams.header?this.loadWithHeader():this.loadWithoutHeader()},loadWithoutHeader:function(){var e=this;this.loadDataFromBCOMService(function(t){e.fetch({data:t.answer.ordenes||[],reset:!0})})},loadWithHeader:function(){var e=this,t={},i={};this.loadDataFromBCOMService(function(n){t=n,e.loadIFBData(t,function(n){i=JSON.parse(n),e.fetch({data:e.extendBCOMData(t,i,"ordenes"),reset:!0})})})},getIssuersFormBCOMdata:function(e){var t="",i="";return e.answer&&e.answer.ordenes&&_.each(e.answer.ordenes,function(e){e.emisora&&e.serie&&(t=e.emisora.replace("#","&"),i+=(t+"       ").slice(0,7).replace("&","%26"),i+=(e.serie+"     ").slice(0,5))}),i},filterModel:function(e){var t=[];switch(e){case"1":t=["pe","pc","m"];break;case"2":t=["c","r"];break;case"3":t=["e"];break;case"4":t=["pe","m","c","e","pc","r"]}return ordersFiltered=_.filter(this.models,function(e){return-1!==t.indexOf(e.getEstadoRaw())})}}),BANCOMER.Collections.OrderDetail=BANCOMER.Collections.Base.extend({model:BANCOMER.Models.OrderDetail,parse:function(e){var t=[];return this.message=e,this.trigger("dataLoaded",this),e.status.ok&&e.answer.hechos?(t=$.isArray(e.answer.hechos)?e.answer.hechos:[e.answer.hechos],t.length?t:[]):[]},load:function(){var e=this;this.loadDataFromBCOMService(function(t){e.fetch({data:t,reset:!0})})}}),BANCOMER.Collections.PositionBook=BANCOMER.Collections.Base.extend({model:BANCOMER.Models.Position,parse:function(e){return this.message=e,this.trigger("dataLoaded",this),e.length?e:[]},load:function(){var e=this,t={},i={};this.loadDataFromBCOMService(function(n){t=n,e.loadIFBData(t,function(n){i=JSON.parse(n),e.fetch({data:e.extendBCOMData(t,i,"inversiones"),reset:!0})})})},getIssuersFormBCOMdata:function(e){var t="",i="";return e.answer&&e.answer.inversiones&&_.each(e.answer.inversiones,function(e){e.emisora&&e.serie&&(t=e.emisora.replace("#","&"),i+=(t+"       ").slice(0,7).replace("&","%26"),i+=(e.serie+"     ").slice(0,5))}),i},transformModelToView:function(){var e=this.models,t=this;if(e){var i=_.groupBy(e,function(e){return e.getInstrumentType()});this.equities=_.sortBy(i[IFB.Models.Instrument.prototype.INSTRUMENTS_TYPES.EQUITY],function(e){return-1*Number(e.getDescriptorValue("titulos"))}),this.funds=_.sortBy(i[IFB.Models.Instrument.prototype.INSTRUMENTS_TYPES.FUND],function(e){return-1*Number(e.getDescriptorValue("titulos"))}),aux=_.union(this.equities,this.funds),auxInstruments=_.difference(e,aux),
this.equities=_.union(t.equities,auxInstruments),_.each(this.equities,function(e){e.data.D9558||(e.data.D9558="V")}),this.equities=_.sortBy(this.equities,function(e){return-1*Number(e.getDescriptorValue("titulos"))}),this.models=[],_.each(this.equities,function(e){t.models.push(e)}),_.each(this.funds,function(e){t.models.push(e)})}},filterByInstrumentType:function(){var e=this.options.viewOptions.filter&&this.options.viewOptions.filter.instrumentType?this.options.viewOptions.filter.instrumentType:"",t=this.models;return e&&(t=_.filter(t,function(t){return t.getInstrumentType().trim()===e})),t}}),BANCOMER.Views.BoletaForm=IFB.Views.Base.extend({initialize:function(){IFB.Views.Base.prototype.initialize.apply(this,arguments),Backbone.Validation.bind(this,{valid:function(e,t){},invalid:function(e,t,i){e.validationErrors.push({field:t,error:i})}})},validationErrors:[],DECIMAL:3,KEYCODE_DELETE:8,KEYCODE_POINT:190,KEYCODE_COMMA:188,validationPatterns:{integer:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:[,.]\d{3})+)(?:[,.]\d+)?$/,positive:/^0*[1-9][0-9]*(\,[0-9]+)?|0+\,[0-9]*[1-9][0-9]*$/},getUnformatFieldValue:function(e){var t=this.getFieldValue(e);return t=this.replaceAll(t,accounting.settings.number.thousand,""),this.replaceAll(t,accounting.settings.number.decimal,".")},getFieldValue:function(e){return $("#"+e,this.$el).val()||""},setFieldValue:function(e,t){$("#"+e,this.$el).val(t)},onUpdateData:function(e){var t=this;_.each(e.V,function(e){e.D===IFB.Descriptors.Last.descriptor&&(t.model.set("pivotPrice",e.V),$("#pivotPrice",t.$el).html(e.V))})},onSendOrderClick:function(){var e=this;if(BANCOMER.Utils.Helper.resetScrollTo(),!$("#btnAccept",this.$el).hasClass("disable"))if(this.validateOrder())this.trigger("onSendOrder",this.model.getOrderToTrader());else{var t=[{text:BANCOMER.CULTURETEXT.t("noty_Btn_BoletaForm_Edit")},{text:BANCOMER.CULTURETEXT.t("noty_Btn_BoletaForm_Cancel"),callback:function(){e.trigger("cancelOrderClick",e)}}];IFB.Utils.Helper.showNotificationWarning("warning",this.validationErrors[0].error,!0,t)}},getKeyCode:function(e){var t=e.which?e.which:e.charCode?e.charCode:e.keyCode?e.keyCode:0;return t},sharesKeyDown:function(e,t,i){var n=this.getKeyCode(i),o=n!==this.KEYCODE_DELETE;return o&&this.isNumericKeyCode(i)?void i.preventDefault():void 0},sharesClick:function(){var e=$("#volume",this.$el).val();"0"===e&&$("#volume",this.$el).val("")},escapeRegExp:function(e){return e.replace(/([.*+?\^=!:${}()|\[\]\/\\])/g,"\\$1")},replaceAll:function(e,t,i){return e.replace(new RegExp(this.escapeRegExp(t),"g"),i)},sharesKeyUp:function(e,t,i){var n=t.val().toString();n=this.replaceAll(n,accounting.settings.number.thousand,""),t.val(accounting.formatNumber(n)),this.refreshStatusBtn()},validateShares:function(){var e=$("#volume",this.$el).val(),t=accounting.unformat(e),i=this.isNumber(e)&&this.isPositive(e)&&this.isInteger(t)&&Number(t)>=1;return i},isInteger:function(e){return _.isNumber(e)||_.isString(e)&&!_.isNull(e.match(this.validationPatterns.integer))},isDecimalPoint:function(e){return"."===accounting.settings.number.decimal&&(e===this.KEYCODE_POINT||"."===e)||","===accounting.settings.number.decimal&&(e===this.KEYCODE_COMMA||","===e)},isNumericKeyCode:function(e){var t=this.getKeyCode(e);return(e.shiftKey||48>t||t>57)&&(96>t||t>105)},priceKeyDown:function(e,t,i){var n=this.getKeyCode(i),o=(accounting.unformat(t.val()),_.indexOf(t.val(),accounting.settings.number.decimal)),s=n!==this.KEYCODE_DELETE,r=this.isDecimalPoint(n)&&-1!==o,a=-1!==o&&t.val().substring(o).length>this.DECIMAL;return s&&(r||a||this.isNumericKeyCode(i)&&!this.isDecimalPoint(n))?void i.preventDefault():void 0},priceKeyUp:function(e,t,i){var n,o=this.getKeyCode(i),s=_.indexOf(t.val(),accounting.settings.number.decimal),r=-1!==s?t.val().substr(s+1).length:0,a=t.val().substring(t.val().length-1,t.val().length);this.isDecimalPoint(o)||this.isDecimalPoint(a)||(n=t.val().toString(),n=this.replaceAll(n,accounting.settings.number.thousand,""),n=this.replaceAll(n,accounting.settings.number.decimal,"."),t.val(accounting.formatNumber(n,{precision:r}))),this.refreshStatusBtn()},onPriceChange:function(){var e=this.getUnformatFieldValue("price");this.model.set("price",e)},priceFocusOut:function(){this.onPriceChange(),this.refreshStatusBtn()},priceFocusIn:function(){this.onPriceChange(),this.refreshStatusBtn()},onPriceClick:function(){var e=$("#price",this.$el).val();"0"===e&&$("#price",this.$el).val("")},validatePrice:function(){var e=$("#price",this.$el).val();return this.isNumber(e)&&this.isPositive(e)},isNumber:function(e){return _.isNumber(e)||_.isString(e)&&!_.isNull(e.match(this.validationPatterns.number))},isPositive:function(e){return!_.isNull(e.match(this.validationPatterns.positive))},sharesFocusOut:function(){this.refreshStatusBtn()},sharesFocusIn:function(){this.refreshStatusBtn()},refreshStatusBtn:function(){this.validatePrice()&&this.validateShares()?$("#btnAccept",this.$el).removeClass("disable"):$("#btnAccept",this.$el).addClass("disable")},testDateInputFormatRaw:function(e){return/^\d{4}-\d{1,2}-\d{1,2}$/.test(e)},validateOrder:function(){var e=this,t=IFB.Utils.Helper.serializeObject(this.$el);t.expireDate&&this.testDateInputFormatRaw(t.expireDate)&&(t.expireDate=moment(t.expireDate,this.model.DATE_INPUT_FORMAT_RAW).format(this.model.DEFAULTS_DATE_FORMAT));var i=this.model.preValidate(t);return i?(e.validationErrors=[],_.each(i,function(t,i){e.validationErrors.push({field:i,error:t})}),!1):(this.setModelData(t),!0)},setModelData:function(e){try{this.model.set("volume",this.getUnformatFieldValue("volume")),this.model.set("price",this.getUnformatFieldValue("price")),this.model.set("expireDate",moment(e.expireDate,this.model.DEFAULTS_DATE_FORMAT).format(this.model.DEFAULTS_DATE_FORMAT_RAW)),this.model.set("orderType",e.orderType)}catch(t){}}}),BANCOMER.Views.ChartIndexes=IFB.Views.Base.extend({initialize:function(){IFB.Views.Base.prototype.initialize.apply(this,arguments)},onUpdateData:function(e){var t=this,i=(e.MV,this.model.getElementById(e.MV));i&&(IFB.Views.Base.prototype.onUpdateData.apply(this,arguments),_.each(e.V,function(e){e.D===IFB.Descriptors.ChangePercent.descriptor&&t.render()}))}}),BANCOMER.Views.InstrumentDetail=IFB.Views.Base.extend({initialize:function(){IFB.Views.Base.prototype.initialize.apply(this,arguments)},onUpdateData:function(e){var t,i,n=this,o=e.MV,s=this.model.getElementById(e.MV);s&&(_.each(e.V,function(e){e.D===IFB.Descriptors.Trend.descriptor&&(t="[data-mv='"+o+"'][data-descriptor='"+IFB.Descriptors.Trend.descriptor+"']",i=$(t,n.$el),_.each(i,function(t){n.updateClsTrend(t,e.V,n.options.topFlopBackgroundCls),n.updateClsTrend(t,e.V,n.options.topFlopArrowCls)}))}),IFB.Views.Base.prototype.onUpdateData.apply(this,arguments))},hasClsElement:function(e,t){return $(e).hasClass(t.top)||$(e).hasClass(t.flop)||$(e).hasClass(t.equal)},updateClsTrend:function(e,t,i){i&&this.hasClsElement(e,i)&&($(e).removeClass(i.top+" "+i.flop+" "+i.equal),"1"===t?$(e).addClass(i.top):"2"===t?$(e).addClass(i.flop):$(e).addClass(i.equal))}}),BANCOMER.Views.InvestmentDetail=IFB.Views.Base.extend({header:void 0,initialize:function(){IFB.Views.Base.prototype.initialize.apply(this,arguments),this.options.enableSort&&(this.options.sortConfig?this.sortConfig=_.defaults({},this.options.sortConfig,this.defaultSortConfig):this.sortConfig=_.defaults({},this.defaultSortConfig),this.subscribe("rendered",this.addSortCss,this)),this.header=this.options.model.models[0].attributes.userHeader.models;[IFB.Descriptors.Bancomer_Valuacion.descriptor,IFB.Descriptors.Bancomer_PlusMinus.descriptor,IFB.Descriptors.Bancomer_PlusMinusPerc.descriptor]},defaultSortConfig:{type:"string",direction:"asc",descriptor:IFB.Descriptors.ShortName.descriptor,css:{arrow:"sortArrow",asc:"activeUp",desc:"activeDown"}},onUpdateData:function(e){IFB.Views.Base.prototype.onUpdateData.apply(this,arguments);var t,i=this,n=e.MV,o=this.model.getElementById(e.MV),s=[IFB.Descriptors.Bancomer_Valuacion.descriptor,IFB.Descriptors.Bancomer_PlusMinus.descriptor,IFB.Descriptors.Bancomer_PlusMinusPerc.descriptor];if(o){var r,a;_.each(e.V,function(e){e.D===IFB.Descriptors.Bancomer_Ultimo.descriptor&&_.each(s,function(e){r=_.find(i.header,function(t){return t.id===e.substring(1)},i),r&&(a=o.getRawDataFromColumnadoConfig(r),t="[data-mv='"+n+"'][data-descriptor='"+e+"']",$(t,i.$el).html(o.formatValueAsNumber(a,r.getDecimals())))})})}}}),BANCOMER.Views.OrderBook=IFB.Views.Base.extend({initialize:function(){IFB.Views.Base.prototype.initialize.apply(this,arguments),this.options.enableSort&&(this.options.sortConfig?this.sortConfig=_.defaults({},this.options.sortConfig,this.defaultSortConfig):this.sortConfig=_.defaults({},this.defaultSortConfig),this.subscribe("rendered",this.addSortCss,this))},defaultSortConfig:{type:"string",direction:"desc",descriptor:IFB.Descriptors.Bancomer_Estado.descriptor,css:{arrow:"sortArrow",asc:"activeUp",desc:"activeDown"}}}),BANCOMER.Views.OrderDetail=IFB.Views.Base.extend({initialize:function(){IFB.Views.Base.prototype.initialize.apply(this,arguments)}}),BANCOMER.Views.Static=IFB.Views.Static.extend({}),BANCOMER.Views.TopFlopActive=IFB.Views.TopFlopActive.extend({initialize:function(){IFB.Views.TopFlopActive.prototype.initialize.apply(this,arguments)},onUpdateData:function(e){var t,i,n=this,o=e.MV,s=this.model.getElementById(e.MV);s&&(_.each(e.V,function(e){e.D===IFB.Descriptors.Trend.descriptor&&(t="[data-mv='"+o+"'][data-descriptor='"+IFB.Descriptors.Trend.descriptor+"']",i=$(t,n.$el),_.each(i,function(t){n.updateClsTrend(t,e.V,n.options.topFlopArrowCls)}))}),IFB.Views.TopFlopActive.prototype.onUpdateData.apply(this,arguments))},hasClsElement:function(e,t){return $(e).hasClass(t.top)||$(e).hasClass(t.flop)||$(e).hasClass(t.equal)},updateClsTrend:function(e,t,i){i&&this.hasClsElement(e,i)&&($(e).removeClass(i.top+" "+i.flop+" "+i.equal),"1"===t?$(e).addClass(i.top):"2"===t?$(e).addClass(i.flop):$(e).addClass(i.equal))}}),BANCOMER.Views.TopFlopPieChart=IFB.Views.DonutChart.extend({initialize:function(){IFB.Views.DonutChart.prototype.initialize.apply(this,arguments)},colors:{top:"#5cc800",flop:"#cc0a5a",equal:"#757c49"},getChartConfig:function(){var e={renderTo:this.el,plotBackgroundColor:null,plotBorderWidth:0,plotShadow:!1,backgroundColor:"rgba(255, 255, 255, 0.1)"};return this.options.height&&(e.height=this.options.height),e},getTitleConfig:function(){},getPlotOptionsConfig:function(){var e={pie:{dataLabels:{distance:-30,color:"white"},startAngle:-90,endAngle:270,borderColor:"rgba(255, 255, 255, 0.1)"},series:{states:{hover:{enabled:!1}}}};return e},getSeriesConfig:function(){var e=[{type:"pie",innerSize:"0%",data:this.getDataFromModel(),size:"130%"}];return e},getColors:function(){return[]},getTooltipConfig:function(){var e={enabled:!1};return e},getDataFromModel:function(){var e=this.model.models[0],t=Number(e.getTopCount()),i=Number(e.getFlopCount()),n=Number(e.getEqualCount()),o=[];return 0!==t&&o.push({name:"",y:Number(t),color:this.colors.top}),0!==i&&o.push({name:"",y:Number(i),color:this.colors.flop}),0!==n&&o.push({name:"",y:Number(n),color:this.colors.equal}),this.updateLabels(),o},onUpdateData:function(e){var t,i=this;_.each(e.V,function(e){i.model.models[0].setDescriptorValue(e.D,e.V)}),t=this.getDataFromModel(),this.chart.series[0].setData(t,!0),this.updateLabels()},updateLabels:function(){var e=this.model.models[0],t=Number(e.getTopCount()),i=Number(e.getFlopCount()),n=Number(e.getEqualCount());$("#txtTop").html(BANCOMER.CULTURETEXT.t("componentFootLegend_TopFlopPieChart_Top")+"<br>"+t),$("#txtFlop").html(BANCOMER.CULTURETEXT.t("componentFootLegend_TopFlopPieChart_Flop")+"<br>"+i),$("#txtEqual").html(BANCOMER.CULTURETEXT.t("componentFootLegend_TopFlopPieChart_Equal")+"<br>"+n)}}),function(){var e={logout:function(){var e=[{text:"Aceptar",callback:function(){window.location.href="http://www.bancomer.com"}}];IFB.Utils.Helper.showNotificationWarning("warning",BANCOMER.CULTURETEXT.t("noty_Error_ServicesNetworkUnavailable"),!0,e)}};IFB.Services.StreamingCallbacks.logout=function(){return BANCOMER.Services.StreamingCallbacks.logout()},BANCOMER.Services.StreamingCallbacks=e}();